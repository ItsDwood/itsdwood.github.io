<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Donovan Wood">
<meta name="dcterms.date" content="2024-02-28">
<meta name="description" content="My second blog post, creating an automated decision system for a hypothetical bank extending credit">

<title>Donovan’s Awesome CSCI 0451 Blog - Whose Costs?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: white;
      }

      .quarto-title-block .quarto-title-banner {
        color: white;
background-image: url(../../img/landscape.png);
background-size: cover;
      }
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Donovan’s Awesome CSCI 0451 Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">Donovan’s Blog Post</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Whose Costs?</h1>
                  <div>
        <div class="description">
          My second blog post, creating an automated decision system for a hypothetical bank extending credit
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Donovan Wood </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 28, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="grabbing-the-data" class="level1">
<h1>Grabbing the Data</h1>
<p>The dataset below will be the one I use for this blog post</p>
<div id="cell-2" class="cell" data-execution_count="282">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/PhilChodrow/ml-notes/main/data/credit-risk/train.csv"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-3" class="cell" data-execution_count="283">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="283">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">person_age</th>
<th data-quarto-table-cell-role="th">person_income</th>
<th data-quarto-table-cell-role="th">person_home_ownership</th>
<th data-quarto-table-cell-role="th">person_emp_length</th>
<th data-quarto-table-cell-role="th">loan_intent</th>
<th data-quarto-table-cell-role="th">loan_grade</th>
<th data-quarto-table-cell-role="th">loan_amnt</th>
<th data-quarto-table-cell-role="th">loan_int_rate</th>
<th data-quarto-table-cell-role="th">loan_status</th>
<th data-quarto-table-cell-role="th">loan_percent_income</th>
<th data-quarto-table-cell-role="th">cb_person_default_on_file</th>
<th data-quarto-table-cell-role="th">cb_person_cred_hist_length</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>25</td>
<td>43200</td>
<td>RENT</td>
<td>NaN</td>
<td>VENTURE</td>
<td>B</td>
<td>1200</td>
<td>9.91</td>
<td>0</td>
<td>0.03</td>
<td>N</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>27</td>
<td>98000</td>
<td>RENT</td>
<td>3.0</td>
<td>EDUCATION</td>
<td>C</td>
<td>11750</td>
<td>13.47</td>
<td>0</td>
<td>0.12</td>
<td>Y</td>
<td>6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>22</td>
<td>36996</td>
<td>RENT</td>
<td>5.0</td>
<td>EDUCATION</td>
<td>A</td>
<td>10000</td>
<td>7.51</td>
<td>0</td>
<td>0.27</td>
<td>N</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>24</td>
<td>26000</td>
<td>RENT</td>
<td>2.0</td>
<td>MEDICAL</td>
<td>C</td>
<td>1325</td>
<td>12.87</td>
<td>1</td>
<td>0.05</td>
<td>N</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>29</td>
<td>53004</td>
<td>MORTGAGE</td>
<td>2.0</td>
<td>HOMEIMPROVEMENT</td>
<td>A</td>
<td>15000</td>
<td>9.63</td>
<td>0</td>
<td>0.28</td>
<td>N</td>
<td>10</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="visualizations-of-the-data" class="level2">
<h2 class="anchored" data-anchor-id="visualizations-of-the-data">Visualizations of the Data</h2>
<p>For the dataset, I created two plots and one summary table in order to contextualize the data.</p>
<div id="cell-6" class="cell" data-execution_count="284">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-fig-scatter-loan" class="cell" data-execution_count="286">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">'person_age'</span>, y<span class="op">=</span><span class="st">'person_emp_length'</span>, hue<span class="op">=</span><span class="st">'loan_intent'</span>, data<span class="op">=</span>df, palette<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Loan Intent vs. Age and Employment Length'</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Age'</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Employment Length (Years)'</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-scatter-loan" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-loan-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-scatter-loan-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-loan-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Loan Intent
</figcaption>
</figure>
</div>
</div>
</div>
<p>Regarding <a href="#fig-scatter-loan" class="quarto-xref">Figure&nbsp;1</a>, we can see some patterns within the dataset among loan intentions.</p>
<p>Most notably in the bottom left corner of the plot, which indicates both a young age and limited employment history, there is a culmination of both Educational and Venture loans being used.</p>
<p>This makes sense given the current context of the world, as young individuals would most likely be in college or other forms of education at this time. On a similar note, venture capital is often used for newly formed or aspiring companies. Hence, the youthful age and lack of employment history match.</p>
<p>Conversely, as age increases, loans for medical, home improvement, and debt consolidation become more likely. This evidence is runs concurrent with today’s societal concerns from our more elderly population.</p>
<div id="cell-fig-scatter-loan-grade" class="cell" data-execution_count="287">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">'person_home_ownership'</span>, hue<span class="op">=</span><span class="st">'loan_grade'</span>, data<span class="op">=</span>df, palette<span class="op">=</span><span class="st">'Set2'</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Loan Grade Distribution by Home Ownership'</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Home Ownership'</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Count'</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-scatter-loan-grade" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-loan-grade-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-scatter-loan-grade-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-loan-grade-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Loan Grade Distribution by Home Ownership
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-scatter-loan-grade" class="quarto-xref">Figure&nbsp;2</a> illustrates the Loan grade distribution by home ownership. Loan Grade is viewed A-G with A being the highest loan grade and G being the lowest.</p>
<p>An interesting observation to make here is that for individuals in both the ‘Mortgage’ and ‘Home’ groups, the highest frequency of loans is rated as an A whereas for individuals in the ‘Rent’ group the highest frequency of loans is rated as an B.</p>
<p>This could give context to the economic state of home ownership and bank trust. Those with a mortgage/own property could perhaps be linked to being more trustworthy due to having a longer term connection with a property. Banks may view those in the ‘Rent’ category as a bit more risky due to the short term ability of renting.</p>
<div id="cell-11" class="cell" data-execution_count="126">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>summary_table <span class="op">=</span> df.groupby(<span class="st">'loan_intent'</span>).agg({</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'loan_int_rate'</span>: <span class="st">'mean'</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'loan_amnt'</span>: <span class="st">'mean'</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>}).reset_index()</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>summary_table.rename(columns<span class="op">=</span>{</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'loan_int_rate'</span>: <span class="st">'Average Interest Rate'</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'loan_amnt'</span>: <span class="st">'Average Loan Amount'</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(summary_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         loan_intent  Average Interest Rate  Average Loan Amount
0  DEBTCONSOLIDATION              10.983305          9620.901149
1          EDUCATION              10.965465          9460.015604
2    HOMEIMPROVEMENT              11.160075         10348.725017
3            MEDICAL              11.051946          9242.269907
4           PERSONAL              11.009814          9549.427178
5            VENTURE              10.940866          9516.417425</code></pre>
</div>
</div>
<p>This summary table above displays the relative average interest rates and average loan amounts for each category of loan intent.</p>
<p>Home improvement has the greatest average loan amount while similarly having the highest interest rate. On the flip side, education has the lowest average loan amount but the second lowest interest rate.</p>
</section>
<section id="part-c-build-a-model" class="level2">
<h2 class="anchored" data-anchor-id="part-c-build-a-model">Part C: Build a Model</h2>
<p>I will be utilizing a Logistic Regression Model for predicting whether a prospective borrower is likely to default on a given loan.</p>
<p>I will also be utilizing the <code>RFECV</code> class from <code>sklearn</code> in order to automatically find the most useful features to use in the model. RFE is a feature selection method that fits a model and removes the weakest feature(s) until the specified number of features is reached. Using RFE, you can automate the process of finding an effective subset of features.</p>
<div id="cell-14" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_selection <span class="im">import</span> RFECV</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/PhilChodrow/ml-notes/main/data/credit-risk/train.csv"</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>df_all <span class="op">=</span> pd.read_csv(url)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df_all.drop([<span class="st">'loan_grade'</span>, <span class="st">'loan_status'</span>], axis<span class="op">=</span><span class="dv">1</span>)  </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.get_dummies(df, columns<span class="op">=</span>[<span class="st">'person_home_ownership'</span>, <span class="st">'loan_intent'</span>, <span class="st">'cb_person_default_on_file'</span>], drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>df.dropna(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df_all.loc[df.index, <span class="st">'loan_status'</span>]  </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(df, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">123</span>)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Scaling</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>X_train_scaled <span class="op">=</span> scaler.fit_transform(X_train)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>X_test_scaled <span class="op">=</span> scaler.transform(X_test)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>logreg <span class="op">=</span> LogisticRegression(max_iter<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>selector <span class="op">=</span> RFECV(estimator<span class="op">=</span>logreg, step<span class="op">=</span><span class="dv">1</span>, cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>selector <span class="op">=</span> selector.fit(X_train_scaled, y_train)  <span class="co"># Fitting RFECV to the scaled training data</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>X_train_selected <span class="op">=</span> selector.transform(X_train_scaled)</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>X_test_selected <span class="op">=</span> selector.transform(X_test_scaled)</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>model_selected <span class="op">=</span> LogisticRegression(max_iter<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>model_selected.fit(X_train_selected, y_train)</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>selected_features <span class="op">=</span> X_train.columns[selector.support_]</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Prediction</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>y_pred_selected <span class="op">=</span> model_selected.predict(X_test_selected)</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Optimal number of features: </span><span class="sc">{</span>selector<span class="sc">.</span>n_features_<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred_selected))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-15" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(df, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-16" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>X_train</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">person_age</th>
<th data-quarto-table-cell-role="th">person_income</th>
<th data-quarto-table-cell-role="th">person_emp_length</th>
<th data-quarto-table-cell-role="th">loan_amnt</th>
<th data-quarto-table-cell-role="th">loan_int_rate</th>
<th data-quarto-table-cell-role="th">loan_percent_income</th>
<th data-quarto-table-cell-role="th">cb_person_cred_hist_length</th>
<th data-quarto-table-cell-role="th">person_home_ownership_OTHER</th>
<th data-quarto-table-cell-role="th">person_home_ownership_OWN</th>
<th data-quarto-table-cell-role="th">person_home_ownership_RENT</th>
<th data-quarto-table-cell-role="th">loan_intent_EDUCATION</th>
<th data-quarto-table-cell-role="th">loan_intent_HOMEIMPROVEMENT</th>
<th data-quarto-table-cell-role="th">loan_intent_MEDICAL</th>
<th data-quarto-table-cell-role="th">loan_intent_PERSONAL</th>
<th data-quarto-table-cell-role="th">loan_intent_VENTURE</th>
<th data-quarto-table-cell-role="th">cb_person_default_on_file_Y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">7573</td>
<td>26</td>
<td>38000</td>
<td>1.0</td>
<td>8875</td>
<td>7.51</td>
<td>0.23</td>
<td>2</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15865</td>
<td>25</td>
<td>110004</td>
<td>9.0</td>
<td>15000</td>
<td>7.66</td>
<td>0.14</td>
<td>4</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18729</td>
<td>29</td>
<td>60000</td>
<td>3.0</td>
<td>7200</td>
<td>7.88</td>
<td>0.12</td>
<td>7</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1288</td>
<td>24</td>
<td>44000</td>
<td>1.0</td>
<td>3200</td>
<td>8.00</td>
<td>0.07</td>
<td>2</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12168</td>
<td>65</td>
<td>46000</td>
<td>5.0</td>
<td>10500</td>
<td>16.32</td>
<td>0.23</td>
<td>24</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17438</td>
<td>26</td>
<td>48000</td>
<td>10.0</td>
<td>15000</td>
<td>11.12</td>
<td>0.31</td>
<td>3</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24566</td>
<td>45</td>
<td>118000</td>
<td>15.0</td>
<td>25000</td>
<td>12.18</td>
<td>0.21</td>
<td>12</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20105</td>
<td>21</td>
<td>26000</td>
<td>5.0</td>
<td>14500</td>
<td>14.61</td>
<td>0.56</td>
<td>2</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17825</td>
<td>35</td>
<td>78000</td>
<td>9.0</td>
<td>9450</td>
<td>10.99</td>
<td>0.12</td>
<td>8</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22678</td>
<td>38</td>
<td>65000</td>
<td>5.0</td>
<td>15000</td>
<td>10.36</td>
<td>0.23</td>
<td>17</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>18325 rows × 16 columns</p>
</div>
</div>
</div>
<div id="cell-17" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Scaling</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>X_train_scaled <span class="op">=</span> scaler.fit_transform(X_train)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>X_test_scaled <span class="op">=</span> scaler.transform(X_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-18" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>X_train_scaled</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>array([[-0.26848589, -0.43778172, -0.91860701, ..., -0.45114679,
        -0.4630992 , -0.46344676],
       [-0.4252438 ,  0.65831624,  1.01527471, ..., -0.45114679,
        -0.4630992 , -0.46344676],
       [ 0.20178785, -0.10288151, -0.43513658, ...,  2.21657344,
        -0.4630992 , -0.46344676],
       ...,
       [-1.05227545, -0.62045457,  0.04833385, ..., -0.45114679,
        -0.4630992 ,  2.15774517],
       [ 1.14233533,  0.17112776,  1.01527471, ..., -0.45114679,
        -0.4630992 , -0.46344676],
       [ 1.61260907, -0.02676782,  0.04833385, ..., -0.45114679,
        -0.4630992 , -0.46344676]])</code></pre>
</div>
</div>
<div id="cell-19" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>logreg <span class="op">=</span> LogisticRegression(max_iter<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>selector <span class="op">=</span> RFECV(estimator<span class="op">=</span>logreg, step<span class="op">=</span><span class="dv">1</span>, cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>selector <span class="op">=</span> selector.fit(X_train_scaled, y_train)  <span class="co"># Fitting RFECV to the scaled training data</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>X_train_selected <span class="op">=</span> selector.transform(X_train_scaled)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>X_test_selected <span class="op">=</span> selector.transform(X_test_scaled)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-20" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>X_train_selected</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>array([[-0.12277222, -1.0852037 ,  0.57659278, ..., -0.49598922,
        -0.45114679, -0.4630992 ],
       [ 0.85178574, -1.03888993, -0.27169328, ..., -0.49598922,
        -0.45114679, -0.4630992 ],
       [-0.38928398, -0.97096305, -0.4602013 , ..., -0.49598922,
         2.21657344, -0.4630992 ],
       ...,
       [ 0.77222999,  1.10698175,  3.68697501, ..., -0.49598922,
        -0.45114679, -0.4630992 ],
       [-0.0312831 , -0.01072407, -0.4602013 , ..., -0.49598922,
        -0.45114679, -0.4630992 ],
       [ 0.85178574, -0.20524194,  0.57659278, ...,  2.01617286,
        -0.45114679, -0.4630992 ]])</code></pre>
</div>
</div>
<div id="cell-21" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>model_selected <span class="op">=</span> LogisticRegression(max_iter<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>model_selected.fit(X_train_selected, y_train)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>selected_features <span class="op">=</span> X_train.columns[selector.support_]</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Prediction</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>y_pred_selected <span class="op">=</span> model_selected.predict(X_test_selected)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Optimal number of features: </span><span class="sc">{</span>selector<span class="sc">.</span>n_features_<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred_selected))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal number of features: 8
              precision    recall  f1-score   support

           0       0.87      0.94      0.90      3614
           1       0.68      0.48      0.56       968

    accuracy                           0.84      4582
   macro avg       0.77      0.71      0.73      4582
weighted avg       0.83      0.84      0.83      4582
</code></pre>
</div>
</div>
<p>The code below is used to identify which features will be used for the most optimal model prediction.</p>
<div id="cell-23" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>feature_names <span class="op">=</span> df.columns</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>selected_features <span class="op">=</span> feature_names[selector.support_]</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Selected features:"</span>, selected_features)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Selected features: Index(['loan_amnt', 'loan_int_rate', 'loan_percent_income',
       'person_home_ownership_OWN', 'person_home_ownership_RENT',
       'loan_intent_EDUCATION', 'loan_intent_PERSONAL', 'loan_intent_VENTURE'],
      dtype='object')</code></pre>
</div>
</div>
<div id="cell-24" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>thresholds <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">101</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>issued_counts <span class="op">=</span> []</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> threshold <span class="kw">in</span> thresholds:</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    X_train[<span class="st">'predicted_issued'</span>] <span class="op">=</span> X_train[<span class="st">'probabilities'</span>] <span class="op">&gt;=</span> threshold</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    issued_count <span class="op">=</span> X_train[<span class="st">'predicted_issued'</span>].<span class="bu">sum</span>()  </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    issued_counts.append(issued_count)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>plt.plot(thresholds, issued_counts)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Number of Loans Predicted to be Issued vs. Threshold'</span>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Threshold'</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Number of Loans Predicted to be Issued'</span>)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-17-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-25" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>X_train</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">loan_amnt</th>
<th data-quarto-table-cell-role="th">loan_int_rate</th>
<th data-quarto-table-cell-role="th">loan_percent_income</th>
<th data-quarto-table-cell-role="th">person_home_ownership_OWN</th>
<th data-quarto-table-cell-role="th">person_home_ownership_RENT</th>
<th data-quarto-table-cell-role="th">loan_intent_EDUCATION</th>
<th data-quarto-table-cell-role="th">loan_intent_PERSONAL</th>
<th data-quarto-table-cell-role="th">loan_intent_VENTURE</th>
<th data-quarto-table-cell-role="th">probabilities</th>
<th data-quarto-table-cell-role="th">actual</th>
<th data-quarto-table-cell-role="th">prediction_probability</th>
<th data-quarto-table-cell-role="th">predicted_issued</th>
<th data-quarto-table-cell-role="th">gain_loss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">7573</td>
<td>8875</td>
<td>7.51</td>
<td>0.23</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>0.105087</td>
<td>0</td>
<td>0.105087</td>
<td>False</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15865</td>
<td>15000</td>
<td>7.66</td>
<td>0.14</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>0.023507</td>
<td>0</td>
<td>0.023507</td>
<td>False</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18729</td>
<td>7200</td>
<td>7.88</td>
<td>0.12</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>0.022012</td>
<td>0</td>
<td>0.022012</td>
<td>False</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1288</td>
<td>3200</td>
<td>8.00</td>
<td>0.07</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>0.061475</td>
<td>0</td>
<td>0.061475</td>
<td>False</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12168</td>
<td>10500</td>
<td>16.32</td>
<td>0.23</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>0.600637</td>
<td>0</td>
<td>0.600637</td>
<td>False</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17438</td>
<td>15000</td>
<td>11.12</td>
<td>0.31</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>0.047207</td>
<td>0</td>
<td>0.047207</td>
<td>False</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24566</td>
<td>25000</td>
<td>12.18</td>
<td>0.21</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>0.097552</td>
<td>0</td>
<td>0.097552</td>
<td>False</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20105</td>
<td>14500</td>
<td>14.61</td>
<td>0.56</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>0.978011</td>
<td>1</td>
<td>0.978011</td>
<td>False</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17825</td>
<td>9450</td>
<td>10.99</td>
<td>0.12</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>0.083158</td>
<td>0</td>
<td>0.083158</td>
<td>False</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22678</td>
<td>15000</td>
<td>10.36</td>
<td>0.23</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>0.078296</td>
<td>0</td>
<td>0.078296</td>
<td>False</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>18325 rows × 13 columns</p>
</div>
</div>
</div>
<div id="cell-26" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimating the profit here into rows </span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>thresholds <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">101</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>average_gains <span class="op">=</span> []</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> threshold <span class="kw">in</span> thresholds:</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    X_train[<span class="st">'predicted_issued'</span>] <span class="op">=</span> X_train[<span class="st">'prediction_probability'</span>] <span class="op">&gt;=</span> threshold</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    X_train[<span class="st">'gain_loss'</span>] <span class="op">=</span> X_train.<span class="bu">apply</span>(calculate_gain_loss, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    average_gain_loss_per_issued_loan <span class="op">=</span> X_train.loc[X_train[<span class="st">'predicted_issued'</span>], <span class="st">'gain_loss'</span>].mean()</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    average_gains.append(average_gain_loss_per_issued_loan)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the average gain per issued loan across thresholds</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>plt.plot(thresholds, average_gains, label<span class="op">=</span><span class="st">'Average Gain Per Issued Loan'</span>)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Threshold'</span>)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Average Gain Per Issued Loan'</span>)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Average Gain Per Issued Loan vs. Threshold'</span>)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-27" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>X_train</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">loan_amnt</th>
<th data-quarto-table-cell-role="th">loan_int_rate</th>
<th data-quarto-table-cell-role="th">loan_percent_income</th>
<th data-quarto-table-cell-role="th">person_home_ownership_OWN</th>
<th data-quarto-table-cell-role="th">person_home_ownership_RENT</th>
<th data-quarto-table-cell-role="th">loan_intent_EDUCATION</th>
<th data-quarto-table-cell-role="th">loan_intent_PERSONAL</th>
<th data-quarto-table-cell-role="th">loan_intent_VENTURE</th>
<th data-quarto-table-cell-role="th">probabilities</th>
<th data-quarto-table-cell-role="th">actual</th>
<th data-quarto-table-cell-role="th">prediction_probability</th>
<th data-quarto-table-cell-role="th">predicted_issued</th>
<th data-quarto-table-cell-role="th">gain_loss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">7573</td>
<td>8875</td>
<td>7.51</td>
<td>0.23</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>0.105087</td>
<td>0</td>
<td>0.105087</td>
<td>False</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15865</td>
<td>15000</td>
<td>7.66</td>
<td>0.14</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>0.023507</td>
<td>0</td>
<td>0.023507</td>
<td>False</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18729</td>
<td>7200</td>
<td>7.88</td>
<td>0.12</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>0.022012</td>
<td>0</td>
<td>0.022012</td>
<td>False</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1288</td>
<td>3200</td>
<td>8.00</td>
<td>0.07</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>0.061475</td>
<td>0</td>
<td>0.061475</td>
<td>False</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12168</td>
<td>10500</td>
<td>16.32</td>
<td>0.23</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>0.600637</td>
<td>0</td>
<td>0.600637</td>
<td>False</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17438</td>
<td>15000</td>
<td>11.12</td>
<td>0.31</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>0.047207</td>
<td>0</td>
<td>0.047207</td>
<td>False</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24566</td>
<td>25000</td>
<td>12.18</td>
<td>0.21</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>0.097552</td>
<td>0</td>
<td>0.097552</td>
<td>False</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20105</td>
<td>14500</td>
<td>14.61</td>
<td>0.56</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>0.978011</td>
<td>1</td>
<td>0.978011</td>
<td>False</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17825</td>
<td>9450</td>
<td>10.99</td>
<td>0.12</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>0.083158</td>
<td>0</td>
<td>0.083158</td>
<td>False</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22678</td>
<td>15000</td>
<td>10.36</td>
<td>0.23</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>0.078296</td>
<td>0</td>
<td>0.078296</td>
<td>False</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>18325 rows × 13 columns</p>
</div>
</div>
</div>
</section>
<section id="cross-validation" class="level2">
<h2 class="anchored" data-anchor-id="cross-validation">Cross Validation</h2>
<p>I did not want to limit myself to only one model however, so I used <code>cross_val_score</code> from the <code>sklearn.model_selection</code> in order to compare how my ‘Optimal’ LR model did against other LR models with a different combination of features.</p>
<div id="cell-29" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_val_score</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>selected_features <span class="op">=</span> [<span class="st">'loan_amnt'</span>, <span class="st">'loan_int_rate'</span>, <span class="st">'loan_percent_income'</span>, <span class="st">'person_home_ownership_OWN'</span>, <span class="st">'person_home_ownership_RENT'</span>, <span class="st">'loan_intent_EDUCATION'</span>, <span class="st">'loan_intent_PERSONAL'</span>, <span class="st">'loan_intent_VENTURE'</span>]</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>feature_combinations <span class="op">=</span> [</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'loan_amnt'</span>, <span class="st">'loan_int_rate'</span>],  </span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'loan_percent_income'</span>, <span class="st">'person_home_ownership_RENT'</span>],  </span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    selected_features  </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-30" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> {}</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> features <span class="kw">in</span> feature_combinations:</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Scale features</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    X_scaled <span class="op">=</span> scaler.fit_transform(df[features])</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    LR <span class="op">=</span> LogisticRegression(max_iter<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    cv_scores_LR <span class="op">=</span> cross_val_score(LR, X_scaled, y, cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    results[<span class="bu">str</span>(features)] <span class="op">=</span> cv_scores_LR.mean()</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> combo, score <span class="kw">in</span> results.items():</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Features: </span><span class="sc">{</span>combo<span class="sc">}</span><span class="ch">\n</span><span class="ss">CV Score (mean accuracy): </span><span class="sc">{</span>score<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Features: ['loan_amnt', 'loan_int_rate']
CV Score (mean accuracy): 0.7973108709793388

Features: ['loan_percent_income', 'person_home_ownership_RENT']
CV Score (mean accuracy): 0.8471203482091736

Features: ['loan_amnt', 'loan_int_rate', 'loan_percent_income', 'person_home_ownership_OWN', 'person_home_ownership_RENT', 'loan_intent_EDUCATION', 'loan_intent_PERSONAL', 'loan_intent_VENTURE']
CV Score (mean accuracy): 0.848342893535451
</code></pre>
</div>
</div>
<p>As seen above, the ‘Optimal’ feature LR model performed the best in predicting the likelihood of a default.</p>
</section>
<section id="part-d-finding-a-threshold" class="level2">
<h2 class="anchored" data-anchor-id="part-d-finding-a-threshold">Part D: Finding a Threshold</h2>
<p>In this section, we will be exploring how I came up with the threshold <code>t</code> that will be used for our model.</p>
<p>I used the <code>numpy</code> package to compute linear scores across all <code>n</code> of our training points.</p>
<p>I plotted the scores below in order to easily visualize this process. By gathering scores, we can easily simulate decision-making with a given threshold.</p>
<div id="cell-33" class="cell" data-execution_count="257">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> linear_score(X, w):</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X <span class="op">@</span> w</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-34" class="cell" data-execution_count="258">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting weights </span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> model.coef_.flatten()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-35" class="cell" data-execution_count="259">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>scores <span class="op">=</span> linear_score(X_train_selected, w) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-fig-hist-score" class="cell" data-execution_count="260">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>plt.hist(scores, bins<span class="op">=</span><span class="dv">30</span>, edgecolor<span class="op">=</span><span class="st">'k'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="vs">r"Score $s$"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Frequency"</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Histogram of Computed Scores"</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-hist-score" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hist-score-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-hist-score-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hist-score-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Histogram of Computed Scores
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="roc-curve" class="level1">
<h1>ROC Curve</h1>
<p>Next we created an ROC curve in order to illustrate all the possible tradeoffs between the True Positive Rate and False Positive Rate that are achievable for a given score as we vary the threshold <code>t</code></p>
<div id="cell-38" class="cell" data-execution_count="261">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>num_thresholds <span class="op">=</span> <span class="dv">101</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>FPR <span class="op">=</span> np.zeros(num_thresholds)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>TPR <span class="op">=</span> np.zeros(num_thresholds)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> np.linspace(scores.<span class="bu">min</span>() <span class="op">-</span> <span class="fl">0.1</span>, scores.<span class="bu">max</span>() <span class="op">+</span> <span class="fl">0.1</span>, num_thresholds)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_thresholds):</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> T[i]</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    preds <span class="op">=</span> scores <span class="op">&gt;=</span> t</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    FPR[i] <span class="op">=</span> ((preds <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (y_train <span class="op">==</span> <span class="dv">0</span>)).<span class="bu">sum</span>() <span class="op">/</span> (y_train <span class="op">==</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    TPR[i] <span class="op">=</span> ((preds <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (y_train <span class="op">==</span> <span class="dv">1</span>)).<span class="bu">sum</span>() <span class="op">/</span> (y_train <span class="op">==</span> <span class="dv">1</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-fig-ROC" class="cell" data-execution_count="262">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>ax.plot(FPR, TPR, color<span class="op">=</span><span class="st">"black"</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>ax.plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">1</span>], linestyle<span class="op">=</span><span class="st">"--"</span>, color<span class="op">=</span><span class="st">"grey"</span>)  </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>ax.set_aspect(<span class="st">'equal'</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"False Positive Rate"</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"True Positive Rate"</span>)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"ROC Curve"</span>)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-roc" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-roc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-roc-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-roc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: ROC curve for Model
</figcaption>
</figure>
</div>
</div>
</div>
<p>As seen in <strong>?@fig-ROC</strong>, our curve bows towards the top left of the plot. Indicating that our model is a more effective classifier.</p>
<p>For a reference curves that bow towards the top left of the plot are seen as more effective classifiers and those that bow inwards are seen as less effective classifiers.</p>
<section id="evaluate-different-thresholds" class="level2">
<h2 class="anchored" data-anchor-id="evaluate-different-thresholds">Evaluate Different Thresholds</h2>
<p>Although the previous data from <a href="#fig-hist-score" class="quarto-xref">Figure&nbsp;3</a> and <strong>?@fig-ROC</strong> are useful, often times banks want to set a threshold that maximizes profit-loss.</p>
<p>We use a two assumptions below to account for the profit and loss of a bank if a loan is repaid in full and if a loan is defaulted on.</p>
<p>We then calculate the expected profit per issued loan for each threshold, and find the threshold that is the most optimal for generating overall profit. We can accomplish this by generating a <code>gain_loss</code> column within our <code>X_train</code> dataset in order to easily summarize the overall average gain/loss for each issued loan at each threshold value.</p>
<p>This relationship is illustrated in <a href="#fig-thres" class="quarto-xref">Figure&nbsp;5</a>.</p>
<div id="cell-42" class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df[selected_features]</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">123</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>X_train_scaled <span class="op">=</span> scaler.fit_transform(X_train)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>X_test_scaled <span class="op">=</span> scaler.transform(X_test)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co">## MODEL HERE</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LogisticRegression(max_iter<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>model.fit(X_train_scaled, y_train)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict probabilities</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>probabilities <span class="op">=</span> model.predict_proba(X_train_scaled)[:, <span class="dv">1</span>]</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>X_train[<span class="st">'actual'</span>] <span class="op">=</span> y_train</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>X_train[<span class="st">'prediction_probability'</span>] <span class="op">=</span> probabilities</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-43" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_gain_loss(row):</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> row[<span class="st">'predicted_issued'</span>]:</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> row[<span class="st">'actual'</span>] <span class="op">==</span> <span class="dv">0</span>:  <span class="co"># Loan was repaid</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> row[<span class="st">'loan_amnt'</span>] <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> <span class="fl">0.25</span> <span class="op">*</span> row[<span class="st">'loan_int_rate'</span>])<span class="op">**</span><span class="dv">10</span> <span class="op">-</span> row[<span class="st">'loan_amnt'</span>]</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> row[<span class="st">'actual'</span>] <span class="op">==</span> <span class="dv">1</span>:  <span class="co"># Loan defaulted</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> row[<span class="st">'loan_amnt'</span>] <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> <span class="fl">0.25</span> <span class="op">*</span> row[<span class="st">'loan_int_rate'</span>])<span class="op">**</span><span class="dv">3</span> <span class="op">-</span> <span class="fl">1.7</span> <span class="op">*</span> row[<span class="st">'loan_amnt'</span>]</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-44" class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimating the profit here into rows </span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>thresholds <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">101</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>average_gains <span class="op">=</span> []</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> threshold <span class="kw">in</span> thresholds:</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    X_train[<span class="st">'predicted_issued'</span>] <span class="op">=</span> X_train[<span class="st">'prediction_probability'</span>] <span class="op">&gt;=</span> threshold</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    X_train[<span class="st">'gain_loss'</span>] <span class="op">=</span> X_train.<span class="bu">apply</span>(calculate_gain_loss, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if any loans are predicted to be issued at this threshold</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> X_train[<span class="st">'predicted_issued'</span>].<span class="bu">sum</span>() <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>        average_gain_loss_per_issued_loan <span class="op">=</span> X_train.loc[X_train[<span class="st">'predicted_issued'</span>], <span class="st">'gain_loss'</span>].mean()</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># No loans are issued, so append a default value (e.g., 0) to avoid NaN</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>        average_gain_loss_per_issued_loan <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>    average_gains.append(average_gain_loss_per_issued_loan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-fig-thres" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the average gain per issued loan across thresholds</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>plt.plot(thresholds, average_gains, label<span class="op">=</span><span class="st">'Average Gain Per Issued Loan'</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Threshold (Probability of Default)'</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Average Gain Per Issued Loan'</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Average Gain Per Issued Loan vs. Threshold'</span>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-thres" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-thres-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-thres-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-thres-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Expected Profit per Loan vs Threshold
</figcaption>
</figure>
</div>
</div>
</div>
<div id="cell-46" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>optimal_index <span class="op">=</span> np.argmax(average_gains)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>optimal_threshold <span class="op">=</span> thresholds[optimal_index]</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Optimal Threshold: </span><span class="sc">{</span>optimal_threshold<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Average Gain Per Issued Loan at Optimal Threshold: </span><span class="sc">{</span>average_gains[optimal_index]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal Threshold: 0.25
Maximum Average Gain Per Issued Loan at Optimal Threshold: 24992323662.99832</code></pre>
</div>
</div>
<p>We use the above code to find the most optimal threshold which presents us with the highest level of expected profit.</p>
<p>Our model finds that a threshold of 0.25 is the most optimal, with an expected average gain of $24,992,323,663 per borrower</p>
<p>While yes, this number appears rather high, our simple assumptions assume compounded interest while real life situations may differ significantly</p>
</section>
<section id="part-e-evaluating-the-model-from-the-banks-perspective" class="level2">
<h2 class="anchored" data-anchor-id="part-e-evaluating-the-model-from-the-banks-perspective">Part E: Evaluating the Model from the Bank’s Perspective</h2>
<p>After finding an optimal threshold value of 0.25, let’s see how our model compares to the test set.</p>
</section>
</section>
<section id="pre-process-the-test-dataset" class="level1">
<h1>Pre-Process the Test Dataset</h1>
<p>First we have to prepare the test set by performing the same preprocessing steps we did on our training set.</p>
<div id="cell-50" class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Load test data</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>df_test <span class="op">=</span> pd.read_csv(<span class="st">"https://raw.githubusercontent.com/PhilChodrow/ml-notes/main/data/credit-risk/test.csv"</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>df_test <span class="op">=</span> pd.get_dummies(df_test, columns<span class="op">=</span>[<span class="st">'person_home_ownership'</span>, <span class="st">'loan_intent'</span>, <span class="st">'cb_person_default_on_file'</span>], drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>df_test.dropna(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-51" class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> df_test.drop([<span class="st">'loan_grade'</span>, <span class="st">'loan_status'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>y_test <span class="op">=</span> df_test[<span class="st">'loan_status'</span>].values</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>selected_features <span class="op">=</span> [<span class="st">'loan_amnt'</span>, <span class="st">'loan_int_rate'</span>, <span class="st">'loan_percent_income'</span>, <span class="st">'person_home_ownership_OWN'</span>, <span class="st">'person_home_ownership_RENT'</span>, <span class="st">'loan_intent_EDUCATION'</span>, <span class="st">'loan_intent_PERSONAL'</span>, <span class="st">'loan_intent_VENTURE'</span>]</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> df_test[selected_features]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-52" class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>probabilities_test <span class="op">=</span> model.predict_proba(X_test)[:, <span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/donovanwood/anaconda3/envs/ml-0451/lib/python3.9/site-packages/sklearn/base.py:432: UserWarning: X has feature names, but LogisticRegression was fitted without feature names
  warnings.warn(</code></pre>
</div>
</div>
<div id="cell-53" class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>X_test[<span class="st">'prediction_probability'</span>] <span class="op">=</span> probabilities_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2783352999.py:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  X_test['prediction_probability'] = probabilities_test</code></pre>
</div>
</div>
<div id="cell-54" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/PhilChodrow/ml-notes/main/data/credit-risk/train.csv"</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>df_all <span class="op">=</span> pd.read_csv(url)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Dropping rows with missing target or essential features for the specified analysis</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df_all.drop([<span class="st">'loan_grade'</span>, <span class="st">'loan_status'</span>], axis<span class="op">=</span><span class="dv">1</span>)  </span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.get_dummies(df, columns<span class="op">=</span>[<span class="st">'person_home_ownership'</span>, <span class="st">'loan_intent'</span>, <span class="st">'cb_person_default_on_file'</span>], drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>df.dropna(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df_all.loc[df.index, <span class="st">'loan_status'</span>]  </span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing the features (including creation of dummy variables for categorical features)</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>selected_features <span class="op">=</span> [<span class="st">'loan_amnt'</span>, <span class="st">'loan_int_rate'</span>, <span class="st">'loan_percent_income'</span>, <span class="st">'person_home_ownership_OWN'</span>, <span class="st">'person_home_ownership_RENT'</span>, <span class="st">'loan_intent_EDUCATION'</span>, <span class="st">'loan_intent_PERSONAL'</span>, <span class="st">'loan_intent_VENTURE'</span>]</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df[selected_features]</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into training and test sets</span></span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Scaling the features</span></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>X_train_scaled <span class="op">=</span> scaler.fit_transform(X_train)</span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>X_test_scaled <span class="op">=</span> scaler.transform(X_test)</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the logistic regression model</span></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LogisticRegression(max_iter<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>model.fit(X_train_scaled, y_train)</span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict probabilities</span></span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>probabilities <span class="op">=</span> model.predict_proba(X_train_scaled)[:, <span class="dv">1</span>]</span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Threshold for making a loan (e.g., where model predicts no default)</span></span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>threshold <span class="op">=</span> <span class="fl">0.8</span></span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the gain, loss, and the decision to issue a loan</span></span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>df_train <span class="op">=</span> pd.DataFrame(X_train, columns<span class="op">=</span>selected_features)</span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>df_train[<span class="st">'Actual'</span>] <span class="op">=</span> y_train.values</span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>df_train[<span class="st">'Prob_NoDefault'</span>] <span class="op">=</span> probabilities</span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>df_train[<span class="st">'Decision'</span>] <span class="op">=</span> df_train[<span class="st">'Prob_NoDefault'</span>] <span class="op">&gt;=</span> threshold</span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Profit and loss calculations)</span></span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_profit(loan_amnt, loan_int_rate):</span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> loan_amnt <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> <span class="fl">0.25</span> <span class="op">*</span> loan_int_rate)<span class="op">**</span><span class="dv">10</span> <span class="op">-</span> loan_amnt</span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_loss(loan_amnt, loan_int_rate):</span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span>(loan_amnt <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> <span class="fl">0.25</span> <span class="op">*</span> loan_int_rate)<span class="op">**</span><span class="dv">3</span> <span class="op">-</span> <span class="fl">1.7</span> <span class="op">*</span> loan_amnt)</span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply profit/loss based on decision and actual outcome</span></span>
<span id="cb46-57"><a href="#cb46-57" aria-hidden="true" tabindex="-1"></a>df_train[<span class="st">'PNL'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true" tabindex="-1"></a>df_train.loc[df_train[<span class="st">'Decision'</span>] <span class="op">&amp;</span> (df_train[<span class="st">'Actual'</span>] <span class="op">==</span> <span class="dv">1</span>), <span class="st">'PNL'</span>] <span class="op">=</span> df_train.<span class="bu">apply</span>(<span class="kw">lambda</span> row: calculate_loss(row[<span class="st">'loan_amnt'</span>], row[<span class="st">'loan_int_rate'</span>]), axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true" tabindex="-1"></a>df_train.loc[df_train[<span class="st">'Decision'</span>] <span class="op">&amp;</span> (df_train[<span class="st">'Actual'</span>] <span class="op">==</span> <span class="dv">0</span>), <span class="st">'PNL'</span>] <span class="op">=</span> df_train.<span class="bu">apply</span>(<span class="kw">lambda</span> row: calculate_profit(row[<span class="st">'loan_amnt'</span>], row[<span class="st">'loan_int_rate'</span>]), axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-61"><a href="#cb46-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate expected profit per loan issued (only include loans where a decision to issue was made)</span></span>
<span id="cb46-62"><a href="#cb46-62" aria-hidden="true" tabindex="-1"></a>issued_loans <span class="op">=</span> df_train[df_train[<span class="st">'Decision'</span>]]</span>
<span id="cb46-63"><a href="#cb46-63" aria-hidden="true" tabindex="-1"></a>expected_profit_per_issued_loan <span class="op">=</span> issued_loans[<span class="st">'PNL'</span>].<span class="bu">sum</span>() <span class="op">/</span> issued_loans.shape[<span class="dv">0</span>] <span class="cf">if</span> issued_loans.shape[<span class="dv">0</span>] <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb46-64"><a href="#cb46-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-65"><a href="#cb46-65" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Expected Profit per Loan Issued: $</span><span class="sc">{</span>expected_profit_per_issued_loan<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_5192/3730232185.py:58: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[-1257557.088       -328665.524875    -777366.47205    -1195907.645925
 -1666649.73280781  -897005.57521094 -1470617.988       -552622.2431625
 -1583145.2109375  -1288438.70596875  -644843.91125    -5210427.14953125
 -4944903.528375   -1743316.1328125   -112117.27455     -871944.43359375
 -2392321.27640625 -3025933.84114844  -124355.763       -777366.47205
  -950421.9375     -1067283.4195625  -1990154.01375    -1071986.30085937
 -1799328.272      -1222690.08760937  -617625.         -1257557.088
 -1101060.15359375  -795311.34373828 -3649806.827625   -1168516.73828125
 -1060895.44140625 -1420152.1443     -1229288.572       -505087.87109375
 -1402220.0859375  -5607432.61489687 -3503661.0052125  -2325739.32421875
 -1071665.02937813 -1186249.48298828  -981571.3949     -2921291.84570312
  -862726.89671875  -191413.61058594 -1121172.7455      -761609.0435625
 -1632206.1634375  -1561693.4525      -398093.3999875  -1370788.09020313
 -1354238.53107813  -969366.922      -1037364.04209375 -1669435.742375
 -1058389.58239648 -1177653.8784375  -1495405.1893125   -967898.80434844
  -794114.70947266 -1189470.39553125  -521450.27153516 -3408231.4453125
  -870521.04978125 -3708677.64628125  -659643.83789062 -1563128.14485937
  -981041.436      -1108013.34360938  -769453.71083984 -1171270.089375
 -2619910.6         -828497.0421     -1123049.3030625  -1507039.95585937
 -1201021.390625    -472853.93203125  -154565.0528625   -879815.5693125
  -571726.027125    -942123.10275     -785973.18       -3390065.61775
  -495712.6789     -4328638.129375   -1226301.795      -2300557.95679687
 -1706557.06679063 -1361910.6142875  -3067410.6090625   -584658.7456
  -487912.433625    -917617.4295625   -137051.16495    -1377460.0240625
 -3408231.4453125  -2936242.43625    -2885240.03632813 -1143248.43284961
 -1373077.6         -400819.23       -1635973.35023438 -1099124.94155625
  -127696.02539062  -410266.5590625   -162920.17016563 -1706557.06679063
 -1333801.916125   -1048539.32367187 -1583145.2109375   -835876.61152344
 -3756102.36075    -3408231.4453125  -2733779.5340625  -1153622.77015234
  -688730.01203125 -1383004.77078125  -884401.32616172  -472853.93203125
 -1463512.44402344 -3204858.98075     -571758.59907031 -1051665.06445312
 -1553270.04875     -475584.1663125  -3233261.33590625 -3390065.61775
  -547022.07875    -1969699.94648047  -714657.53390625 -1793837.70703125
 -1397943.043875   -1980137.6190625  -1161724.00745625  -733179.64109375
  -403248.80260156 -1044061.1971875  -1383004.77078125  -879815.5693125
 -2908307.31495273  -399526.59179688 -1110800.0463125  -1684439.77315625
 -4077298.06914063  -979323.6980625   -371229.0155      -390075.84
 -2022992.14014844 -2282887.04315625  -584658.7456     -1726200.
  -374618.197375   -1436691.45965625 -3101490.61523438  -856806.15234375
  -659643.83789062 -1459165.24125    -1674617.42276562  -741634.4544
 -1612109.778125   -2032327.51101562 -1024458.71081641 -2034459.92080625
 -2757004.2         -851899.5045     -1384915.2174375  -1285368.41210937
 -1343352.43175    -2311784.3475     -1023423.53037812 -1774199.88662109
 -1793837.70703125   -95814.92471484  -617625.         -1035179.48627734
  -996908.44794531 -2368337.832125   -1205245.02489961 -1581904.2008
  -763934.64820312  -500873.03696875 -1062595.37212422  -259412.8788125
 -1651590.23039062 -1015100.744125   -1094031.43741406  -633724.96
 -1079638.84701563  -769778.46897578 -1043538.976      -2888476.14990234
 -2850136.9128     -1126561.558       -527715.0703125   -753541.15725
 -1659848.18154258  -814863.62475     -269333.108      -2093571.31725
 -1067777.7025     -5202980.99070312 -1874160.          -134008.48455469
  -723379.1788125  -2501354.74488047 -2323362.285      -2601727.33165625
 -2619910.6        -5970462.04125     -779624.17914063  -663998.04296875
 -2883348.407625    -572910.625      -2466000.         -1193922.6725
  -291690.65332656  -986825.43421875  -415592.06271289 -2778841.10820312
 -1707970.81507422 -3091601.395875    -705917.70766406 -2705151.22139062
 -2212807.63325    -1217318.04962578 -3844287.         -1032246.96892187
  -691269.39116211 -1171100.0382     -2741813.7221875   -703460.51464844
 -2197964.24494453  -419683.06800273  -875021.532       -926680.54317969
 -1755340.102      -3756102.36075     -726361.72621875  -764789.71151953
 -1257557.088      -1146554.66384375 -1108037.10796875 -1383004.77078125
  -714657.53390625  -726719.02202812 -1144548.342       -738675.56240625
 -1326812.26572969 -2973131.9946875   -626436.7183125   -467406.6953125
  -423955.3962375  -4968960.08632813  -794260.50077188 -1594802.95898438
 -1177589.53125    -1991132.056       -772341.0211875   -995350.77504688
  -818967.61703125 -1226964.243625   -2467063.58554687 -1059888.49059375
  -710848.90138281 -1167076.67660938  -858467.09834375 -1106403.816625
 -1869626.78125    -3389370.47394375 -1198883.77475    -1651590.23039062
  -474223.27148438 -1428491.18264063  -447618.69875     -740017.02649219
 -1252058.20059609 -1068985.9544     -1411896.52466406 -1594522.40625
 -2334153.35321875 -1508129.27324609 -2058082.81459375  -510429.227
 -1975665.8078125   -253182.71258437  -408980.85839844 -5674627.55953125
 -1214603.807625   -1446333.02526563 -3317860.80039062  -414901.43123437
 -2498761.78291406  -735046.07080078 -1060895.44140625 -1246405.38985937
 -1258228.91985156  -450984.018625   -1531308.8846875  -1760932.32
 -1481447.5128     -1829171.176      -3872270.475      -2876631.52
 -1048539.32367187  -937016.0715     -3494605.13325    -1298753.425025
 -4378451.7853125  -1093776.915       -998658.51744531 -1138219.644375
  -536907.296475   -3142145.383125   -1846688.90601563 -1869626.78125
  -339462.32860547 -1407411.08890625  -734432.41206563 -4933446.84328125
  -467357.3058      -618866.633      -1630919.22765625  -633724.96
 -4077298.06914063  -767629.961      -1336823.810625   -1964265.
  -896930.73444375 -1611727.84275781 -2006121.4578     -2378505.59575
  -372293.9905      -688927.51888594 -1822117.1034375   -740384.76293359
 -1253807.856      -2498237.65234375 -2147187.42634375  -900864.37873438
  -344365.00601563  -664808.00616563 -2737794.6875      -822296.888
 -3433015.67371875 -2737794.6875      -309303.1393125  -1430896.87961719
 -1169522.16992188 -2892521.734375    -997354.11363437 -2694322.44
  -245125.5345     -4357210.368      -1121172.7455      -681465.553125
 -2087568.44921875 -2047419.04257813 -1064913.67350156  -328233.63126563
  -999211.46626602 -1477351.1248125  -1110800.0463125  -1293965.12
  -978747.47875    -1658552.35603125 -1251580.01675     -875021.532
  -560352.75300234  -933661.3412875  -1806875.57739453  -783045.89789062
  -932268.04488125 -3501158.7335      -959537.45125    -2180469.86532656
 -2337033.4765625  -1664953.917025   -1659781.45019531  -404170.48739844
 -2192468.30859375 -4168130.98789063 -1046785.658625    -470282.68452734
 -1372595.875      -1479600.         -1736809.04984375 -2129579.85351562
 -1030301.20937188 -5964405.02929688 -1263904.19628906 -2042868.806325
 -5466221.6        -1022859.684       -958240.95032422  -468742.08125391
  -409901.25507188 -1659605.7249375  -1098462.08       -3501158.7335
 -1223488.9573125  -2466000.         -1148481.66351563 -1847083.5744
 -1949670.20507813  -643191.78051563 -1865497.0703125  -1894600.08510117
 -1214603.807625    -704576.54435    -2368875.952       -756617.0079375
  -753121.99802813  -591811.34378516 -3829392.36476562 -1089584.6491875
  -414037.58154297  -156169.34525     -817534.53        -503269.08496484
 -1288167.24828125  -538777.215125   -1387375.23892187  -480369.0888
 -1814020.55419922 -1111536.44328125 -1386096.33334375 -1764307.84
 -1250356.41517383  -870712.43828125 -2921291.84570312 -2172747.54638672
  -467766.19873047 -1525401.61621094 -3210982.5542625  -1307487.09960938
  -507357.02095312  -361112.5903      -929054.79407813  -390422.97314453
 -1970375.52446875 -1324153.39021875 -1929780.201375   -1516297.31729062
 -1102801.68       -1270765.503       -829802.86246875  -768204.56422266
 -1846688.90601563 -3117337.248375   -1173087.42575    -1435599.77382031
 -1131801.3792     -1170589.          -454376.0900625  -4925938.81117188
 -1578240.          -162920.17016563  -632850.26        -738675.56240625
  -903721.67675781  -516680.49141836  -435131.34765625 -1651590.23039062
 -1887938.81662656  -664393.136625   -1237586.01191406 -1028807.29248828
  -795493.25633594 -1713654.944       -797271.76395     -248473.222
 -1432922.63750391 -2613408.         -1071986.30085937 -4478534.659375
 -1248715.43776875 -4365563.63554688 -1652952.028875   -1572013.3563
 -4944903.528375   -1984901.1484375  -3120150.2        -1427103.35745
 -1672585.6503125   -934813.390625   -2222171.2692     -1433810.97453125
 -1776285.78159375 -1618113.906       -658800.         -1080877.98291016
 -2060151.51669922 -1027871.11       -1786643.83476562  -322421.955625
 -1155892.17375     -746160.8998125  -1618249.04325     -870712.43828125
 -5466221.6         -452443.06483672 -2229848.99601562 -2074507.15617187
 -2357919.54       -1188560.51240781 -1396980.363375    -874591.288125
  -666878.52861875 -1182870.02401172 -1515866.428125    -418654.35569141
 -1027079.76523438  -453972.53792188  -783468.94480312  -954278.79178125
  -403534.29234375  -785973.18        -629816.46228555 -2646965.812375
 -1298222.861625    -692523.19248047 -1578464.12695703  -440513.43046875
 -2195686.59113672  -529344.8064      -852057.86132812  -975197.930875
 -1471562.154      -1652952.028875    -478440.88769531  -891061.92857812
  -785706.         -1800424.86755    -1265700.52       -1952116.815625
 -1110800.0463125  -1045989.6796875  -1973378.7373125   -305381.69204375
  -708230.35916797 -1530866.390625   -1363292.578125   -1310224.18690625
 -1171270.089375   -2347909.76       -1394017.371      -2079648.21875
 -1738643.55075     -606792.71475    -2600904.953125    -953133.53342187
 -6973730.95028125 -1825566.29743125 -1035272.2760625   -667847.025675
 -2722300.          -795311.34373828 -1042387.2         -246225.18746875
  -712972.699      -1227608.49614453 -1531308.8846875   -383426.03759766
 -1879530.68108672 -1520878.57282422 -1972800.         -1214100.954
  -648532.19703125 -1914136.10585937  -324296.66826562 -3482849.753125
 -1695728.925       -596668.149      -3275560.46726562 -1660982.8415625
 -1106403.816625    -348105.078125   -1348429.65151172  -782102.0592
  -338017.7914375   -615562.96867188  -264020.8029375  -1682154.656
  -957141.36245039 -1594802.95898438  -145363.19824219 -2687120.795625
  -691502.38539062  -888638.86021094 -4233634.06605469 -4173589.3559375
 -1849500.         -4735074.4         -531737.0488      -997978.64565
 -1383004.77078125 -2466000.         -1530866.390625    -381535.336
  -740384.76293359  -946327.5        -1667304.66492187  -929001.02410937
 -1266669.98001563  -916474.55136719  -592855.39550781  -349207.12017969
  -588826.93921875 -1553270.04875    -1087289.034125   -3639500.85772266
 -1460645.92285156 -1956915.20140625  -821768.416      -1480238.15132813
  -896930.73444375 -1104940.4174375   -480369.0888      -509289.76546875
  -122490.365       -824312.671875    -898439.44245    -1229703.76521563
 -1651590.23039062 -2889730.434375    -937016.0715      -655174.093625
 -1152088.64794141  -898439.44245     -569277.315       -663361.66992188
 -2074507.15617187  -331999.02148438  -940190.26022578 -3114306.44774375
 -1674617.42276562 -1055959.62111719 -1236753.75125     -926680.54317969
  -330560.53692969 -1461902.71240234  -478440.88769531  -583347.688
 -1018579.5309375  -2694322.44       -1346943.0378125  -3249450.34179688
 -1194092.40825    -1644482.28109375  -749302.35921875  -663912.58007813
  -996908.44794531  -925433.40724531 -3433632.75896563 -1145102.5597375
  -541027.34415352 -1343352.43175    -1155892.17375     -518825.757625
 -1531010.840625   -1624126.9428125   -321808.75882813  -585420.51022656
 -1069459.0485     -1639890.         -1978931.51367187  -995350.77504688
  -822296.888       -160332.40558125 -1226964.243625    -814166.623375
  -903721.67675781  -900864.37873438  -844857.08886719  -696416.839825
 -1231125.93734375  -883240.40882813  -325625.65695625  -632850.26
 -2814822.1778125  -2341960.21220625 -1113687.0465     -5377775.32304688
  -927043.068      -1619527.833      -1578130.03759766 -1705116.88378125
  -453972.53792188 -2337033.4765625   -342973.022      -1225047.10775
 -4173926.47251562  -321574.86578437  -624985.6694625   -310372.15979492
 -1956915.20140625  -345684.5       ]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  df_train.loc[df_train['Decision'] &amp; (df_train['Actual'] == 1), 'PNL'] = df_train.apply(lambda row: calculate_loss(row['loan_amnt'], row['loan_int_rate']), axis=1)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Expected Profit per Loan Issued: $12939375668.25</code></pre>
</div>
</div>
<div id="cell-55" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>issued_loans</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">loan_amnt</th>
<th data-quarto-table-cell-role="th">loan_int_rate</th>
<th data-quarto-table-cell-role="th">loan_percent_income</th>
<th data-quarto-table-cell-role="th">person_home_ownership_OWN</th>
<th data-quarto-table-cell-role="th">person_home_ownership_RENT</th>
<th data-quarto-table-cell-role="th">loan_intent_EDUCATION</th>
<th data-quarto-table-cell-role="th">loan_intent_PERSONAL</th>
<th data-quarto-table-cell-role="th">loan_intent_VENTURE</th>
<th data-quarto-table-cell-role="th">Actual</th>
<th data-quarto-table-cell-role="th">Prob_NoDefault</th>
<th data-quarto-table-cell-role="th">Decision</th>
<th data-quarto-table-cell-role="th">PNL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">20675</td>
<td>12000</td>
<td>14.96</td>
<td>0.35</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>1</td>
<td>0.899886</td>
<td>True</td>
<td>-1.257557e+06</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10365</td>
<td>8000</td>
<td>9.99</td>
<td>0.56</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>1</td>
<td>0.972322</td>
<td>True</td>
<td>-3.286655e+05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11608</td>
<td>14800</td>
<td>11.14</td>
<td>0.49</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>1</td>
<td>0.920965</td>
<td>True</td>
<td>-7.773665e+05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1543</td>
<td>14400</td>
<td>13.57</td>
<td>0.40</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>1</td>
<td>0.843414</td>
<td>True</td>
<td>-1.195908e+06</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11628</td>
<td>14900</td>
<td>15.37</td>
<td>0.44</td>
<td>False</td>
<td>True</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>1</td>
<td>0.923548</td>
<td>True</td>
<td>-1.666650e+06</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12263</td>
<td>4200</td>
<td>13.11</td>
<td>0.28</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>1</td>
<td>0.806834</td>
<td>True</td>
<td>-3.215749e+05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22090</td>
<td>2700</td>
<td>20.62</td>
<td>0.17</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>1</td>
<td>0.836183</td>
<td>True</td>
<td>-6.249857e+05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3103</td>
<td>4375</td>
<td>12.69</td>
<td>0.29</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>1</td>
<td>0.802679</td>
<td>True</td>
<td>-3.103722e+05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22459</td>
<td>10000</td>
<td>19.29</td>
<td>0.33</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>1</td>
<td>0.954498</td>
<td>True</td>
<td>-1.956915e+06</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18171</td>
<td>4000</td>
<td>13.80</td>
<td>0.33</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>1</td>
<td>0.860109</td>
<td>True</td>
<td>-3.456845e+05</td>
</tr>
</tbody>
</table>

<p>763 rows × 12 columns</p>
</div>
</div>
</div>
<div id="cell-56" class="cell" data-execution_count="117">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>X_train</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="117">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">loan_amnt</th>
<th data-quarto-table-cell-role="th">loan_int_rate</th>
<th data-quarto-table-cell-role="th">loan_percent_income</th>
<th data-quarto-table-cell-role="th">person_home_ownership_OWN</th>
<th data-quarto-table-cell-role="th">person_home_ownership_RENT</th>
<th data-quarto-table-cell-role="th">loan_intent_EDUCATION</th>
<th data-quarto-table-cell-role="th">loan_intent_PERSONAL</th>
<th data-quarto-table-cell-role="th">loan_intent_VENTURE</th>
<th data-quarto-table-cell-role="th">Prediction</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">21383</td>
<td>5000</td>
<td>13.57</td>
<td>0.10</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>0.154000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2116</td>
<td>1200</td>
<td>13.85</td>
<td>0.02</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>0.011135</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5631</td>
<td>6500</td>
<td>10.99</td>
<td>0.12</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>0.102757</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20675</td>
<td>12000</td>
<td>14.96</td>
<td>0.35</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>0.899886</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9582</td>
<td>9325</td>
<td>10.91</td>
<td>0.13</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>0.169294</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13577</td>
<td>2500</td>
<td>8.88</td>
<td>0.05</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>0.043215</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24532</td>
<td>17050</td>
<td>12.69</td>
<td>0.28</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>0.359268</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6125</td>
<td>5000</td>
<td>13.11</td>
<td>0.18</td>
<td>False</td>
<td>True</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>0.360500</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">974</td>
<td>5600</td>
<td>12.53</td>
<td>0.11</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>0.082458</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17904</td>
<td>9000</td>
<td>12.42</td>
<td>0.19</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>0.256631</td>
</tr>
</tbody>
</table>

<p>18325 rows × 9 columns</p>
</div>
</div>
</div>
<div id="cell-57" class="cell" data-execution_count="121">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Define profit and loss functions using the original formulas</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_profit(loan_amnt, loan_int_rate):</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> loan_amnt <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> <span class="fl">0.25</span> <span class="op">*</span> loan_int_rate)<span class="op">**</span><span class="dv">10</span> <span class="op">-</span> loan_amnt</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_loss(loan_amnt, loan_int_rate):</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> loan_amnt <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> <span class="fl">0.25</span> <span class="op">*</span> loan_int_rate)<span class="op">**</span><span class="dv">3</span> <span class="op">-</span> <span class="fl">1.7</span> <span class="op">*</span> loan_amnt</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding Gain and Loss columns</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>X_train[<span class="st">'Gain_if_Issued'</span>] <span class="op">=</span> calculate_profit(X_train[<span class="st">'loan_amnt'</span>], X_train[<span class="st">'loan_int_rate'</span>])</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>X_train[<span class="st">'Loss_if_Defaulted'</span>] <span class="op">=</span> calculate_loss(X_train[<span class="st">'loan_amnt'</span>], X_train[<span class="st">'loan_int_rate'</span>])</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>X_train[<span class="st">'actual'</span>] <span class="op">=</span> y_train</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-58" class="cell" data-execution_count="122">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>X_train</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="122">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">loan_amnt</th>
<th data-quarto-table-cell-role="th">loan_int_rate</th>
<th data-quarto-table-cell-role="th">loan_percent_income</th>
<th data-quarto-table-cell-role="th">person_home_ownership_OWN</th>
<th data-quarto-table-cell-role="th">person_home_ownership_RENT</th>
<th data-quarto-table-cell-role="th">loan_intent_EDUCATION</th>
<th data-quarto-table-cell-role="th">loan_intent_PERSONAL</th>
<th data-quarto-table-cell-role="th">loan_intent_VENTURE</th>
<th data-quarto-table-cell-role="th">Prediction</th>
<th data-quarto-table-cell-role="th">Gain_if_Issued</th>
<th data-quarto-table-cell-role="th">Loss_if_Defaulted</th>
<th data-quarto-table-cell-role="th">Issued</th>
<th data-quarto-table-cell-role="th">PNL</th>
<th data-quarto-table-cell-role="th">actual</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">21383</td>
<td>5000</td>
<td>13.57</td>
<td>0.10</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>0.154000</td>
<td>1.336865e+10</td>
<td>4.152457e+05</td>
<td>True</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2116</td>
<td>1200</td>
<td>13.85</td>
<td>0.02</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>0.011135</td>
<td>3.758057e+09</td>
<td>1.045990e+05</td>
<td>True</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5631</td>
<td>6500</td>
<td>10.99</td>
<td>0.12</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>0.102757</td>
<td>3.550823e+09</td>
<td>3.310383e+05</td>
<td>True</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20675</td>
<td>12000</td>
<td>14.96</td>
<td>0.35</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>0.899886</td>
<td>6.870124e+10</td>
<td>1.257557e+06</td>
<td>True</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9582</td>
<td>9325</td>
<td>10.91</td>
<td>0.13</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>0.169294</td>
<td>4.828637e+09</td>
<td>4.670971e+05</td>
<td>True</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13577</td>
<td>2500</td>
<td>8.88</td>
<td>0.05</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>0.043215</td>
<td>2.995678e+08</td>
<td>7.921562e+04</td>
<td>True</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24532</td>
<td>17050</td>
<td>12.69</td>
<td>0.28</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>0.359268</td>
<td>2.727015e+10</td>
<td>1.209565e+06</td>
<td>True</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6125</td>
<td>5000</td>
<td>13.11</td>
<td>0.18</td>
<td>False</td>
<td>True</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>0.360500</td>
<td>1.025345e+10</td>
<td>3.828272e+05</td>
<td>True</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">974</td>
<td>5600</td>
<td>12.53</td>
<td>0.11</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>0.082458</td>
<td>8.134228e+09</td>
<td>3.856888e+05</td>
<td>True</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17904</td>
<td>9000</td>
<td>12.42</td>
<td>0.19</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>0.256631</td>
<td>1.222852e+10</td>
<td>6.072611e+05</td>
<td>True</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>18325 rows × 14 columns</p>
</div>
</div>
</div>
<div id="cell-59" class="cell" data-execution_count="125">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate PNL for each threshold and find the optimal threshold</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>thresholds <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">101</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>optimal_profit_per_issued_loan <span class="op">=</span> <span class="op">-</span>np.inf</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>optimal_threshold <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> t <span class="kw">in</span> thresholds:</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>    X_train[<span class="st">'Issued'</span>] <span class="op">=</span> X_train[<span class="st">'Prediction'</span>] <span class="op">&gt;=</span> t</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>    X_train[<span class="st">'PNL'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>    X_train.loc[X_train[<span class="st">'Issued'</span>] <span class="op">&amp;</span> (X_train[<span class="st">'actual'</span>] <span class="op">==</span> <span class="dv">1</span>), <span class="st">'PNL'</span>] <span class="op">=</span> X_train[<span class="st">'Gain_if_Issued'</span>]</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>    X_train.loc[X_train[<span class="st">'Issued'</span>] <span class="op">&amp;</span> (X_train[<span class="st">'actual'</span>] <span class="op">==</span> <span class="dv">0</span>), <span class="st">'PNL'</span>] <span class="op">=</span> X_train[<span class="st">'Loss_if_Defaulted'</span>]</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Calculate the total PNL for loans that were issued, and then find the average PNL per issued loan</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>    total_pnl_for_issued_loans <span class="op">=</span> X_train.loc[X_train[<span class="st">'Issued'</span>], <span class="st">'PNL'</span>].<span class="bu">sum</span>()</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>    num_issued_loans <span class="op">=</span> X_train[<span class="st">'Issued'</span>].<span class="bu">sum</span>()</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>    average_pnl_per_issued_loan <span class="op">=</span> total_pnl_for_issued_loans <span class="op">/</span> num_issued_loans <span class="cf">if</span> num_issued_loans <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check for the optimal threshold</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> average_pnl_per_issued_loan <span class="op">&gt;</span> optimal_profit_per_issued_loan:</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>        optimal_profit_per_issued_loan <span class="op">=</span> average_pnl_per_issued_loan</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>        optimal_threshold <span class="op">=</span> t</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Display optimal threshold and expected profit</span></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Optimal Threshold: </span><span class="sc">{</span>optimal_threshold<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Expected Profit per Issued Loan at Optimal Threshold: $</span><span class="sc">{</span>optimal_profit_per_loan<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[6.87012418e+10 1.07229095e+09 2.19111733e+09 ... 1.21803553e+10
 1.32891450e+08 5.40246950e+10]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[6.87012418e+10 1.07229095e+09 2.19111733e+09 ... 4.47811211e+11
 1.21803553e+10 5.40246950e+10]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[6.87012418e+10 2.19111733e+09 8.14616051e+08 ... 4.47811211e+11
 1.21803553e+10 5.40246950e+10]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[6.87012418e+10 2.19111733e+09 1.86360759e+10 ... 4.47811211e+11
 1.21803553e+10 5.40246950e+10]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[6.87012418e+10 2.19111733e+09 1.86360759e+10 ... 6.99747313e+09
 4.47811211e+11 1.21803553e+10]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[6.87012418e+10 2.19111733e+09 8.93140605e+09 ... 6.99747313e+09
 4.47811211e+11 1.21803553e+10]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[6.87012418e+10 2.19111733e+09 8.93140605e+09 3.85017111e+10
 1.17269450e+10 1.05653162e+11 1.34942601e+11 1.14864720e+11
 2.63258207e+10 9.97385526e+10 4.56178654e+10 1.46391015e+11
 5.23693616e+10 1.17269450e+10 3.88499567e+10 9.05862461e+11
 1.27427138e+12 6.26342885e+10 3.90624960e+10 5.64271484e+10
 3.41903464e+10 1.89404472e+10 4.71616460e+09 8.36742562e+09
 8.70260051e+11 3.24506139e+11 2.26204056e+10 1.52439012e+10
 1.38866967e+08 8.93140605e+09 2.74816101e+10 4.42162127e+10
 4.73444401e+11 1.04228521e+10 2.45725649e+10 3.81898919e+11
 7.64031474e+10 4.13780603e+09 6.87012418e+10 6.73313262e+10
 4.63148220e+10 4.14195054e+10 9.36448958e+11 4.67555335e+11
 7.34006454e+09 8.18512999e+10 1.06759176e+11 5.97380850e+10
 8.50897953e+10 1.39953941e+10 5.31876983e+09 9.82215598e+10
 3.47584892e+10 1.10297267e+12 3.28415437e+11 2.55445356e+10
 1.82988768e+11 1.65817131e+11 2.22811955e+10 8.45896349e+09
 1.86599680e+11 1.58939861e+10 8.78906160e+10 4.16353407e+10
 1.28216582e+11 2.04628250e+11 2.48799573e+11 3.02802477e+10
 5.12672449e+09 4.71616460e+10 8.75036403e+09 5.05078591e+10
 1.21595829e+11 4.37281753e+10 1.04795512e+10 8.01647249e+09
 1.11241402e+11 1.06885962e+11 5.29572072e+10 1.19185993e+10
 2.24375875e+10 2.32647822e+10 4.43031378e+11 2.69974102e+10
 1.74659187e+10 7.56163041e+10 1.21354257e+11 1.84470922e+10
 6.00911174e+09 2.80448774e+11 5.64271484e+10 7.01544823e+09
 5.67192161e+11 1.45885572e+10 9.55703532e+11 2.05392259e+11
 6.09962561e+10 2.71758738e+11 3.04786302e+10 2.01196764e+09
 8.74521503e+10 6.07306599e+10 3.27961314e+10 8.91691072e+10
 1.43127587e+11 1.86014217e+10 4.74205620e+10 2.35585623e+10
 1.98211953e+11 2.03023702e+11 1.05961736e+10 1.80725766e+09
 2.96790906e+08 2.13664276e+10 1.31053679e+10 4.19568997e+10
 1.46484360e+11 1.39727350e+10 4.29382761e+10 9.31785232e+11
 1.22879162e+10 3.45230231e+11 3.38619210e+10 3.80982878e+10
 3.00507613e+11 4.05978574e+11 2.88185385e+11 4.00676818e+11
 1.66699579e+11 2.92338785e+10 8.36385618e+10 7.82940217e+09
 1.00806478e+10 4.16332735e+10 3.47287034e+10 1.53367840e+10
 5.50219204e+10 1.69003198e+08 2.90508149e+10 5.67192161e+11
 1.37283564e+11 1.96448310e+11 1.00089583e+11 1.74281637e+10
 6.52639971e+10 2.53100517e+09 3.95119676e+09 8.64562978e+09
 3.14239191e+09 9.78959957e+10 7.61766503e+10 2.58323213e+08
 5.16076775e+09 1.66632259e+08 4.05978574e+11 2.32428490e+09
 2.11080063e+11 2.28658519e+10 1.46391015e+11 2.66988469e+10
 6.82584153e+09 6.22569885e+10 5.01879404e+11 8.15109303e+10
 3.75140949e+09 5.67192161e+11 2.74179486e+11 3.08777267e+10
 2.43300575e+10 1.45254074e+10 9.05210072e+09 1.42483647e+11
 5.05361737e+10 1.35872415e+10 3.73436926e+10 1.30994391e+10
 1.80725766e+09 1.00499715e+12 4.78664849e+10 7.73839611e+11
 8.19420603e+09 3.06674727e+10 7.36661699e+10 2.08888470e+11
 2.92955297e+09 3.82941390e+11 9.31785232e+11 6.88102367e+09
 2.39491906e+11 1.63817099e+10 8.73898238e+10 1.87999623e+11
 9.50372196e+10 1.19686263e+11 3.35806430e+10 1.78053563e+10
 9.79294597e+09 1.18324313e+10 1.42483647e+11 2.13664276e+10
 6.34285968e+11 5.85199717e+09 1.17859528e+10 5.03981732e+10
 2.95240000e+08 4.51151755e+10 9.70318337e+10 6.13375457e+11
 3.03047155e+10 1.53795522e+10 2.32050524e+09 1.31065229e+12
 4.92358899e+10 9.63713079e+10 1.55989012e+11 2.92338785e+10
 1.36718736e+11 3.33458622e+09 7.48223323e+10 5.16144867e+11
 8.18512999e+10 1.73714202e+09 2.96062576e+10 6.09962561e+10
 1.70000380e+11 1.46610094e+11 2.46593022e+11 1.08697932e+10
 2.02695426e+10 2.93173626e+10 2.38105293e+11 3.37826483e+10
 1.99748530e+11 8.74048643e+09 3.35065395e+10 7.89817780e+10
 1.62258208e+11 1.69203884e+11 8.24905136e+10 1.13828318e+11
 9.42951887e+10 2.17881112e+10 3.77703057e+11 9.00364299e+10
 1.00986105e+10 6.00377323e+10 1.57963556e+11 1.05437898e+11
 1.58553866e+11 3.57818968e+10 8.73898238e+10 3.10124586e+08
 4.13780603e+09 3.46658231e+10 1.30219966e+11 1.46943043e+12
 2.48116834e+11 7.64035453e+10 1.11990130e+11 2.09323156e+10
 1.74037893e+09 8.19420603e+09 2.02526798e+11 1.13954481e+11
 3.22374173e+10 1.69179270e+10 5.36879589e+10 4.77848099e+09
 1.21833629e+12 1.00996989e+11 2.84233139e+10 3.38619210e+10
 3.33201962e+10 2.39654224e+09 3.47584892e+10 3.47584892e+10
 3.95016063e+10 1.32454044e+10 4.80695357e+11 2.29343939e+10
 3.45409194e+11 3.61896572e+10 6.15448624e+10 4.87970048e+10
 9.14266472e+09 1.01501974e+11 8.74048643e+09 1.01853045e+09
 1.45098382e+11 1.27226015e+10 1.53229682e+11 6.32620129e+11
 1.25527648e+09 2.18818217e+10 6.08717064e+09 1.48437485e+11
 4.43242807e+08 5.77969622e+11 5.24655484e+10 1.04444235e+11
 1.13081099e+10 4.92012320e+11 3.04786302e+10 4.08816607e+10
 1.18472667e+11 3.10440869e+11 3.49888188e+11 2.45725649e+10
 1.43127587e+11 1.42033320e+12 1.98489402e+11 3.48433268e+10
 6.07999706e+09 2.15198095e+11 5.20810560e+10 1.95312480e+11
 1.82599505e+10 1.94461663e+09 4.70103941e+10 3.69930658e+09
 1.73643517e+11 7.21187713e+10 2.30967364e+10 2.70664788e+11
 2.27267045e+10 1.15275064e+10 2.36831690e+11 6.09962561e+10
 2.27973835e+11 1.06574260e+11 5.54850837e+11 7.15415631e+10
 6.32971123e+09 6.39780314e+10 2.76841402e+11 2.24693266e+10
 3.00631205e+10 3.50255266e+08 1.39334540e+11 7.29547486e+08
 2.09894934e+10 9.57960079e+09 9.58954833e+10 1.98489402e+11
 5.01879404e+11 6.00911174e+09 4.65524146e+09 3.64330554e+10
 6.87012418e+10 3.57623498e+10 4.81271389e+10 2.61988781e+10
 6.27588761e+10 6.87420946e+10 7.38285357e+09 1.24054695e+11
 4.00757244e+10 1.42483647e+11 4.58418884e+10 1.63817099e+10
 1.13031719e+10 1.02893174e+11 5.57590412e+10 2.12614236e+10
 3.55584019e+10 2.91507168e+10 5.83014336e+10 1.16160305e+11
 3.61497216e+11 7.09945878e+09 7.97908421e+10 2.80193823e+10
 1.56401538e+09 1.01544594e+11 3.27405199e+10 6.28773075e+09
 2.82862983e+10 1.03051863e+11 4.32682160e+09 3.82462640e+08
 1.17856685e+12 2.02600034e+10 9.00411584e+10 8.39580410e+10
 1.08776966e+11 8.36551855e+09 1.39856018e+10 2.66589673e+10
 2.55445356e+10 1.60270727e+11 5.83014336e+10 9.81400731e+10
 1.31065229e+12 1.17525985e+11 1.57193269e+10 2.89517258e+10
 2.32494355e+10 1.84695055e+11 3.55652145e+10 1.13986917e+11
 1.30962080e+11 4.12106827e+11 3.05811372e+10 7.04870814e+08
 1.00996989e+11 2.06409970e+10 1.37014538e+10 1.01128547e+11
 5.16646427e+08 7.19588681e+10 3.60568466e+09 1.13465773e+11
 3.06942375e+10 3.81331135e+10 5.58781900e+10 2.97770853e+10
 7.76798434e+10 3.69390111e+11 1.19032094e+11 2.76777223e+11
 1.22438711e+10 3.16137080e+10 1.76558151e+11 3.95783846e+09
 2.99199711e+11 2.86479550e+10 9.76562400e+10 1.20077244e+12
 5.10917832e+10 3.05033556e+10 3.10999467e+11 4.27450940e+10
 1.58068540e+10 7.27897158e+11 3.19935454e+10 1.06759176e+11
 3.02691057e+10 1.66699579e+11 4.58008278e+10 1.21700853e+09
 7.58386692e+10 6.06741469e+09 4.10137959e+10 6.51692840e+08
 3.90313288e+10 1.24664338e+11 4.57477263e+09 6.13884749e+10
 4.99413803e+11 5.05642736e+10 5.99369620e+11 5.17401448e+11
 5.46602191e+10 3.24255544e+11 2.28658519e+10 1.33088761e+10
 2.62369052e+10 3.34221552e+11 4.94786846e+11 3.47703722e+11
 1.29776656e+12 2.62368667e+10 2.10618408e+10 2.98731759e+10
 1.95312480e+11 3.40359181e+10 8.41218683e+11 1.45753584e+11
 1.63046898e+10 1.30962080e+11 7.78131221e+09 2.29900820e+10
 1.81390536e+11 1.50933088e+11 4.70696637e+09 7.56438488e+11
 1.04931097e+10 8.28899274e+09 2.45350183e+11 2.39654224e+09
 6.13375457e+11 4.55343026e+08 3.43072756e+10 9.57205997e+10
 5.05112471e+10 2.82761953e+11 1.78563621e+11 5.72278051e+10
 2.88762834e+10 1.00713240e+11 2.10169553e+11 1.90217284e+10
 4.24054121e+09 2.89197773e+11 2.85824726e+09 1.15615810e+09
 5.64271484e+10 7.14658421e+09 1.02175625e+10 7.23793145e+10
 7.74326929e+08 1.56148130e+10 5.20930551e+10 3.53909718e+10
 2.51400640e+11 2.80473772e+11 2.80989892e+10 7.26270372e+09
 5.24712902e+10 2.75507550e+11 4.29832230e+10 8.16691592e+11
 2.75507550e+11 8.19420603e+09 1.01371583e+08 1.04795512e+10
 7.51012377e+08 6.81650715e+10 6.60301828e+10 8.90033121e+11
 6.91232568e+10 5.06122399e+11 7.77352447e+10 1.74281637e+10
 1.95571674e+09 4.65555787e+11 8.38869852e+11 1.92244403e+10
 4.71616460e+10 7.45558231e+10 2.10074507e+11 6.38613390e+10
 1.09712408e+11 5.47060374e+11 1.04942580e+11 1.97840007e+10
 8.73295937e+09 1.34431157e+10 1.16602867e+11 5.03981732e+10
 3.38375074e+09 1.14455610e+11 4.57611879e+10 8.42597279e+11
 3.51862226e+10 4.85499021e+10 2.09894934e+10 4.90579928e+10
 1.47756044e+11 8.67214629e+10 8.87432348e+09 1.65512241e+09
 2.56240939e+11 2.11029340e+11 4.28840945e+10 5.56194432e+10
 1.63702600e+11 2.02438441e+11 7.22434897e+10 6.77325871e+09
 1.06809785e+11 6.59625198e+11 1.20567167e+10 7.25491908e+10
 3.66979371e+10 2.25713397e+10 2.32027088e+11 1.17187488e+11
 6.87012418e+10 3.01954154e+11 2.32986947e+11 1.33870938e+09
 4.28089769e+08 2.61738931e+10 9.92586282e+11 4.54098591e+10
 1.02907549e+11 1.61550902e+12 5.41790736e+10 3.84488806e+10
 2.46593022e+11 3.85041213e+08 3.49315904e+10 2.69394517e+10
 2.23299372e+10 8.25424922e+09 1.70980376e+11 5.63708596e+10
 1.39425309e+10 2.11029340e+11 6.27840100e+10 1.95312480e+11
 3.07603469e+10 4.06496546e+11 1.74235018e+11 1.47435389e+10
 7.81733384e+10 1.01620853e+11 1.45254074e+10 5.10917832e+10
 1.58191578e+10 1.18447611e+11 3.88399217e+10 1.60102992e+11
 1.59942243e+10 1.97660847e+10 4.74441241e+09 2.38105293e+11
 2.30813341e+11 4.29503671e+10 1.48756435e+10 1.83128976e+11
 4.37281753e+09 2.53988585e+10 7.60308314e+08 3.35514841e+09
 1.12776995e+11 1.08037758e+10 1.30994391e+10 4.29316802e+10
 9.43116287e+09 1.67739704e+11 6.94574067e+10 6.65260537e+10
 6.51343378e+10 2.81898203e+10 6.12682230e+09 1.07766511e+11
 9.12194241e+10 2.04628250e+11 3.61585003e+11 5.06122399e+10
 3.53961377e+09 5.48050024e+10 3.90416994e+11 4.69757164e+10
 6.82584153e+09 9.05598528e+10 6.56708921e+09 2.12962229e+10
 4.27142736e+10 4.04514189e+10 2.11306323e+11 1.42032904e+10
 4.04514189e+10 2.33870808e+11 1.84363580e+11 7.92986890e+11
 6.49250521e+10 6.76815535e+10 1.79922490e+11 8.54901880e+10
 2.47320019e+10 1.45753584e+11 3.77791306e+11 4.15849832e+09
 1.22005311e+11 2.84885701e+10 6.89019842e+10 6.18311176e+10
 5.05772267e+09 6.97944310e+10 2.53243224e+09 5.28265808e+11
 1.43354430e+10 1.24999987e+11 6.87141469e+10 1.66632259e+08
 2.62320713e+11 5.83014336e+10 4.50205792e+10 2.82062365e+10
 5.10233231e+10 1.58375661e+09 3.29266397e+09 2.98731759e+10
 6.58180603e+10 1.00996989e+11 2.68551646e+09 2.29550732e+11
 1.00292008e+10 2.13898395e+10 5.93982623e+10 1.38412898e+10
 3.35895647e+10 8.56855060e+10 1.38833759e+11 2.56678074e+10
 2.82885625e+09 1.69712662e+11 1.79034431e+09 1.55820125e+11
 2.45725649e+10 8.36115142e+11 1.51828831e+11 7.68480438e+11
 3.48609779e+10 5.41790736e+10 1.07415218e+11 8.75755754e+09
 1.27427138e+12 1.99742974e+11 2.54083894e+11 1.29850104e+11
 1.73518664e+11 3.41960752e+11 6.59863771e+10 5.47045542e+10
 3.61896572e+10 6.54810399e+10 5.03748246e+10 7.49120704e+11
 2.88728882e+10 8.46187094e+10 8.15109303e+10 4.41365977e+09
 7.57124524e+10 1.84108335e+11 5.37290288e+10 4.09542748e+10
 5.86347251e+09 5.92363335e+10 7.89817780e+10 1.25044776e+10
 1.10574489e+11 9.12194241e+10 1.61550902e+12 4.35700518e+09
 5.90998306e+10 2.71122912e+11 2.13725470e+11 1.28814828e+11
 5.01867614e+10 2.45913740e+11 1.26884452e+10 2.98044457e+10
 4.48670453e+10 2.39372526e+11 2.40088563e+10 8.78693533e+08
 3.66525234e+10 6.84724164e+09 8.36234174e+09 9.74073614e+10
 5.72510348e+10 5.49936757e+10 1.31297015e+10 1.11540247e+10
 4.46171582e+10 7.82940217e+09 2.58624526e+09 4.29382761e+10
 6.75425569e+10 2.77307049e+11 1.47307968e+11 3.55082261e+09
 2.92892275e+09 1.99154506e+10 7.51660932e+09 3.04612470e+11
 1.27722678e+10 4.29638091e+10 3.55871491e+10 3.42871622e+10
 1.04598127e+11 3.24871457e+10 1.41798040e+11 1.02165755e+11
 1.56249984e+11 4.57179453e+10 3.48609779e+10 4.80219511e+10
 2.70123475e+10 4.27667488e+10 7.14254483e+10 2.90869549e+10
 8.27931529e+11 5.24641425e+11 5.46602191e+10 7.67014016e+09
 5.03981732e+10 1.04965244e+09 3.75805731e+10 3.24441640e+11
 3.80053924e+10 6.98636750e+09 3.02575395e+11 1.82739192e+10
 1.89688806e+10 9.93644511e+08 1.09145453e+11 2.26876865e+11
 5.53239890e+10 1.82739192e+10 2.51400640e+11 3.27961314e+10
 1.66219117e+11 1.86264521e+11 1.85850686e+11 2.73290013e+11
 7.88840972e+10 3.05665988e+10 2.61732173e+11 2.31469632e+10
 4.73817731e+12 1.88078414e+11 3.63362973e+10 5.32640927e+10
 1.62312630e+11 6.98636750e+09 1.17525985e+11 4.14195054e+10
 2.45954709e+10 1.94338112e+10 3.50282589e+10 2.69393318e+10
 1.15069803e+11 4.10137959e+10 6.38091182e+10 1.23576766e+11
 5.86247092e+10 5.99515541e+10 1.56249984e+11 3.18647210e+10
 1.19462025e+10 5.12672449e+10 1.04965244e+09 3.64877696e+11
 1.71181041e+09 5.55090358e+09 9.79509691e+09 1.20899579e+11
 2.03767611e+10 1.38309972e+11 1.41431434e+10 5.34745988e+10
 1.13986917e+11 9.02215960e+10 2.63413117e+09 1.90074439e+10
 1.38921555e+11 4.12203947e+09 3.65307143e+09 4.65261301e+09
 1.13194525e+10 4.85845280e+10 7.16772149e+09 4.58955168e+08
 1.48792293e+11 3.08147376e+10 9.00411584e+10 1.61805676e+11
 1.94118690e+08 5.01669085e+11 7.12418233e+10 8.36946278e+09
 8.85059171e+11 1.10757844e+12 7.44579099e+09 1.46484360e+11
 1.01128547e+11 1.00499715e+12 3.27982875e+09 2.65877085e+10
 7.25491908e+10 8.08400164e+09 5.35286796e+10 1.42483647e+11
 1.95312480e+11 1.09145453e+11 2.70106065e+10 1.56148130e+10
 1.60270727e+11 7.49511642e+10 1.04186110e+11 8.70798507e+10
 7.09081627e+10 6.69627273e+08 3.02802477e+10 1.35839779e+11
 2.22566954e+10 5.42856880e+09 2.32806216e+09 8.73295937e+09
 2.08888470e+11 1.46221929e+11 1.07766511e+11 1.03051863e+11
 1.16113074e+09 1.06019804e+12 1.02314125e+11 4.47811211e+11
 5.81766910e+10 7.05155912e+10 2.88762834e+10 7.65797014e+10
 9.43116287e+09 5.46280402e+09 2.67009286e+08 5.87706287e+10
 1.63702600e+11 3.79364496e+10 5.32459409e+09 2.47627477e+10
 1.00996989e+11 1.97454445e+11 2.62369052e+10 2.04356285e+10
 1.40080171e+11 3.79364496e+10 3.18884203e+09 2.01204998e+11
 2.13725470e+11 1.75781232e+11 3.03999853e+09 1.34332866e+11
 2.05030472e+10 4.18821383e+11 1.46610094e+11 6.59845364e+10
 9.86372088e+10 1.98211953e+11 9.57960079e+09 1.01325179e+09
 8.25377285e+10 1.05437898e+11 1.34449596e+09 2.70123475e+10
 1.39929956e+10 1.09256080e+10 2.19913892e+10 5.06122399e+11
 2.70094395e+10 2.90391696e+11 2.84066641e+11 2.52146163e+11
 1.91132107e+10 6.99782100e+07 4.35399254e+10 2.88973959e+10
 6.17040671e+10 1.30219966e+11 2.88653252e+10 6.23467358e+11
 7.00245793e+10 8.45752386e+09 6.00377323e+10 7.89817780e+10
 5.07928815e+10 9.55696199e+09 8.64395120e+10 4.43350635e+10
 6.72855410e+10 5.82733409e+09 9.04253753e+09 4.06381736e+10
 1.23465963e+10 4.04089976e+10 1.29882799e+11 1.82988768e+11
 2.66589673e+10 1.43580900e+11 4.29832230e+10 3.07865194e+08
 6.24999936e+10 1.60270727e+11 5.64271484e+10 1.04965244e+09
 5.10233231e+10 7.85120585e+10 4.37024321e+09 2.80989892e+10
 7.55018410e+10 1.16708458e+10 7.59982802e+10 9.71690559e+10
 1.30994391e+10 5.66044707e+08 2.62320713e+11 3.01866176e+11
 2.72850609e+11 4.61386567e+10 1.53065670e+12 2.53369283e+10
 5.53083515e+10 4.65545136e+10 7.17250033e+10 8.36234174e+09
 1.90176447e+10 8.19420603e+09 1.63702600e+11 7.47626000e+08
 3.28110367e+10 9.89996158e+11 7.23845430e+09 8.61289714e+09
 2.10690198e+11 6.99747313e+09 4.47811211e+11 1.21803553e+10]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[6.87012418e+10 2.19111733e+09 8.93140605e+09 3.85017111e+10
 1.17269450e+10 1.05653162e+11 1.34942601e+11 1.14864720e+11
 2.63258207e+10 9.97385526e+10 4.56178654e+10 1.46391015e+11
 5.23693616e+10 1.17269450e+10 9.05862461e+11 1.27427138e+12
 6.26342885e+10 3.90624960e+10 5.64271484e+10 3.41903464e+10
 1.89404472e+10 4.71616460e+09 8.36742562e+09 8.70260051e+11
 3.24506139e+11 2.26204056e+10 1.52439012e+10 1.38866967e+08
 8.93140605e+09 2.74816101e+10 4.42162127e+10 4.73444401e+11
 1.04228521e+10 2.45725649e+10 3.81898919e+11 7.64031474e+10
 4.13780603e+09 6.87012418e+10 6.73313262e+10 4.63148220e+10
 4.14195054e+10 4.67555335e+11 7.34006454e+09 8.18512999e+10
 1.06759176e+11 5.97380850e+10 1.39953941e+10 5.31876983e+09
 9.82215598e+10 3.47584892e+10 1.10297267e+12 3.28415437e+11
 2.55445356e+10 1.82988768e+11 1.65817131e+11 2.22811955e+10
 8.45896349e+09 1.86599680e+11 1.58939861e+10 4.16353407e+10
 1.28216582e+11 2.04628250e+11 2.48799573e+11 3.02802477e+10
 5.12672449e+09 4.71616460e+10 8.75036403e+09 5.05078591e+10
 1.21595829e+11 4.37281753e+10 1.04795512e+10 8.01647249e+09
 1.11241402e+11 1.06885962e+11 5.29572072e+10 1.19185993e+10
 2.24375875e+10 2.32647822e+10 4.43031378e+11 2.69974102e+10
 1.74659187e+10 7.56163041e+10 1.21354257e+11 1.84470922e+10
 6.00911174e+09 2.80448774e+11 5.64271484e+10 7.01544823e+09
 5.67192161e+11 1.45885572e+10 9.55703532e+11 2.05392259e+11
 6.09962561e+10 2.71758738e+11 3.04786302e+10 2.01196764e+09
 8.74521503e+10 6.07306599e+10 3.27961314e+10 8.91691072e+10
 1.43127587e+11 1.86014217e+10 4.74205620e+10 2.35585623e+10
 1.98211953e+11 2.03023702e+11 1.80725766e+09 2.96790906e+08
 2.13664276e+10 1.31053679e+10 1.46484360e+11 1.39727350e+10
 4.29382761e+10 9.31785232e+11 1.22879162e+10 3.45230231e+11
 3.38619210e+10 3.80982878e+10 3.00507613e+11 4.05978574e+11
 2.88185385e+11 4.00676818e+11 2.92338785e+10 8.36385618e+10
 7.82940217e+09 1.00806478e+10 4.16332735e+10 3.47287034e+10
 1.53367840e+10 5.50219204e+10 1.69003198e+08 2.90508149e+10
 5.67192161e+11 1.37283564e+11 1.96448310e+11 1.00089583e+11
 1.74281637e+10 6.52639971e+10 2.53100517e+09 3.95119676e+09
 8.64562978e+09 9.78959957e+10 7.61766503e+10 2.58323213e+08
 5.16076775e+09 1.66632259e+08 4.05978574e+11 2.32428490e+09
 2.11080063e+11 2.28658519e+10 1.46391015e+11 2.66988469e+10
 6.82584153e+09 6.22569885e+10 5.01879404e+11 8.15109303e+10
 3.75140949e+09 5.67192161e+11 2.74179486e+11 3.08777267e+10
 2.43300575e+10 1.45254074e+10 1.42483647e+11 5.05361737e+10
 3.73436926e+10 1.30994391e+10 1.80725766e+09 1.00499715e+12
 4.78664849e+10 7.73839611e+11 8.19420603e+09 3.06674727e+10
 7.36661699e+10 2.08888470e+11 2.92955297e+09 3.82941390e+11
 9.31785232e+11 6.88102367e+09 2.39491906e+11 1.63817099e+10
 8.73898238e+10 1.87999623e+11 9.50372196e+10 1.19686263e+11
 3.35806430e+10 1.78053563e+10 9.79294597e+09 1.18324313e+10
 1.42483647e+11 2.13664276e+10 6.34285968e+11 5.85199717e+09
 1.17859528e+10 5.03981732e+10 4.51151755e+10 9.70318337e+10
 6.13375457e+11 3.03047155e+10 1.53795522e+10 2.32050524e+09
 1.31065229e+12 4.92358899e+10 9.63713079e+10 1.55989012e+11
 2.92338785e+10 1.36718736e+11 3.33458622e+09 7.48223323e+10
 5.16144867e+11 8.18512999e+10 1.73714202e+09 2.96062576e+10
 6.09962561e+10 1.70000380e+11 1.46610094e+11 2.46593022e+11
 1.08697932e+10 2.02695426e+10 2.93173626e+10 2.38105293e+11
 3.37826483e+10 1.99748530e+11 8.74048643e+09 3.35065395e+10
 7.89817780e+10 1.62258208e+11 1.69203884e+11 8.24905136e+10
 1.13828318e+11 9.42951887e+10 2.17881112e+10 3.77703057e+11
 9.00364299e+10 1.00986105e+10 6.00377323e+10 1.57963556e+11
 1.05437898e+11 1.58553866e+11 8.73898238e+10 3.10124586e+08
 4.13780603e+09 3.46658231e+10 1.30219966e+11 1.46943043e+12
 2.48116834e+11 7.64035453e+10 1.11990130e+11 2.09323156e+10
 1.74037893e+09 8.19420603e+09 2.02526798e+11 1.13954481e+11
 3.22374173e+10 1.69179270e+10 5.36879589e+10 4.77848099e+09
 1.21833629e+12 1.00996989e+11 2.84233139e+10 3.38619210e+10
 3.33201962e+10 2.39654224e+09 3.47584892e+10 3.47584892e+10
 3.95016063e+10 1.32454044e+10 4.80695357e+11 2.29343939e+10
 3.45409194e+11 6.15448624e+10 4.87970048e+10 9.14266472e+09
 1.01501974e+11 8.74048643e+09 1.01853045e+09 1.45098382e+11
 1.27226015e+10 1.53229682e+11 6.32620129e+11 1.25527648e+09
 2.18818217e+10 6.08717064e+09 1.48437485e+11 4.43242807e+08
 5.77969622e+11 5.24655484e+10 1.04444235e+11 1.13081099e+10
 4.92012320e+11 3.04786302e+10 4.08816607e+10 1.18472667e+11
 3.10440869e+11 3.49888188e+11 2.45725649e+10 1.43127587e+11
 1.42033320e+12 3.48433268e+10 6.07999706e+09 2.15198095e+11
 5.20810560e+10 1.95312480e+11 1.82599505e+10 1.94461663e+09
 4.70103941e+10 3.69930658e+09 1.73643517e+11 7.21187713e+10
 2.30967364e+10 2.70664788e+11 2.27267045e+10 1.15275064e+10
 2.36831690e+11 6.09962561e+10 2.27973835e+11 1.06574260e+11
 5.54850837e+11 7.15415631e+10 6.32971123e+09 6.39780314e+10
 2.76841402e+11 2.24693266e+10 3.00631205e+10 3.50255266e+08
 1.39334540e+11 7.29547486e+08 2.09894934e+10 9.57960079e+09
 9.58954833e+10 1.98489402e+11 5.01879404e+11 6.00911174e+09
 4.65524146e+09 3.64330554e+10 6.87012418e+10 3.57623498e+10
 4.81271389e+10 2.61988781e+10 6.87420946e+10 7.38285357e+09
 1.24054695e+11 4.00757244e+10 1.42483647e+11 4.58418884e+10
 1.63817099e+10 1.13031719e+10 1.02893174e+11 5.57590412e+10
 2.12614236e+10 3.55584019e+10 2.91507168e+10 5.83014336e+10
 1.16160305e+11 3.61497216e+11 7.09945878e+09 1.56401538e+09
 1.01544594e+11 3.27405199e+10 6.28773075e+09 2.82862983e+10
 1.03051863e+11 4.32682160e+09 3.82462640e+08 1.17856685e+12
 2.02600034e+10 9.00411584e+10 8.39580410e+10 1.08776966e+11
 1.39856018e+10 2.66589673e+10 2.55445356e+10 1.60270727e+11
 5.83014336e+10 9.81400731e+10 1.17525985e+11 1.57193269e+10
 2.89517258e+10 2.32494355e+10 1.84695055e+11 3.55652145e+10
 1.13986917e+11 1.30962080e+11 4.12106827e+11 3.05811372e+10
 1.00996989e+11 2.06409970e+10 1.37014538e+10 1.01128547e+11
 5.16646427e+08 7.19588681e+10 3.60568466e+09 1.13465773e+11
 3.06942375e+10 3.81331135e+10 5.58781900e+10 2.97770853e+10
 7.76798434e+10 3.69390111e+11 1.19032094e+11 2.76777223e+11
 1.22438711e+10 3.16137080e+10 1.76558151e+11 3.95783846e+09
 2.99199711e+11 2.86479550e+10 9.76562400e+10 1.20077244e+12
 5.10917832e+10 3.05033556e+10 3.10999467e+11 4.27450940e+10
 1.58068540e+10 7.27897158e+11 3.19935454e+10 1.06759176e+11
 3.02691057e+10 4.58008278e+10 1.21700853e+09 7.58386692e+10
 6.06741469e+09 4.10137959e+10 6.51692840e+08 3.90313288e+10
 1.24664338e+11 4.57477263e+09 6.13884749e+10 4.99413803e+11
 5.05642736e+10 5.99369620e+11 5.17401448e+11 5.46602191e+10
 3.24255544e+11 2.28658519e+10 1.33088761e+10 2.62369052e+10
 3.34221552e+11 4.94786846e+11 3.47703722e+11 1.29776656e+12
 2.62368667e+10 2.10618408e+10 2.98731759e+10 1.95312480e+11
 3.40359181e+10 8.41218683e+11 1.45753584e+11 1.63046898e+10
 1.30962080e+11 7.78131221e+09 2.29900820e+10 1.81390536e+11
 1.50933088e+11 4.70696637e+09 7.56438488e+11 1.04931097e+10
 8.28899274e+09 2.45350183e+11 2.39654224e+09 6.13375457e+11
 3.43072756e+10 9.57205997e+10 5.05112471e+10 2.82761953e+11
 1.78563621e+11 5.72278051e+10 2.88762834e+10 1.00713240e+11
 2.10169553e+11 1.90217284e+10 4.24054121e+09 2.89197773e+11
 2.85824726e+09 5.64271484e+10 7.14658421e+09 1.02175625e+10
 7.23793145e+10 7.74326929e+08 1.56148130e+10 5.20930551e+10
 3.53909718e+10 2.51400640e+11 2.80473772e+11 2.80989892e+10
 7.26270372e+09 5.24712902e+10 2.75507550e+11 4.29832230e+10
 8.16691592e+11 2.75507550e+11 8.19420603e+09 1.01371583e+08
 1.04795512e+10 7.51012377e+08 6.81650715e+10 6.60301828e+10
 8.90033121e+11 6.91232568e+10 5.06122399e+11 7.77352447e+10
 1.74281637e+10 1.95571674e+09 4.65555787e+11 8.38869852e+11
 1.92244403e+10 4.71616460e+10 7.45558231e+10 2.10074507e+11
 6.38613390e+10 1.09712408e+11 1.04942580e+11 1.97840007e+10
 8.73295937e+09 1.34431157e+10 1.16602867e+11 5.03981732e+10
 3.38375074e+09 1.14455610e+11 4.57611879e+10 8.42597279e+11
 3.51862226e+10 4.85499021e+10 2.09894934e+10 4.90579928e+10
 1.47756044e+11 8.67214629e+10 8.87432348e+09 1.65512241e+09
 2.56240939e+11 2.11029340e+11 4.28840945e+10 5.56194432e+10
 1.63702600e+11 2.02438441e+11 7.22434897e+10 6.77325871e+09
 1.06809785e+11 6.59625198e+11 1.20567167e+10 7.25491908e+10
 3.66979371e+10 2.25713397e+10 2.32027088e+11 1.17187488e+11
 6.87012418e+10 3.01954154e+11 2.32986947e+11 1.33870938e+09
 4.28089769e+08 2.61738931e+10 9.92586282e+11 4.54098591e+10
 1.02907549e+11 1.61550902e+12 5.41790736e+10 3.84488806e+10
 2.46593022e+11 3.49315904e+10 2.69394517e+10 2.23299372e+10
 8.25424922e+09 1.70980376e+11 5.63708596e+10 1.39425309e+10
 2.11029340e+11 6.27840100e+10 1.95312480e+11 3.07603469e+10
 4.06496546e+11 1.74235018e+11 1.47435389e+10 7.81733384e+10
 1.01620853e+11 1.45254074e+10 5.10917832e+10 1.58191578e+10
 1.18447611e+11 3.88399217e+10 1.60102992e+11 1.59942243e+10
 1.97660847e+10 4.74441241e+09 2.38105293e+11 2.30813341e+11
 4.29503671e+10 1.48756435e+10 1.83128976e+11 4.37281753e+09
 2.53988585e+10 7.60308314e+08 3.35514841e+09 1.12776995e+11
 1.08037758e+10 1.30994391e+10 4.29316802e+10 9.43116287e+09
 1.67739704e+11 6.94574067e+10 6.65260537e+10 6.51343378e+10
 2.81898203e+10 6.12682230e+09 1.07766511e+11 9.12194241e+10
 2.04628250e+11 3.61585003e+11 5.06122399e+10 3.53961377e+09
 5.48050024e+10 3.90416994e+11 4.69757164e+10 6.82584153e+09
 9.05598528e+10 6.56708921e+09 2.12962229e+10 4.27142736e+10
 4.04514189e+10 2.11306323e+11 1.42032904e+10 4.04514189e+10
 2.33870808e+11 1.84363580e+11 7.92986890e+11 6.49250521e+10
 6.76815535e+10 1.79922490e+11 8.54901880e+10 2.47320019e+10
 1.45753584e+11 3.77791306e+11 4.15849832e+09 1.22005311e+11
 2.84885701e+10 6.89019842e+10 6.18311176e+10 5.05772267e+09
 6.97944310e+10 2.53243224e+09 5.28265808e+11 1.43354430e+10
 1.24999987e+11 6.87141469e+10 1.66632259e+08 2.62320713e+11
 5.83014336e+10 4.50205792e+10 2.82062365e+10 5.10233231e+10
 1.58375661e+09 3.29266397e+09 2.98731759e+10 6.58180603e+10
 1.00996989e+11 2.68551646e+09 2.29550732e+11 2.13898395e+10
 5.93982623e+10 1.38412898e+10 3.35895647e+10 8.56855060e+10
 1.38833759e+11 2.56678074e+10 2.82885625e+09 1.69712662e+11
 1.55820125e+11 2.45725649e+10 8.36115142e+11 1.51828831e+11
 7.68480438e+11 3.48609779e+10 5.41790736e+10 1.07415218e+11
 8.75755754e+09 1.27427138e+12 1.99742974e+11 2.54083894e+11
 1.29850104e+11 1.73518664e+11 3.41960752e+11 6.59863771e+10
 5.47045542e+10 6.54810399e+10 7.49120704e+11 2.88728882e+10
 8.46187094e+10 8.15109303e+10 4.41365977e+09 7.57124524e+10
 1.84108335e+11 5.37290288e+10 4.09542748e+10 5.86347251e+09
 5.92363335e+10 7.89817780e+10 1.25044776e+10 1.10574489e+11
 9.12194241e+10 1.61550902e+12 4.35700518e+09 5.90998306e+10
 2.71122912e+11 2.13725470e+11 1.28814828e+11 5.01867614e+10
 2.45913740e+11 1.26884452e+10 2.98044457e+10 4.48670453e+10
 2.40088563e+10 8.78693533e+08 3.66525234e+10 6.84724164e+09
 8.36234174e+09 9.74073614e+10 5.72510348e+10 5.49936757e+10
 1.31297015e+10 4.46171582e+10 7.82940217e+09 2.58624526e+09
 4.29382761e+10 6.75425569e+10 2.77307049e+11 1.47307968e+11
 3.55082261e+09 2.92892275e+09 7.51660932e+09 3.04612470e+11
 1.27722678e+10 4.29638091e+10 3.55871491e+10 3.42871622e+10
 1.04598127e+11 3.24871457e+10 1.41798040e+11 1.02165755e+11
 1.56249984e+11 4.57179453e+10 3.48609779e+10 4.80219511e+10
 2.70123475e+10 4.27667488e+10 7.14254483e+10 2.90869549e+10
 8.27931529e+11 5.24641425e+11 5.46602191e+10 7.67014016e+09
 5.03981732e+10 1.04965244e+09 3.75805731e+10 3.24441640e+11
 3.80053924e+10 6.98636750e+09 3.02575395e+11 1.82739192e+10
 1.89688806e+10 9.93644511e+08 1.09145453e+11 2.26876865e+11
 5.53239890e+10 1.82739192e+10 2.51400640e+11 3.27961314e+10
 1.66219117e+11 1.86264521e+11 1.85850686e+11 7.88840972e+10
 3.05665988e+10 2.61732173e+11 2.31469632e+10 4.73817731e+12
 1.88078414e+11 3.63362973e+10 5.32640927e+10 1.62312630e+11
 6.98636750e+09 1.17525985e+11 4.14195054e+10 2.45954709e+10
 1.94338112e+10 3.50282589e+10 2.69393318e+10 1.15069803e+11
 4.10137959e+10 6.38091182e+10 1.23576766e+11 5.86247092e+10
 5.99515541e+10 1.56249984e+11 3.18647210e+10 1.19462025e+10
 5.12672449e+10 1.04965244e+09 3.64877696e+11 1.71181041e+09
 5.55090358e+09 9.79509691e+09 1.20899579e+11 2.03767611e+10
 1.38309972e+11 1.41431434e+10 5.34745988e+10 1.13986917e+11
 9.02215960e+10 2.63413117e+09 1.38921555e+11 3.65307143e+09
 4.65261301e+09 1.13194525e+10 4.85845280e+10 7.16772149e+09
 4.58955168e+08 1.48792293e+11 3.08147376e+10 9.00411584e+10
 1.61805676e+11 1.94118690e+08 5.01669085e+11 7.12418233e+10
 8.36946278e+09 8.85059171e+11 1.10757844e+12 7.44579099e+09
 1.46484360e+11 1.01128547e+11 1.00499715e+12 3.27982875e+09
 2.65877085e+10 7.25491908e+10 8.08400164e+09 5.35286796e+10
 1.42483647e+11 1.95312480e+11 1.09145453e+11 2.70106065e+10
 1.56148130e+10 1.60270727e+11 7.49511642e+10 1.04186110e+11
 8.70798507e+10 7.09081627e+10 6.69627273e+08 3.02802477e+10
 1.35839779e+11 2.22566954e+10 5.42856880e+09 2.32806216e+09
 8.73295937e+09 2.08888470e+11 1.46221929e+11 1.07766511e+11
 1.16113074e+09 1.06019804e+12 1.02314125e+11 4.47811211e+11
 5.81766910e+10 7.05155912e+10 2.88762834e+10 7.65797014e+10
 9.43116287e+09 5.46280402e+09 2.67009286e+08 5.87706287e+10
 1.63702600e+11 3.79364496e+10 2.47627477e+10 1.00996989e+11
 1.97454445e+11 2.62369052e+10 2.04356285e+10 1.40080171e+11
 3.79364496e+10 3.18884203e+09 2.01204998e+11 2.13725470e+11
 1.75781232e+11 3.03999853e+09 1.34332866e+11 2.05030472e+10
 4.18821383e+11 1.46610094e+11 6.59845364e+10 9.86372088e+10
 1.98211953e+11 9.57960079e+09 1.01325179e+09 8.25377285e+10
 1.05437898e+11 1.34449596e+09 2.70123475e+10 1.39929956e+10
 1.09256080e+10 2.19913892e+10 5.06122399e+11 2.70094395e+10
 2.90391696e+11 2.84066641e+11 2.52146163e+11 1.91132107e+10
 6.99782100e+07 4.35399254e+10 2.88973959e+10 6.17040671e+10
 1.30219966e+11 2.88653252e+10 6.23467358e+11 7.00245793e+10
 8.45752386e+09 6.00377323e+10 7.89817780e+10 5.07928815e+10
 9.55696199e+09 8.64395120e+10 4.43350635e+10 6.72855410e+10
 5.82733409e+09 9.04253753e+09 4.06381736e+10 1.23465963e+10
 4.04089976e+10 1.29882799e+11 1.82988768e+11 2.66589673e+10
 1.43580900e+11 4.29832230e+10 3.07865194e+08 6.24999936e+10
 1.60270727e+11 5.64271484e+10 5.10233231e+10 7.85120585e+10
 4.37024321e+09 2.80989892e+10 7.55018410e+10 1.16708458e+10
 7.59982802e+10 9.71690559e+10 1.30994391e+10 5.66044707e+08
 2.62320713e+11 3.01866176e+11 2.72850609e+11 4.61386567e+10
 1.53065670e+12 2.53369283e+10 5.53083515e+10 4.65545136e+10
 7.17250033e+10 8.36234174e+09 1.90176447e+10 8.19420603e+09
 1.63702600e+11 7.47626000e+08 3.28110367e+10 9.89996158e+11
 7.23845430e+09 8.61289714e+09 2.10690198e+11 6.99747313e+09
 4.47811211e+11 1.21803553e+10]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[6.87012418e+10 2.19111733e+09 8.93140605e+09 3.85017111e+10
 1.17269450e+10 1.05653162e+11 1.34942601e+11 1.14864720e+11
 2.63258207e+10 9.97385526e+10 4.56178654e+10 1.46391015e+11
 5.23693616e+10 1.17269450e+10 9.05862461e+11 1.27427138e+12
 6.26342885e+10 3.90624960e+10 5.64271484e+10 3.41903464e+10
 1.89404472e+10 4.71616460e+09 8.36742562e+09 8.70260051e+11
 3.24506139e+11 2.26204056e+10 1.52439012e+10 1.38866967e+08
 8.93140605e+09 2.74816101e+10 4.42162127e+10 4.73444401e+11
 1.04228521e+10 2.45725649e+10 3.81898919e+11 7.64031474e+10
 4.13780603e+09 6.87012418e+10 6.73313262e+10 4.63148220e+10
 4.14195054e+10 4.67555335e+11 7.34006454e+09 8.18512999e+10
 1.06759176e+11 5.97380850e+10 1.39953941e+10 5.31876983e+09
 9.82215598e+10 3.47584892e+10 1.10297267e+12 3.28415437e+11
 2.55445356e+10 1.82988768e+11 1.65817131e+11 2.22811955e+10
 8.45896349e+09 1.86599680e+11 1.58939861e+10 4.16353407e+10
 1.28216582e+11 2.04628250e+11 2.48799573e+11 3.02802477e+10
 5.12672449e+09 4.71616460e+10 8.75036403e+09 5.05078591e+10
 1.21595829e+11 4.37281753e+10 1.04795512e+10 8.01647249e+09
 1.11241402e+11 1.06885962e+11 5.29572072e+10 1.19185993e+10
 2.24375875e+10 2.32647822e+10 4.43031378e+11 2.69974102e+10
 1.74659187e+10 7.56163041e+10 1.21354257e+11 1.84470922e+10
 6.00911174e+09 2.80448774e+11 5.64271484e+10 7.01544823e+09
 5.67192161e+11 1.45885572e+10 9.55703532e+11 2.05392259e+11
 6.09962561e+10 2.71758738e+11 3.04786302e+10 8.74521503e+10
 6.07306599e+10 3.27961314e+10 1.43127587e+11 1.86014217e+10
 4.74205620e+10 2.35585623e+10 1.98211953e+11 2.03023702e+11
 1.80725766e+09 2.96790906e+08 2.13664276e+10 1.31053679e+10
 1.46484360e+11 1.39727350e+10 4.29382761e+10 9.31785232e+11
 1.22879162e+10 3.45230231e+11 3.38619210e+10 3.80982878e+10
 3.00507613e+11 4.05978574e+11 2.88185385e+11 4.00676818e+11
 2.92338785e+10 8.36385618e+10 7.82940217e+09 4.16332735e+10
 3.47287034e+10 1.53367840e+10 5.50219204e+10 1.69003198e+08
 2.90508149e+10 5.67192161e+11 1.37283564e+11 1.96448310e+11
 1.00089583e+11 1.74281637e+10 6.52639971e+10 2.53100517e+09
 3.95119676e+09 9.78959957e+10 7.61766503e+10 2.58323213e+08
 5.16076775e+09 1.66632259e+08 4.05978574e+11 2.32428490e+09
 2.11080063e+11 2.28658519e+10 1.46391015e+11 2.66988469e+10
 6.82584153e+09 6.22569885e+10 5.01879404e+11 8.15109303e+10
 3.75140949e+09 5.67192161e+11 2.74179486e+11 3.08777267e+10
 2.43300575e+10 1.45254074e+10 1.42483647e+11 5.05361737e+10
 3.73436926e+10 1.30994391e+10 1.80725766e+09 1.00499715e+12
 4.78664849e+10 7.73839611e+11 3.06674727e+10 7.36661699e+10
 2.08888470e+11 2.92955297e+09 3.82941390e+11 9.31785232e+11
 6.88102367e+09 2.39491906e+11 1.63817099e+10 8.73898238e+10
 1.87999623e+11 9.50372196e+10 1.19686263e+11 3.35806430e+10
 1.78053563e+10 9.79294597e+09 1.18324313e+10 1.42483647e+11
 2.13664276e+10 6.34285968e+11 5.85199717e+09 1.17859528e+10
 5.03981732e+10 4.51151755e+10 9.70318337e+10 6.13375457e+11
 3.03047155e+10 1.53795522e+10 2.32050524e+09 1.31065229e+12
 4.92358899e+10 9.63713079e+10 1.55989012e+11 2.92338785e+10
 1.36718736e+11 3.33458622e+09 7.48223323e+10 5.16144867e+11
 8.18512999e+10 1.73714202e+09 2.96062576e+10 6.09962561e+10
 1.70000380e+11 1.46610094e+11 2.46593022e+11 1.08697932e+10
 2.02695426e+10 2.93173626e+10 2.38105293e+11 1.99748530e+11
 8.74048643e+09 3.35065395e+10 7.89817780e+10 1.62258208e+11
 1.69203884e+11 8.24905136e+10 1.13828318e+11 9.42951887e+10
 3.77703057e+11 9.00364299e+10 1.00986105e+10 6.00377323e+10
 1.57963556e+11 1.05437898e+11 1.58553866e+11 8.73898238e+10
 3.10124586e+08 4.13780603e+09 3.46658231e+10 1.30219966e+11
 1.46943043e+12 2.48116834e+11 7.64035453e+10 1.11990130e+11
 2.09323156e+10 1.74037893e+09 8.19420603e+09 2.02526798e+11
 1.13954481e+11 3.22374173e+10 1.69179270e+10 5.36879589e+10
 4.77848099e+09 1.21833629e+12 1.00996989e+11 2.84233139e+10
 3.33201962e+10 2.39654224e+09 3.47584892e+10 3.47584892e+10
 3.95016063e+10 1.32454044e+10 4.80695357e+11 2.29343939e+10
 3.45409194e+11 6.15448624e+10 4.87970048e+10 9.14266472e+09
 1.01501974e+11 8.74048643e+09 1.01853045e+09 1.45098382e+11
 1.27226015e+10 1.53229682e+11 6.32620129e+11 1.25527648e+09
 2.18818217e+10 6.08717064e+09 1.48437485e+11 4.43242807e+08
 5.77969622e+11 5.24655484e+10 1.04444235e+11 1.13081099e+10
 4.92012320e+11 3.04786302e+10 4.08816607e+10 1.18472667e+11
 3.10440869e+11 3.49888188e+11 1.43127587e+11 1.42033320e+12
 3.48433268e+10 6.07999706e+09 2.15198095e+11 5.20810560e+10
 1.95312480e+11 1.82599505e+10 1.94461663e+09 4.70103941e+10
 3.69930658e+09 1.73643517e+11 7.21187713e+10 2.30967364e+10
 2.70664788e+11 2.27267045e+10 1.15275064e+10 2.36831690e+11
 6.09962561e+10 2.27973835e+11 1.06574260e+11 5.54850837e+11
 7.15415631e+10 6.32971123e+09 6.39780314e+10 2.76841402e+11
 2.24693266e+10 3.00631205e+10 3.50255266e+08 1.39334540e+11
 7.29547486e+08 2.09894934e+10 9.57960079e+09 9.58954833e+10
 1.98489402e+11 5.01879404e+11 6.00911174e+09 4.65524146e+09
 3.64330554e+10 6.87012418e+10 3.57623498e+10 4.81271389e+10
 2.61988781e+10 6.87420946e+10 7.38285357e+09 1.24054695e+11
 4.00757244e+10 1.42483647e+11 4.58418884e+10 1.63817099e+10
 1.13031719e+10 1.02893174e+11 2.12614236e+10 3.55584019e+10
 2.91507168e+10 5.83014336e+10 1.16160305e+11 3.61497216e+11
 7.09945878e+09 1.56401538e+09 1.01544594e+11 3.27405199e+10
 6.28773075e+09 2.82862983e+10 1.03051863e+11 4.32682160e+09
 3.82462640e+08 1.17856685e+12 2.02600034e+10 9.00411584e+10
 8.39580410e+10 1.08776966e+11 1.39856018e+10 2.66589673e+10
 2.55445356e+10 1.60270727e+11 5.83014336e+10 9.81400731e+10
 1.17525985e+11 1.57193269e+10 2.89517258e+10 2.32494355e+10
 1.84695055e+11 3.55652145e+10 1.13986917e+11 1.30962080e+11
 4.12106827e+11 3.05811372e+10 1.00996989e+11 2.06409970e+10
 1.01128547e+11 5.16646427e+08 7.19588681e+10 3.60568466e+09
 1.13465773e+11 3.81331135e+10 5.58781900e+10 2.97770853e+10
 7.76798434e+10 3.69390111e+11 1.19032094e+11 2.76777223e+11
 1.22438711e+10 3.16137080e+10 1.76558151e+11 3.95783846e+09
 2.99199711e+11 2.86479550e+10 1.20077244e+12 5.10917832e+10
 3.05033556e+10 3.10999467e+11 4.27450940e+10 1.58068540e+10
 7.27897158e+11 3.19935454e+10 1.06759176e+11 3.02691057e+10
 4.58008278e+10 1.21700853e+09 7.58386692e+10 6.06741469e+09
 4.10137959e+10 6.51692840e+08 1.24664338e+11 4.57477263e+09
 6.13884749e+10 4.99413803e+11 5.05642736e+10 5.99369620e+11
 5.17401448e+11 5.46602191e+10 3.24255544e+11 2.28658519e+10
 1.33088761e+10 2.62369052e+10 3.34221552e+11 4.94786846e+11
 3.47703722e+11 1.29776656e+12 2.62368667e+10 2.10618408e+10
 2.98731759e+10 1.95312480e+11 3.40359181e+10 8.41218683e+11
 1.45753584e+11 1.30962080e+11 7.78131221e+09 2.29900820e+10
 1.81390536e+11 1.50933088e+11 4.70696637e+09 7.56438488e+11
 1.04931097e+10 8.28899274e+09 2.45350183e+11 2.39654224e+09
 6.13375457e+11 3.43072756e+10 9.57205997e+10 5.05112471e+10
 2.82761953e+11 1.78563621e+11 5.72278051e+10 2.88762834e+10
 1.00713240e+11 2.10169553e+11 1.90217284e+10 4.24054121e+09
 2.89197773e+11 2.85824726e+09 5.64271484e+10 7.14658421e+09
 1.02175625e+10 7.23793145e+10 7.74326929e+08 1.56148130e+10
 3.53909718e+10 2.51400640e+11 2.80473772e+11 2.80989892e+10
 7.26270372e+09 5.24712902e+10 2.75507550e+11 4.29832230e+10
 8.16691592e+11 2.75507550e+11 1.01371583e+08 7.51012377e+08
 6.81650715e+10 6.60301828e+10 8.90033121e+11 6.91232568e+10
 5.06122399e+11 7.77352447e+10 1.95571674e+09 4.65555787e+11
 8.38869852e+11 1.92244403e+10 4.71616460e+10 7.45558231e+10
 2.10074507e+11 6.38613390e+10 1.09712408e+11 1.04942580e+11
 1.97840007e+10 8.73295937e+09 1.34431157e+10 1.16602867e+11
 5.03981732e+10 3.38375074e+09 1.14455610e+11 4.57611879e+10
 8.42597279e+11 3.51862226e+10 4.85499021e+10 2.09894934e+10
 4.90579928e+10 1.47756044e+11 8.67214629e+10 8.87432348e+09
 1.65512241e+09 2.56240939e+11 2.11029340e+11 4.28840945e+10
 5.56194432e+10 1.63702600e+11 2.02438441e+11 7.22434897e+10
 6.77325871e+09 1.06809785e+11 6.59625198e+11 1.20567167e+10
 7.25491908e+10 2.25713397e+10 2.32027088e+11 1.17187488e+11
 6.87012418e+10 3.01954154e+11 2.32986947e+11 1.33870938e+09
 4.28089769e+08 2.61738931e+10 9.92586282e+11 4.54098591e+10
 1.02907549e+11 1.61550902e+12 5.41790736e+10 3.84488806e+10
 3.49315904e+10 2.69394517e+10 2.23299372e+10 8.25424922e+09
 1.70980376e+11 5.63708596e+10 1.39425309e+10 2.11029340e+11
 6.27840100e+10 1.95312480e+11 3.07603469e+10 4.06496546e+11
 1.74235018e+11 1.47435389e+10 7.81733384e+10 1.01620853e+11
 1.45254074e+10 5.10917832e+10 1.58191578e+10 1.18447611e+11
 3.88399217e+10 1.60102992e+11 1.59942243e+10 1.97660847e+10
 4.74441241e+09 2.38105293e+11 2.30813341e+11 4.29503671e+10
 1.48756435e+10 1.83128976e+11 4.37281753e+09 2.53988585e+10
 7.60308314e+08 3.35514841e+09 1.12776995e+11 1.08037758e+10
 1.30994391e+10 4.29316802e+10 9.43116287e+09 1.67739704e+11
 6.94574067e+10 6.65260537e+10 6.51343378e+10 2.81898203e+10
 6.12682230e+09 9.12194241e+10 2.04628250e+11 3.61585003e+11
 5.06122399e+10 3.53961377e+09 5.48050024e+10 3.90416994e+11
 4.69757164e+10 6.82584153e+09 9.05598528e+10 6.56708921e+09
 2.12962229e+10 4.27142736e+10 2.11306323e+11 1.42032904e+10
 2.33870808e+11 1.84363580e+11 7.92986890e+11 6.49250521e+10
 6.76815535e+10 1.79922490e+11 8.54901880e+10 2.47320019e+10
 1.45753584e+11 3.77791306e+11 4.15849832e+09 1.22005311e+11
 2.84885701e+10 6.89019842e+10 6.18311176e+10 5.05772267e+09
 6.97944310e+10 2.53243224e+09 5.28265808e+11 1.43354430e+10
 1.24999987e+11 6.87141469e+10 1.66632259e+08 2.62320713e+11
 5.83014336e+10 2.82062365e+10 5.10233231e+10 1.58375661e+09
 3.29266397e+09 2.98731759e+10 6.58180603e+10 1.00996989e+11
 2.29550732e+11 2.13898395e+10 5.93982623e+10 1.38412898e+10
 3.35895647e+10 8.56855060e+10 1.38833759e+11 2.56678074e+10
 2.82885625e+09 1.69712662e+11 1.55820125e+11 2.45725649e+10
 8.36115142e+11 1.51828831e+11 7.68480438e+11 3.48609779e+10
 5.41790736e+10 1.07415218e+11 8.75755754e+09 1.27427138e+12
 1.99742974e+11 2.54083894e+11 1.29850104e+11 1.73518664e+11
 3.41960752e+11 6.59863771e+10 5.47045542e+10 6.54810399e+10
 7.49120704e+11 2.88728882e+10 8.46187094e+10 8.15109303e+10
 4.41365977e+09 7.57124524e+10 1.84108335e+11 5.37290288e+10
 4.09542748e+10 5.86347251e+09 5.92363335e+10 7.89817780e+10
 1.25044776e+10 1.10574489e+11 9.12194241e+10 1.61550902e+12
 4.35700518e+09 5.90998306e+10 2.71122912e+11 2.13725470e+11
 1.28814828e+11 5.01867614e+10 2.45913740e+11 1.26884452e+10
 2.98044457e+10 4.48670453e+10 2.40088563e+10 8.78693533e+08
 3.66525234e+10 6.84724164e+09 8.36234174e+09 9.74073614e+10
 5.72510348e+10 5.49936757e+10 1.31297015e+10 4.46171582e+10
 7.82940217e+09 2.58624526e+09 4.29382761e+10 6.75425569e+10
 2.77307049e+11 1.47307968e+11 3.55082261e+09 2.92892275e+09
 7.51660932e+09 3.04612470e+11 1.27722678e+10 4.29638091e+10
 3.55871491e+10 3.42871622e+10 1.04598127e+11 3.24871457e+10
 1.41798040e+11 1.02165755e+11 1.56249984e+11 4.57179453e+10
 3.48609779e+10 4.80219511e+10 2.70123475e+10 4.27667488e+10
 7.14254483e+10 2.90869549e+10 8.27931529e+11 5.24641425e+11
 5.46602191e+10 7.67014016e+09 5.03981732e+10 1.04965244e+09
 3.75805731e+10 3.80053924e+10 6.98636750e+09 3.02575395e+11
 1.82739192e+10 1.89688806e+10 9.93644511e+08 1.09145453e+11
 2.26876865e+11 5.53239890e+10 2.51400640e+11 3.27961314e+10
 1.66219117e+11 1.86264521e+11 1.85850686e+11 7.88840972e+10
 3.05665988e+10 2.61732173e+11 2.31469632e+10 4.73817731e+12
 1.88078414e+11 3.63362973e+10 5.32640927e+10 1.62312630e+11
 6.98636750e+09 4.14195054e+10 2.45954709e+10 1.94338112e+10
 3.50282589e+10 2.69393318e+10 1.15069803e+11 4.10137959e+10
 6.38091182e+10 1.23576766e+11 5.86247092e+10 5.99515541e+10
 1.56249984e+11 3.18647210e+10 1.19462025e+10 5.12672449e+10
 1.04965244e+09 3.64877696e+11 1.71181041e+09 5.55090358e+09
 9.79509691e+09 1.20899579e+11 2.03767611e+10 1.38309972e+11
 1.41431434e+10 5.34745988e+10 1.13986917e+11 2.63413117e+09
 1.38921555e+11 3.65307143e+09 4.65261301e+09 1.13194525e+10
 4.85845280e+10 7.16772149e+09 4.58955168e+08 1.48792293e+11
 3.08147376e+10 9.00411584e+10 1.61805676e+11 1.94118690e+08
 5.01669085e+11 7.12418233e+10 8.36946278e+09 8.85059171e+11
 1.10757844e+12 7.44579099e+09 1.46484360e+11 1.01128547e+11
 1.00499715e+12 3.27982875e+09 2.65877085e+10 7.25491908e+10
 8.08400164e+09 5.35286796e+10 1.42483647e+11 1.95312480e+11
 1.09145453e+11 2.70106065e+10 1.56148130e+10 1.60270727e+11
 7.49511642e+10 1.04186110e+11 8.70798507e+10 7.09081627e+10
 6.69627273e+08 3.02802477e+10 1.35839779e+11 2.22566954e+10
 5.42856880e+09 2.32806216e+09 8.73295937e+09 2.08888470e+11
 1.46221929e+11 1.06019804e+12 1.02314125e+11 4.47811211e+11
 5.81766910e+10 7.05155912e+10 2.88762834e+10 7.65797014e+10
 9.43116287e+09 5.46280402e+09 2.67009286e+08 5.87706287e+10
 1.63702600e+11 3.79364496e+10 2.47627477e+10 1.00996989e+11
 1.97454445e+11 2.62369052e+10 2.04356285e+10 1.40080171e+11
 3.79364496e+10 3.18884203e+09 2.01204998e+11 2.13725470e+11
 1.75781232e+11 3.03999853e+09 1.34332866e+11 2.05030472e+10
 4.18821383e+11 1.46610094e+11 6.59845364e+10 9.86372088e+10
 9.57960079e+09 1.01325179e+09 8.25377285e+10 1.05437898e+11
 1.34449596e+09 2.70123475e+10 1.39929956e+10 1.09256080e+10
 2.19913892e+10 5.06122399e+11 2.70094395e+10 2.90391696e+11
 2.84066641e+11 2.52146163e+11 1.91132107e+10 6.99782100e+07
 4.35399254e+10 2.88973959e+10 6.17040671e+10 1.30219966e+11
 2.88653252e+10 6.23467358e+11 7.00245793e+10 8.45752386e+09
 6.00377323e+10 7.89817780e+10 9.55696199e+09 8.64395120e+10
 6.72855410e+10 5.82733409e+09 9.04253753e+09 1.23465963e+10
 4.04089976e+10 1.29882799e+11 1.82988768e+11 2.66589673e+10
 1.43580900e+11 4.29832230e+10 3.07865194e+08 6.24999936e+10
 1.60270727e+11 5.64271484e+10 5.10233231e+10 7.85120585e+10
 4.37024321e+09 2.80989892e+10 7.55018410e+10 1.16708458e+10
 7.59982802e+10 9.71690559e+10 1.30994391e+10 5.66044707e+08
 2.62320713e+11 3.01866176e+11 2.72850609e+11 4.61386567e+10
 1.53065670e+12 2.53369283e+10 5.53083515e+10 4.65545136e+10
 7.17250033e+10 8.36234174e+09 1.90176447e+10 8.19420603e+09
 1.63702600e+11 7.47626000e+08 3.28110367e+10 9.89996158e+11
 7.23845430e+09 8.61289714e+09 2.10690198e+11 6.99747313e+09
 4.47811211e+11 1.21803553e+10]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[6.87012418e+10 2.19111733e+09 8.93140605e+09 3.85017111e+10
 1.17269450e+10 1.05653162e+11 1.34942601e+11 1.14864720e+11
 2.63258207e+10 9.97385526e+10 4.56178654e+10 1.46391015e+11
 5.23693616e+10 1.17269450e+10 9.05862461e+11 1.27427138e+12
 6.26342885e+10 3.90624960e+10 5.64271484e+10 3.41903464e+10
 1.89404472e+10 4.71616460e+09 8.36742562e+09 8.70260051e+11
 3.24506139e+11 2.26204056e+10 1.52439012e+10 1.38866967e+08
 8.93140605e+09 2.74816101e+10 4.42162127e+10 4.73444401e+11
 1.04228521e+10 2.45725649e+10 3.81898919e+11 7.64031474e+10
 4.13780603e+09 6.87012418e+10 6.73313262e+10 4.63148220e+10
 4.14195054e+10 4.67555335e+11 7.34006454e+09 8.18512999e+10
 1.06759176e+11 5.97380850e+10 1.39953941e+10 5.31876983e+09
 9.82215598e+10 3.47584892e+10 1.10297267e+12 3.28415437e+11
 2.55445356e+10 1.82988768e+11 1.65817131e+11 2.22811955e+10
 1.86599680e+11 1.58939861e+10 4.16353407e+10 1.28216582e+11
 2.04628250e+11 2.48799573e+11 3.02802477e+10 5.12672449e+09
 4.71616460e+10 8.75036403e+09 5.05078591e+10 1.21595829e+11
 4.37281753e+10 1.04795512e+10 8.01647249e+09 1.11241402e+11
 1.06885962e+11 5.29572072e+10 1.19185993e+10 2.32647822e+10
 4.43031378e+11 2.69974102e+10 1.74659187e+10 7.56163041e+10
 1.21354257e+11 1.84470922e+10 6.00911174e+09 2.80448774e+11
 5.64271484e+10 7.01544823e+09 5.67192161e+11 1.45885572e+10
 9.55703532e+11 2.05392259e+11 6.09962561e+10 2.71758738e+11
 3.04786302e+10 8.74521503e+10 6.07306599e+10 3.27961314e+10
 1.43127587e+11 1.86014217e+10 4.74205620e+10 2.35585623e+10
 1.98211953e+11 2.03023702e+11 1.80725766e+09 2.96790906e+08
 2.13664276e+10 1.31053679e+10 1.46484360e+11 1.39727350e+10
 4.29382761e+10 9.31785232e+11 1.22879162e+10 3.45230231e+11
 3.38619210e+10 3.80982878e+10 3.00507613e+11 4.05978574e+11
 2.88185385e+11 4.00676818e+11 2.92338785e+10 8.36385618e+10
 7.82940217e+09 4.16332735e+10 1.53367840e+10 5.50219204e+10
 1.69003198e+08 2.90508149e+10 5.67192161e+11 1.37283564e+11
 1.96448310e+11 1.00089583e+11 1.74281637e+10 2.53100517e+09
 3.95119676e+09 9.78959957e+10 7.61766503e+10 2.58323213e+08
 5.16076775e+09 1.66632259e+08 4.05978574e+11 2.11080063e+11
 2.28658519e+10 1.46391015e+11 2.66988469e+10 6.82584153e+09
 6.22569885e+10 5.01879404e+11 8.15109303e+10 5.67192161e+11
 2.74179486e+11 3.08777267e+10 2.43300575e+10 1.45254074e+10
 1.42483647e+11 5.05361737e+10 3.73436926e+10 1.30994391e+10
 1.80725766e+09 1.00499715e+12 4.78664849e+10 7.73839611e+11
 3.06674727e+10 7.36661699e+10 2.08888470e+11 2.92955297e+09
 3.82941390e+11 9.31785232e+11 6.88102367e+09 2.39491906e+11
 1.63817099e+10 8.73898238e+10 1.87999623e+11 9.50372196e+10
 1.19686263e+11 1.78053563e+10 9.79294597e+09 1.18324313e+10
 1.42483647e+11 2.13664276e+10 6.34285968e+11 5.85199717e+09
 1.17859528e+10 5.03981732e+10 4.51151755e+10 9.70318337e+10
 6.13375457e+11 3.03047155e+10 1.53795522e+10 2.32050524e+09
 1.31065229e+12 4.92358899e+10 9.63713079e+10 1.55989012e+11
 2.92338785e+10 1.36718736e+11 3.33458622e+09 7.48223323e+10
 5.16144867e+11 8.18512999e+10 1.73714202e+09 2.96062576e+10
 6.09962561e+10 1.70000380e+11 1.46610094e+11 2.46593022e+11
 1.08697932e+10 2.02695426e+10 2.93173626e+10 2.38105293e+11
 1.99748530e+11 8.74048643e+09 3.35065395e+10 7.89817780e+10
 1.62258208e+11 1.69203884e+11 8.24905136e+10 1.13828318e+11
 9.42951887e+10 3.77703057e+11 9.00364299e+10 1.00986105e+10
 6.00377323e+10 1.57963556e+11 1.05437898e+11 1.58553866e+11
 8.73898238e+10 3.10124586e+08 4.13780603e+09 3.46658231e+10
 1.30219966e+11 1.46943043e+12 2.48116834e+11 7.64035453e+10
 1.11990130e+11 2.09323156e+10 1.74037893e+09 8.19420603e+09
 2.02526798e+11 1.13954481e+11 1.69179270e+10 5.36879589e+10
 4.77848099e+09 1.21833629e+12 1.00996989e+11 2.84233139e+10
 3.33201962e+10 2.39654224e+09 3.47584892e+10 3.47584892e+10
 3.95016063e+10 1.32454044e+10 4.80695357e+11 2.29343939e+10
 3.45409194e+11 6.15448624e+10 4.87970048e+10 9.14266472e+09
 1.01501974e+11 8.74048643e+09 1.01853045e+09 1.45098382e+11
 1.27226015e+10 1.53229682e+11 6.32620129e+11 2.18818217e+10
 6.08717064e+09 1.48437485e+11 4.43242807e+08 5.24655484e+10
 1.04444235e+11 1.13081099e+10 4.92012320e+11 3.04786302e+10
 4.08816607e+10 1.18472667e+11 3.10440869e+11 3.49888188e+11
 1.43127587e+11 1.42033320e+12 3.48433268e+10 6.07999706e+09
 2.15198095e+11 5.20810560e+10 1.95312480e+11 1.82599505e+10
 1.94461663e+09 4.70103941e+10 3.69930658e+09 1.73643517e+11
 7.21187713e+10 2.30967364e+10 2.70664788e+11 2.27267045e+10
 1.15275064e+10 2.36831690e+11 2.27973835e+11 1.06574260e+11
 5.54850837e+11 7.15415631e+10 6.32971123e+09 6.39780314e+10
 2.76841402e+11 2.24693266e+10 3.00631205e+10 3.50255266e+08
 1.39334540e+11 7.29547486e+08 2.09894934e+10 9.57960079e+09
 9.58954833e+10 5.01879404e+11 6.00911174e+09 4.65524146e+09
 3.64330554e+10 6.87012418e+10 3.57623498e+10 4.81271389e+10
 2.61988781e+10 6.87420946e+10 7.38285357e+09 1.24054695e+11
 4.00757244e+10 1.42483647e+11 4.58418884e+10 1.63817099e+10
 1.02893174e+11 2.12614236e+10 3.55584019e+10 5.83014336e+10
 1.16160305e+11 3.61497216e+11 7.09945878e+09 1.56401538e+09
 3.27405199e+10 6.28773075e+09 1.03051863e+11 4.32682160e+09
 3.82462640e+08 1.17856685e+12 2.02600034e+10 9.00411584e+10
 8.39580410e+10 1.08776966e+11 1.39856018e+10 2.66589673e+10
 2.55445356e+10 1.60270727e+11 5.83014336e+10 9.81400731e+10
 1.17525985e+11 1.57193269e+10 2.89517258e+10 2.32494355e+10
 1.84695055e+11 3.55652145e+10 1.13986917e+11 1.30962080e+11
 4.12106827e+11 3.05811372e+10 1.00996989e+11 2.06409970e+10
 1.01128547e+11 5.16646427e+08 7.19588681e+10 3.60568466e+09
 1.13465773e+11 3.81331135e+10 5.58781900e+10 2.97770853e+10
 7.76798434e+10 3.69390111e+11 1.19032094e+11 2.76777223e+11
 1.22438711e+10 3.16137080e+10 1.76558151e+11 3.95783846e+09
 2.99199711e+11 2.86479550e+10 1.20077244e+12 5.10917832e+10
 3.05033556e+10 3.10999467e+11 4.27450940e+10 1.58068540e+10
 7.27897158e+11 3.19935454e+10 1.06759176e+11 3.02691057e+10
 4.58008278e+10 1.21700853e+09 7.58386692e+10 6.06741469e+09
 4.10137959e+10 6.51692840e+08 1.24664338e+11 4.57477263e+09
 6.13884749e+10 4.99413803e+11 5.99369620e+11 5.17401448e+11
 5.46602191e+10 3.24255544e+11 2.28658519e+10 1.33088761e+10
 2.62369052e+10 3.34221552e+11 4.94786846e+11 3.47703722e+11
 1.29776656e+12 2.62368667e+10 2.10618408e+10 2.98731759e+10
 3.40359181e+10 8.41218683e+11 1.45753584e+11 1.30962080e+11
 7.78131221e+09 2.29900820e+10 1.50933088e+11 4.70696637e+09
 7.56438488e+11 1.04931097e+10 8.28899274e+09 2.45350183e+11
 2.39654224e+09 6.13375457e+11 3.43072756e+10 5.05112471e+10
 2.82761953e+11 1.78563621e+11 5.72278051e+10 2.88762834e+10
 1.00713240e+11 2.10169553e+11 1.90217284e+10 4.24054121e+09
 2.89197773e+11 2.85824726e+09 5.64271484e+10 1.02175625e+10
 7.23793145e+10 7.74326929e+08 1.56148130e+10 3.53909718e+10
 2.51400640e+11 2.80473772e+11 2.80989892e+10 7.26270372e+09
 5.24712902e+10 2.75507550e+11 4.29832230e+10 8.16691592e+11
 2.75507550e+11 1.01371583e+08 7.51012377e+08 6.81650715e+10
 6.60301828e+10 8.90033121e+11 6.91232568e+10 5.06122399e+11
 7.77352447e+10 1.95571674e+09 4.65555787e+11 8.38869852e+11
 1.92244403e+10 4.71616460e+10 7.45558231e+10 2.10074507e+11
 6.38613390e+10 1.09712408e+11 1.04942580e+11 1.97840007e+10
 8.73295937e+09 1.34431157e+10 1.16602867e+11 5.03981732e+10
 3.38375074e+09 1.14455610e+11 4.57611879e+10 8.42597279e+11
 3.51862226e+10 4.85499021e+10 2.09894934e+10 4.90579928e+10
 1.47756044e+11 8.67214629e+10 8.87432348e+09 2.56240939e+11
 2.11029340e+11 4.28840945e+10 5.56194432e+10 1.63702600e+11
 2.02438441e+11 7.22434897e+10 6.77325871e+09 1.06809785e+11
 6.59625198e+11 1.20567167e+10 7.25491908e+10 2.25713397e+10
 2.32027088e+11 1.17187488e+11 6.87012418e+10 3.01954154e+11
 2.32986947e+11 2.61738931e+10 9.92586282e+11 4.54098591e+10
 1.02907549e+11 1.61550902e+12 5.41790736e+10 3.84488806e+10
 3.49315904e+10 2.69394517e+10 2.23299372e+10 8.25424922e+09
 1.70980376e+11 5.63708596e+10 1.39425309e+10 2.11029340e+11
 6.27840100e+10 1.95312480e+11 3.07603469e+10 4.06496546e+11
 1.74235018e+11 1.47435389e+10 7.81733384e+10 1.01620853e+11
 1.45254074e+10 5.10917832e+10 1.58191578e+10 1.18447611e+11
 1.60102992e+11 1.97660847e+10 4.74441241e+09 2.38105293e+11
 2.30813341e+11 4.29503671e+10 1.48756435e+10 4.37281753e+09
 2.53988585e+10 7.60308314e+08 3.35514841e+09 1.12776995e+11
 1.08037758e+10 1.30994391e+10 4.29316802e+10 9.43116287e+09
 1.67739704e+11 6.94574067e+10 6.65260537e+10 6.51343378e+10
 2.81898203e+10 6.12682230e+09 9.12194241e+10 2.04628250e+11
 3.61585003e+11 3.53961377e+09 5.48050024e+10 3.90416994e+11
 4.69757164e+10 6.82584153e+09 9.05598528e+10 6.56708921e+09
 2.12962229e+10 4.27142736e+10 2.11306323e+11 1.42032904e+10
 2.33870808e+11 1.84363580e+11 7.92986890e+11 6.49250521e+10
 6.76815535e+10 1.79922490e+11 8.54901880e+10 2.47320019e+10
 1.45753584e+11 3.77791306e+11 4.15849832e+09 2.84885701e+10
 6.89019842e+10 6.18311176e+10 5.05772267e+09 6.97944310e+10
 2.53243224e+09 5.28265808e+11 1.24999987e+11 6.87141469e+10
 1.66632259e+08 2.62320713e+11 5.83014336e+10 2.82062365e+10
 5.10233231e+10 1.58375661e+09 3.29266397e+09 2.98731759e+10
 6.58180603e+10 1.00996989e+11 2.29550732e+11 2.13898395e+10
 5.93982623e+10 1.38412898e+10 3.35895647e+10 8.56855060e+10
 1.38833759e+11 2.56678074e+10 2.82885625e+09 1.69712662e+11
 1.55820125e+11 2.45725649e+10 8.36115142e+11 1.51828831e+11
 7.68480438e+11 3.48609779e+10 5.41790736e+10 1.07415218e+11
 8.75755754e+09 1.27427138e+12 1.99742974e+11 2.54083894e+11
 1.73518664e+11 3.41960752e+11 6.59863771e+10 5.47045542e+10
 6.54810399e+10 7.49120704e+11 2.88728882e+10 8.46187094e+10
 8.15109303e+10 4.41365977e+09 7.57124524e+10 1.84108335e+11
 5.37290288e+10 4.09542748e+10 5.86347251e+09 5.92363335e+10
 7.89817780e+10 1.25044776e+10 1.10574489e+11 9.12194241e+10
 1.61550902e+12 4.35700518e+09 5.90998306e+10 2.71122912e+11
 2.13725470e+11 1.28814828e+11 5.01867614e+10 2.45913740e+11
 1.26884452e+10 2.98044457e+10 4.48670453e+10 2.40088563e+10
 8.78693533e+08 3.66525234e+10 6.84724164e+09 8.36234174e+09
 9.74073614e+10 5.72510348e+10 5.49936757e+10 1.31297015e+10
 4.46171582e+10 7.82940217e+09 2.58624526e+09 4.29382761e+10
 6.75425569e+10 2.77307049e+11 1.47307968e+11 3.55082261e+09
 2.92892275e+09 7.51660932e+09 3.04612470e+11 1.27722678e+10
 4.29638091e+10 3.55871491e+10 3.42871622e+10 1.04598127e+11
 3.24871457e+10 1.41798040e+11 1.02165755e+11 4.57179453e+10
 3.48609779e+10 4.80219511e+10 2.70123475e+10 4.27667488e+10
 7.14254483e+10 2.90869549e+10 8.27931529e+11 5.24641425e+11
 5.46602191e+10 7.67014016e+09 5.03981732e+10 1.04965244e+09
 3.75805731e+10 3.80053924e+10 6.98636750e+09 3.02575395e+11
 1.82739192e+10 1.89688806e+10 9.93644511e+08 1.09145453e+11
 2.26876865e+11 5.53239890e+10 2.51400640e+11 3.27961314e+10
 1.66219117e+11 1.86264521e+11 1.85850686e+11 7.88840972e+10
 3.05665988e+10 2.61732173e+11 2.31469632e+10 4.73817731e+12
 1.88078414e+11 3.63362973e+10 5.32640927e+10 1.62312630e+11
 6.98636750e+09 4.14195054e+10 2.45954709e+10 1.94338112e+10
 2.69393318e+10 1.15069803e+11 4.10137959e+10 6.38091182e+10
 1.23576766e+11 5.86247092e+10 5.99515541e+10 1.56249984e+11
 3.18647210e+10 1.19462025e+10 5.12672449e+10 1.04965244e+09
 3.64877696e+11 1.71181041e+09 5.55090358e+09 9.79509691e+09
 1.20899579e+11 2.03767611e+10 1.38309972e+11 5.34745988e+10
 1.13986917e+11 2.63413117e+09 1.38921555e+11 3.65307143e+09
 4.65261301e+09 1.13194525e+10 4.85845280e+10 7.16772149e+09
 4.58955168e+08 1.48792293e+11 3.08147376e+10 9.00411584e+10
 1.61805676e+11 1.94118690e+08 5.01669085e+11 7.12418233e+10
 8.36946278e+09 8.85059171e+11 1.10757844e+12 7.44579099e+09
 1.46484360e+11 1.01128547e+11 1.00499715e+12 3.27982875e+09
 2.65877085e+10 7.25491908e+10 5.35286796e+10 1.42483647e+11
 1.95312480e+11 1.09145453e+11 2.70106065e+10 1.56148130e+10
 1.60270727e+11 7.49511642e+10 1.04186110e+11 8.70798507e+10
 7.09081627e+10 6.69627273e+08 3.02802477e+10 1.35839779e+11
 2.22566954e+10 5.42856880e+09 2.32806216e+09 8.73295937e+09
 2.08888470e+11 1.46221929e+11 1.06019804e+12 1.02314125e+11
 4.47811211e+11 5.81766910e+10 7.05155912e+10 2.88762834e+10
 7.65797014e+10 9.43116287e+09 5.46280402e+09 2.67009286e+08
 5.87706287e+10 1.63702600e+11 3.79364496e+10 2.47627477e+10
 1.00996989e+11 1.97454445e+11 2.62369052e+10 2.04356285e+10
 1.40080171e+11 3.79364496e+10 3.18884203e+09 2.01204998e+11
 2.13725470e+11 1.75781232e+11 3.03999853e+09 1.34332866e+11
 2.05030472e+10 4.18821383e+11 1.46610094e+11 6.59845364e+10
 9.86372088e+10 9.57960079e+09 1.01325179e+09 8.25377285e+10
 1.05437898e+11 1.34449596e+09 2.70123475e+10 1.39929956e+10
 1.09256080e+10 2.19913892e+10 5.06122399e+11 2.70094395e+10
 2.90391696e+11 2.84066641e+11 2.52146163e+11 1.91132107e+10
 6.99782100e+07 2.88973959e+10 6.17040671e+10 1.30219966e+11
 2.88653252e+10 6.23467358e+11 7.00245793e+10 8.45752386e+09
 6.00377323e+10 7.89817780e+10 9.55696199e+09 8.64395120e+10
 6.72855410e+10 5.82733409e+09 9.04253753e+09 1.23465963e+10
 4.04089976e+10 1.29882799e+11 1.82988768e+11 2.66589673e+10
 4.29832230e+10 3.07865194e+08 6.24999936e+10 1.60270727e+11
 5.64271484e+10 5.10233231e+10 7.85120585e+10 4.37024321e+09
 2.80989892e+10 7.55018410e+10 1.16708458e+10 7.59982802e+10
 9.71690559e+10 1.30994391e+10 5.66044707e+08 2.62320713e+11
 3.01866176e+11 2.72850609e+11 4.61386567e+10 1.53065670e+12
 2.53369283e+10 5.53083515e+10 4.65545136e+10 7.17250033e+10
 8.36234174e+09 1.90176447e+10 8.19420603e+09 1.63702600e+11
 7.47626000e+08 3.28110367e+10 9.89996158e+11 8.61289714e+09
 2.10690198e+11 6.99747313e+09 4.47811211e+11 1.21803553e+10]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[6.87012418e+10 2.19111733e+09 8.93140605e+09 3.85017111e+10
 1.17269450e+10 1.05653162e+11 1.34942601e+11 1.14864720e+11
 2.63258207e+10 9.97385526e+10 4.56178654e+10 1.46391015e+11
 5.23693616e+10 1.17269450e+10 9.05862461e+11 1.27427138e+12
 6.26342885e+10 3.90624960e+10 3.41903464e+10 1.89404472e+10
 4.71616460e+09 8.36742562e+09 8.70260051e+11 3.24506139e+11
 2.26204056e+10 1.52439012e+10 1.38866967e+08 8.93140605e+09
 2.74816101e+10 4.42162127e+10 4.73444401e+11 1.04228521e+10
 2.45725649e+10 3.81898919e+11 7.64031474e+10 4.13780603e+09
 6.87012418e+10 6.73313262e+10 4.63148220e+10 4.14195054e+10
 4.67555335e+11 7.34006454e+09 8.18512999e+10 1.06759176e+11
 5.97380850e+10 1.39953941e+10 5.31876983e+09 9.82215598e+10
 3.47584892e+10 1.10297267e+12 3.28415437e+11 2.55445356e+10
 1.82988768e+11 1.65817131e+11 2.22811955e+10 1.86599680e+11
 1.58939861e+10 4.16353407e+10 1.28216582e+11 2.04628250e+11
 2.48799573e+11 3.02802477e+10 5.12672449e+09 4.71616460e+10
 8.75036403e+09 5.05078591e+10 1.21595829e+11 4.37281753e+10
 1.04795512e+10 8.01647249e+09 1.11241402e+11 1.06885962e+11
 5.29572072e+10 1.19185993e+10 2.32647822e+10 4.43031378e+11
 2.69974102e+10 1.74659187e+10 7.56163041e+10 1.21354257e+11
 1.84470922e+10 6.00911174e+09 2.80448774e+11 7.01544823e+09
 5.67192161e+11 1.45885572e+10 9.55703532e+11 2.05392259e+11
 6.09962561e+10 2.71758738e+11 3.04786302e+10 8.74521503e+10
 6.07306599e+10 3.27961314e+10 1.43127587e+11 1.86014217e+10
 4.74205620e+10 2.35585623e+10 1.98211953e+11 2.03023702e+11
 1.80725766e+09 2.96790906e+08 2.13664276e+10 1.31053679e+10
 1.46484360e+11 1.39727350e+10 4.29382761e+10 9.31785232e+11
 1.22879162e+10 3.45230231e+11 3.80982878e+10 3.00507613e+11
 4.05978574e+11 2.88185385e+11 4.00676818e+11 2.92338785e+10
 8.36385618e+10 7.82940217e+09 4.16332735e+10 1.53367840e+10
 5.50219204e+10 1.69003198e+08 2.90508149e+10 5.67192161e+11
 1.37283564e+11 1.96448310e+11 1.00089583e+11 1.74281637e+10
 2.53100517e+09 3.95119676e+09 9.78959957e+10 7.61766503e+10
 2.58323213e+08 5.16076775e+09 1.66632259e+08 4.05978574e+11
 2.11080063e+11 2.28658519e+10 1.46391015e+11 2.66988469e+10
 6.82584153e+09 6.22569885e+10 5.01879404e+11 8.15109303e+10
 5.67192161e+11 2.74179486e+11 3.08777267e+10 2.43300575e+10
 1.45254074e+10 1.42483647e+11 5.05361737e+10 3.73436926e+10
 1.30994391e+10 1.80725766e+09 1.00499715e+12 4.78664849e+10
 7.73839611e+11 3.06674727e+10 7.36661699e+10 2.08888470e+11
 2.92955297e+09 3.82941390e+11 9.31785232e+11 6.88102367e+09
 2.39491906e+11 1.63817099e+10 8.73898238e+10 1.87999623e+11
 9.50372196e+10 1.19686263e+11 1.78053563e+10 9.79294597e+09
 1.18324313e+10 1.42483647e+11 2.13664276e+10 6.34285968e+11
 5.85199717e+09 1.17859528e+10 5.03981732e+10 4.51151755e+10
 6.13375457e+11 3.03047155e+10 1.53795522e+10 2.32050524e+09
 1.31065229e+12 4.92358899e+10 9.63713079e+10 1.55989012e+11
 2.92338785e+10 1.36718736e+11 3.33458622e+09 7.48223323e+10
 5.16144867e+11 1.73714202e+09 2.96062576e+10 6.09962561e+10
 1.70000380e+11 1.46610094e+11 1.08697932e+10 2.02695426e+10
 2.93173626e+10 2.38105293e+11 1.99748530e+11 8.74048643e+09
 3.35065395e+10 7.89817780e+10 1.62258208e+11 1.69203884e+11
 8.24905136e+10 1.13828318e+11 9.42951887e+10 3.77703057e+11
 9.00364299e+10 1.00986105e+10 6.00377323e+10 1.57963556e+11
 1.05437898e+11 1.58553866e+11 8.73898238e+10 3.10124586e+08
 4.13780603e+09 3.46658231e+10 1.30219966e+11 1.46943043e+12
 2.48116834e+11 7.64035453e+10 1.11990130e+11 2.09323156e+10
 1.74037893e+09 8.19420603e+09 2.02526798e+11 1.13954481e+11
 1.69179270e+10 5.36879589e+10 4.77848099e+09 1.00996989e+11
 2.84233139e+10 3.33201962e+10 2.39654224e+09 3.47584892e+10
 3.47584892e+10 3.95016063e+10 1.32454044e+10 4.80695357e+11
 2.29343939e+10 3.45409194e+11 6.15448624e+10 4.87970048e+10
 9.14266472e+09 1.01501974e+11 8.74048643e+09 1.01853045e+09
 1.45098382e+11 1.27226015e+10 6.32620129e+11 2.18818217e+10
 6.08717064e+09 1.48437485e+11 4.43242807e+08 5.24655484e+10
 1.04444235e+11 1.13081099e+10 4.92012320e+11 3.04786302e+10
 4.08816607e+10 3.10440869e+11 3.49888188e+11 1.43127587e+11
 1.42033320e+12 3.48433268e+10 6.07999706e+09 2.15198095e+11
 5.20810560e+10 1.95312480e+11 1.82599505e+10 1.94461663e+09
 4.70103941e+10 3.69930658e+09 1.73643517e+11 7.21187713e+10
 2.30967364e+10 2.70664788e+11 2.27267045e+10 1.15275064e+10
 2.36831690e+11 2.27973835e+11 1.06574260e+11 5.54850837e+11
 7.15415631e+10 6.32971123e+09 6.39780314e+10 2.76841402e+11
 2.24693266e+10 3.50255266e+08 1.39334540e+11 7.29547486e+08
 2.09894934e+10 9.57960079e+09 9.58954833e+10 5.01879404e+11
 4.65524146e+09 3.64330554e+10 6.87012418e+10 3.57623498e+10
 4.81271389e+10 2.61988781e+10 6.87420946e+10 7.38285357e+09
 1.24054695e+11 4.00757244e+10 1.42483647e+11 4.58418884e+10
 1.63817099e+10 1.02893174e+11 2.12614236e+10 3.55584019e+10
 5.83014336e+10 1.16160305e+11 3.61497216e+11 7.09945878e+09
 1.56401538e+09 3.27405199e+10 6.28773075e+09 1.03051863e+11
 4.32682160e+09 1.17856685e+12 2.02600034e+10 9.00411584e+10
 8.39580410e+10 1.08776966e+11 1.39856018e+10 2.66589673e+10
 2.55445356e+10 1.60270727e+11 5.83014336e+10 1.17525985e+11
 1.57193269e+10 2.89517258e+10 2.32494355e+10 1.84695055e+11
 3.55652145e+10 1.13986917e+11 1.30962080e+11 4.12106827e+11
 3.05811372e+10 1.00996989e+11 2.06409970e+10 5.16646427e+08
 7.19588681e+10 3.60568466e+09 1.13465773e+11 3.81331135e+10
 5.58781900e+10 2.97770853e+10 7.76798434e+10 3.69390111e+11
 1.19032094e+11 2.76777223e+11 1.22438711e+10 3.16137080e+10
 1.76558151e+11 3.95783846e+09 2.99199711e+11 2.86479550e+10
 1.20077244e+12 5.10917832e+10 3.05033556e+10 3.10999467e+11
 4.27450940e+10 1.58068540e+10 7.27897158e+11 3.19935454e+10
 1.06759176e+11 3.02691057e+10 4.58008278e+10 1.21700853e+09
 7.58386692e+10 6.06741469e+09 4.10137959e+10 6.51692840e+08
 1.24664338e+11 4.57477263e+09 6.13884749e+10 4.99413803e+11
 5.99369620e+11 5.17401448e+11 5.46602191e+10 3.24255544e+11
 2.28658519e+10 1.33088761e+10 2.62369052e+10 3.34221552e+11
 4.94786846e+11 3.47703722e+11 1.29776656e+12 2.62368667e+10
 2.10618408e+10 2.98731759e+10 3.40359181e+10 8.41218683e+11
 1.45753584e+11 1.30962080e+11 7.78131221e+09 2.29900820e+10
 1.50933088e+11 4.70696637e+09 7.56438488e+11 1.04931097e+10
 8.28899274e+09 2.45350183e+11 2.39654224e+09 6.13375457e+11
 3.43072756e+10 5.05112471e+10 2.82761953e+11 1.78563621e+11
 5.72278051e+10 2.88762834e+10 1.00713240e+11 2.10169553e+11
 2.89197773e+11 2.85824726e+09 5.64271484e+10 1.02175625e+10
 7.23793145e+10 7.74326929e+08 1.56148130e+10 3.53909718e+10
 2.51400640e+11 2.80473772e+11 2.80989892e+10 7.26270372e+09
 5.24712902e+10 2.75507550e+11 4.29832230e+10 8.16691592e+11
 2.75507550e+11 1.01371583e+08 7.51012377e+08 6.81650715e+10
 6.60301828e+10 8.90033121e+11 6.91232568e+10 5.06122399e+11
 7.77352447e+10 1.95571674e+09 8.38869852e+11 1.92244403e+10
 4.71616460e+10 7.45558231e+10 2.10074507e+11 6.38613390e+10
 1.09712408e+11 1.97840007e+10 8.73295937e+09 1.34431157e+10
 1.16602867e+11 5.03981732e+10 3.38375074e+09 1.14455610e+11
 4.57611879e+10 8.42597279e+11 3.51862226e+10 4.85499021e+10
 2.09894934e+10 4.90579928e+10 1.47756044e+11 8.67214629e+10
 8.87432348e+09 2.56240939e+11 2.11029340e+11 4.28840945e+10
 5.56194432e+10 1.63702600e+11 2.02438441e+11 7.22434897e+10
 6.77325871e+09 1.06809785e+11 6.59625198e+11 1.20567167e+10
 7.25491908e+10 2.25713397e+10 2.32027088e+11 1.17187488e+11
 6.87012418e+10 3.01954154e+11 2.32986947e+11 2.61738931e+10
 9.92586282e+11 4.54098591e+10 1.02907549e+11 1.61550902e+12
 5.41790736e+10 3.84488806e+10 3.49315904e+10 2.69394517e+10
 2.23299372e+10 8.25424922e+09 1.70980376e+11 5.63708596e+10
 1.39425309e+10 2.11029340e+11 6.27840100e+10 1.95312480e+11
 3.07603469e+10 4.06496546e+11 1.74235018e+11 1.47435389e+10
 7.81733384e+10 1.01620853e+11 1.45254074e+10 5.10917832e+10
 1.58191578e+10 1.18447611e+11 1.60102992e+11 1.97660847e+10
 4.74441241e+09 2.38105293e+11 2.30813341e+11 4.29503671e+10
 1.48756435e+10 4.37281753e+09 2.53988585e+10 7.60308314e+08
 3.35514841e+09 1.12776995e+11 1.08037758e+10 4.29316802e+10
 9.43116287e+09 1.67739704e+11 6.94574067e+10 6.65260537e+10
 6.51343378e+10 2.81898203e+10 6.12682230e+09 9.12194241e+10
 2.04628250e+11 3.61585003e+11 3.53961377e+09 5.48050024e+10
 3.90416994e+11 4.69757164e+10 6.82584153e+09 9.05598528e+10
 6.56708921e+09 2.12962229e+10 4.27142736e+10 2.11306323e+11
 1.42032904e+10 2.33870808e+11 1.84363580e+11 7.92986890e+11
 6.49250521e+10 6.76815535e+10 1.79922490e+11 8.54901880e+10
 2.47320019e+10 1.45753584e+11 3.77791306e+11 4.15849832e+09
 2.84885701e+10 6.89019842e+10 6.18311176e+10 5.05772267e+09
 6.97944310e+10 2.53243224e+09 5.28265808e+11 1.24999987e+11
 6.87141469e+10 1.66632259e+08 2.62320713e+11 5.83014336e+10
 2.82062365e+10 5.10233231e+10 1.58375661e+09 3.29266397e+09
 2.98731759e+10 1.00996989e+11 2.29550732e+11 2.13898395e+10
 5.93982623e+10 1.38412898e+10 3.35895647e+10 8.56855060e+10
 1.38833759e+11 2.56678074e+10 2.82885625e+09 1.69712662e+11
 1.55820125e+11 2.45725649e+10 8.36115142e+11 1.51828831e+11
 7.68480438e+11 3.48609779e+10 5.41790736e+10 1.07415218e+11
 8.75755754e+09 1.27427138e+12 1.99742974e+11 2.54083894e+11
 1.73518664e+11 6.59863771e+10 5.47045542e+10 6.54810399e+10
 7.49120704e+11 2.88728882e+10 8.46187094e+10 8.15109303e+10
 4.41365977e+09 7.57124524e+10 1.84108335e+11 5.37290288e+10
 4.09542748e+10 5.86347251e+09 5.92363335e+10 7.89817780e+10
 1.25044776e+10 1.10574489e+11 9.12194241e+10 1.61550902e+12
 4.35700518e+09 5.90998306e+10 2.71122912e+11 2.13725470e+11
 1.28814828e+11 5.01867614e+10 2.45913740e+11 1.26884452e+10
 2.98044457e+10 4.48670453e+10 2.40088563e+10 8.78693533e+08
 3.66525234e+10 6.84724164e+09 8.36234174e+09 9.74073614e+10
 5.72510348e+10 5.49936757e+10 1.31297015e+10 4.46171582e+10
 7.82940217e+09 2.58624526e+09 4.29382761e+10 6.75425569e+10
 2.77307049e+11 1.47307968e+11 3.55082261e+09 7.51660932e+09
 3.04612470e+11 4.29638091e+10 3.55871491e+10 3.42871622e+10
 1.04598127e+11 3.24871457e+10 1.41798040e+11 1.02165755e+11
 4.57179453e+10 3.48609779e+10 4.80219511e+10 2.70123475e+10
 4.27667488e+10 7.14254483e+10 2.90869549e+10 8.27931529e+11
 5.24641425e+11 5.46602191e+10 7.67014016e+09 5.03981732e+10
 3.75805731e+10 3.80053924e+10 6.98636750e+09 3.02575395e+11
 1.82739192e+10 1.89688806e+10 9.93644511e+08 1.09145453e+11
 2.26876865e+11 5.53239890e+10 2.51400640e+11 3.27961314e+10
 1.66219117e+11 1.86264521e+11 1.85850686e+11 7.88840972e+10
 3.05665988e+10 2.61732173e+11 2.31469632e+10 4.73817731e+12
 1.88078414e+11 3.63362973e+10 5.32640927e+10 1.62312630e+11
 4.14195054e+10 2.45954709e+10 1.94338112e+10 2.69393318e+10
 1.15069803e+11 4.10137959e+10 6.38091182e+10 1.23576766e+11
 5.86247092e+10 5.99515541e+10 1.56249984e+11 3.18647210e+10
 1.19462025e+10 5.12672449e+10 1.04965244e+09 3.64877696e+11
 5.55090358e+09 9.79509691e+09 1.20899579e+11 2.03767611e+10
 1.38309972e+11 5.34745988e+10 1.13986917e+11 2.63413117e+09
 1.38921555e+11 3.65307143e+09 4.65261301e+09 1.13194525e+10
 4.85845280e+10 4.58955168e+08 1.48792293e+11 3.08147376e+10
 9.00411584e+10 1.61805676e+11 1.94118690e+08 5.01669085e+11
 7.12418233e+10 8.36946278e+09 8.85059171e+11 1.10757844e+12
 7.44579099e+09 1.46484360e+11 1.01128547e+11 1.00499715e+12
 3.27982875e+09 2.65877085e+10 7.25491908e+10 5.35286796e+10
 1.42483647e+11 1.95312480e+11 1.09145453e+11 2.70106065e+10
 1.56148130e+10 1.60270727e+11 7.49511642e+10 1.04186110e+11
 8.70798507e+10 7.09081627e+10 6.69627273e+08 3.02802477e+10
 1.35839779e+11 2.22566954e+10 5.42856880e+09 2.32806216e+09
 8.73295937e+09 2.08888470e+11 1.46221929e+11 1.06019804e+12
 1.02314125e+11 4.47811211e+11 5.81766910e+10 7.05155912e+10
 2.88762834e+10 7.65797014e+10 9.43116287e+09 5.46280402e+09
 2.67009286e+08 5.87706287e+10 1.63702600e+11 3.79364496e+10
 2.47627477e+10 1.00996989e+11 1.97454445e+11 2.62369052e+10
 2.04356285e+10 1.40080171e+11 3.79364496e+10 3.18884203e+09
 2.01204998e+11 2.13725470e+11 3.03999853e+09 2.05030472e+10
 4.18821383e+11 1.46610094e+11 6.59845364e+10 9.86372088e+10
 9.57960079e+09 1.01325179e+09 8.25377285e+10 1.34449596e+09
 2.70123475e+10 1.39929956e+10 1.09256080e+10 2.19913892e+10
 5.06122399e+11 2.70094395e+10 2.90391696e+11 2.84066641e+11
 2.52146163e+11 1.91132107e+10 6.99782100e+07 2.88973959e+10
 6.17040671e+10 1.30219966e+11 2.88653252e+10 6.23467358e+11
 7.00245793e+10 8.45752386e+09 6.00377323e+10 7.89817780e+10
 9.55696199e+09 8.64395120e+10 6.72855410e+10 5.82733409e+09
 9.04253753e+09 1.23465963e+10 4.04089976e+10 1.29882799e+11
 1.82988768e+11 2.66589673e+10 4.29832230e+10 3.07865194e+08
 6.24999936e+10 1.60270727e+11 5.64271484e+10 5.10233231e+10
 7.85120585e+10 4.37024321e+09 2.80989892e+10 7.55018410e+10
 1.16708458e+10 7.59982802e+10 9.71690559e+10 1.30994391e+10
 5.66044707e+08 2.62320713e+11 3.01866176e+11 2.72850609e+11
 4.61386567e+10 1.53065670e+12 2.53369283e+10 5.53083515e+10
 4.65545136e+10 7.17250033e+10 8.36234174e+09 1.90176447e+10
 8.19420603e+09 1.63702600e+11 7.47626000e+08 3.28110367e+10
 9.89996158e+11 8.61289714e+09 2.10690198e+11 6.99747313e+09
 4.47811211e+11 1.21803553e+10]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[6.87012418e+10 2.19111733e+09 8.93140605e+09 3.85017111e+10
 1.17269450e+10 1.05653162e+11 1.34942601e+11 1.14864720e+11
 2.63258207e+10 9.97385526e+10 4.56178654e+10 1.46391015e+11
 5.23693616e+10 1.17269450e+10 9.05862461e+11 1.27427138e+12
 6.26342885e+10 3.90624960e+10 3.41903464e+10 1.89404472e+10
 4.71616460e+09 8.36742562e+09 8.70260051e+11 3.24506139e+11
 1.38866967e+08 8.93140605e+09 2.74816101e+10 4.42162127e+10
 4.73444401e+11 1.04228521e+10 2.45725649e+10 3.81898919e+11
 7.64031474e+10 4.13780603e+09 6.87012418e+10 6.73313262e+10
 4.63148220e+10 4.14195054e+10 4.67555335e+11 7.34006454e+09
 8.18512999e+10 1.06759176e+11 5.97380850e+10 1.39953941e+10
 5.31876983e+09 9.82215598e+10 3.47584892e+10 1.10297267e+12
 3.28415437e+11 2.55445356e+10 1.65817131e+11 2.22811955e+10
 1.86599680e+11 1.58939861e+10 4.16353407e+10 1.28216582e+11
 2.04628250e+11 2.48799573e+11 3.02802477e+10 5.12672449e+09
 4.71616460e+10 8.75036403e+09 5.05078591e+10 4.37281753e+10
 8.01647249e+09 1.11241402e+11 1.06885962e+11 5.29572072e+10
 1.19185993e+10 2.32647822e+10 4.43031378e+11 2.69974102e+10
 1.74659187e+10 1.21354257e+11 1.84470922e+10 6.00911174e+09
 2.80448774e+11 7.01544823e+09 5.67192161e+11 1.45885572e+10
 9.55703532e+11 2.05392259e+11 6.09962561e+10 2.71758738e+11
 3.04786302e+10 8.74521503e+10 6.07306599e+10 3.27961314e+10
 1.43127587e+11 1.86014217e+10 4.74205620e+10 2.35585623e+10
 1.98211953e+11 2.03023702e+11 1.80725766e+09 2.96790906e+08
 2.13664276e+10 1.31053679e+10 1.46484360e+11 1.39727350e+10
 4.29382761e+10 9.31785232e+11 1.22879162e+10 3.45230231e+11
 3.80982878e+10 3.00507613e+11 4.05978574e+11 2.88185385e+11
 4.00676818e+11 2.92338785e+10 8.36385618e+10 7.82940217e+09
 4.16332735e+10 1.53367840e+10 5.50219204e+10 1.69003198e+08
 2.90508149e+10 5.67192161e+11 1.37283564e+11 1.96448310e+11
 1.00089583e+11 1.74281637e+10 2.53100517e+09 9.78959957e+10
 7.61766503e+10 2.58323213e+08 5.16076775e+09 1.66632259e+08
 4.05978574e+11 2.11080063e+11 2.28658519e+10 1.46391015e+11
 2.66988469e+10 6.82584153e+09 6.22569885e+10 5.01879404e+11
 5.67192161e+11 2.74179486e+11 3.08777267e+10 2.43300575e+10
 1.45254074e+10 1.42483647e+11 5.05361737e+10 3.73436926e+10
 1.30994391e+10 1.80725766e+09 1.00499715e+12 4.78664849e+10
 7.73839611e+11 3.06674727e+10 7.36661699e+10 2.08888470e+11
 2.92955297e+09 3.82941390e+11 9.31785232e+11 6.88102367e+09
 2.39491906e+11 1.63817099e+10 8.73898238e+10 1.87999623e+11
 9.50372196e+10 1.19686263e+11 1.78053563e+10 9.79294597e+09
 1.18324313e+10 1.42483647e+11 2.13664276e+10 6.34285968e+11
 1.17859528e+10 5.03981732e+10 4.51151755e+10 6.13375457e+11
 3.03047155e+10 1.53795522e+10 2.32050524e+09 9.63713079e+10
 1.55989012e+11 2.92338785e+10 1.36718736e+11 3.33458622e+09
 7.48223323e+10 5.16144867e+11 1.73714202e+09 2.96062576e+10
 6.09962561e+10 1.70000380e+11 1.46610094e+11 1.08697932e+10
 2.02695426e+10 2.93173626e+10 2.38105293e+11 1.99748530e+11
 3.35065395e+10 7.89817780e+10 1.62258208e+11 1.69203884e+11
 8.24905136e+10 1.13828318e+11 9.42951887e+10 3.77703057e+11
 9.00364299e+10 1.00986105e+10 6.00377323e+10 1.57963556e+11
 1.05437898e+11 1.58553866e+11 8.73898238e+10 3.10124586e+08
 4.13780603e+09 3.46658231e+10 1.30219966e+11 1.46943043e+12
 2.48116834e+11 7.64035453e+10 1.11990130e+11 2.09323156e+10
 1.74037893e+09 8.19420603e+09 2.02526798e+11 1.13954481e+11
 4.77848099e+09 1.00996989e+11 2.84233139e+10 3.33201962e+10
 2.39654224e+09 3.47584892e+10 3.47584892e+10 3.95016063e+10
 1.32454044e+10 4.80695357e+11 2.29343939e+10 3.45409194e+11
 6.15448624e+10 4.87970048e+10 9.14266472e+09 1.01501974e+11
 8.74048643e+09 1.01853045e+09 1.45098382e+11 1.27226015e+10
 6.32620129e+11 2.18818217e+10 6.08717064e+09 1.48437485e+11
 4.43242807e+08 5.24655484e+10 1.13081099e+10 4.92012320e+11
 3.04786302e+10 4.08816607e+10 3.10440869e+11 3.49888188e+11
 1.43127587e+11 1.42033320e+12 3.48433268e+10 6.07999706e+09
 2.15198095e+11 5.20810560e+10 1.95312480e+11 1.82599505e+10
 1.94461663e+09 4.70103941e+10 3.69930658e+09 1.73643517e+11
 7.21187713e+10 2.70664788e+11 2.27267045e+10 1.15275064e+10
 2.36831690e+11 2.27973835e+11 1.06574260e+11 5.54850837e+11
 7.15415631e+10 6.32971123e+09 6.39780314e+10 2.76841402e+11
 2.24693266e+10 3.50255266e+08 1.39334540e+11 7.29547486e+08
 2.09894934e+10 9.57960079e+09 9.58954833e+10 5.01879404e+11
 4.65524146e+09 3.64330554e+10 6.87012418e+10 3.57623498e+10
 4.81271389e+10 2.61988781e+10 6.87420946e+10 7.38285357e+09
 1.24054695e+11 1.42483647e+11 1.63817099e+10 1.02893174e+11
 2.12614236e+10 3.55584019e+10 5.83014336e+10 1.16160305e+11
 3.61497216e+11 7.09945878e+09 3.27405199e+10 6.28773075e+09
 4.32682160e+09 1.17856685e+12 2.02600034e+10 9.00411584e+10
 8.39580410e+10 1.08776966e+11 1.39856018e+10 2.66589673e+10
 2.55445356e+10 1.60270727e+11 1.17525985e+11 1.57193269e+10
 2.32494355e+10 1.84695055e+11 3.55652145e+10 1.13986917e+11
 1.30962080e+11 4.12106827e+11 3.05811372e+10 1.00996989e+11
 2.06409970e+10 5.16646427e+08 7.19588681e+10 3.60568466e+09
 1.13465773e+11 3.81331135e+10 5.58781900e+10 2.97770853e+10
 7.76798434e+10 3.69390111e+11 1.19032094e+11 2.76777223e+11
 1.22438711e+10 3.16137080e+10 1.76558151e+11 3.95783846e+09
 2.99199711e+11 2.86479550e+10 1.20077244e+12 5.10917832e+10
 3.05033556e+10 3.10999467e+11 4.27450940e+10 1.58068540e+10
 7.27897158e+11 3.19935454e+10 1.06759176e+11 3.02691057e+10
 4.58008278e+10 1.21700853e+09 7.58386692e+10 6.06741469e+09
 4.10137959e+10 6.51692840e+08 1.24664338e+11 4.57477263e+09
 6.13884749e+10 4.99413803e+11 5.99369620e+11 5.17401448e+11
 5.46602191e+10 3.24255544e+11 2.28658519e+10 2.62369052e+10
 3.34221552e+11 4.94786846e+11 3.47703722e+11 1.29776656e+12
 2.62368667e+10 2.10618408e+10 2.98731759e+10 3.40359181e+10
 8.41218683e+11 1.45753584e+11 1.30962080e+11 7.78131221e+09
 2.29900820e+10 1.50933088e+11 4.70696637e+09 7.56438488e+11
 1.04931097e+10 8.28899274e+09 2.45350183e+11 2.39654224e+09
 6.13375457e+11 3.43072756e+10 5.05112471e+10 1.78563621e+11
 5.72278051e+10 2.88762834e+10 1.00713240e+11 2.10169553e+11
 2.89197773e+11 2.85824726e+09 5.64271484e+10 1.02175625e+10
 7.23793145e+10 1.56148130e+10 3.53909718e+10 2.51400640e+11
 2.80473772e+11 2.80989892e+10 7.26270372e+09 5.24712902e+10
 2.75507550e+11 4.29832230e+10 8.16691592e+11 2.75507550e+11
 1.01371583e+08 7.51012377e+08 6.81650715e+10 6.60301828e+10
 8.90033121e+11 6.91232568e+10 5.06122399e+11 7.77352447e+10
 1.95571674e+09 8.38869852e+11 1.92244403e+10 4.71616460e+10
 7.45558231e+10 2.10074507e+11 6.38613390e+10 1.09712408e+11
 1.97840007e+10 1.34431157e+10 1.16602867e+11 5.03981732e+10
 3.38375074e+09 1.14455610e+11 4.57611879e+10 8.42597279e+11
 3.51862226e+10 4.85499021e+10 2.09894934e+10 4.90579928e+10
 1.47756044e+11 8.67214629e+10 8.87432348e+09 2.56240939e+11
 2.11029340e+11 4.28840945e+10 5.56194432e+10 1.63702600e+11
 2.02438441e+11 7.22434897e+10 6.77325871e+09 1.06809785e+11
 6.59625198e+11 1.20567167e+10 7.25491908e+10 2.25713397e+10
 2.32027088e+11 1.17187488e+11 6.87012418e+10 3.01954154e+11
 2.32986947e+11 2.61738931e+10 9.92586282e+11 4.54098591e+10
 1.02907549e+11 1.61550902e+12 3.49315904e+10 2.69394517e+10
 2.23299372e+10 8.25424922e+09 1.70980376e+11 5.63708596e+10
 1.39425309e+10 2.11029340e+11 6.27840100e+10 1.95312480e+11
 3.07603469e+10 4.06496546e+11 1.74235018e+11 1.47435389e+10
 7.81733384e+10 1.01620853e+11 1.45254074e+10 5.10917832e+10
 1.58191578e+10 1.18447611e+11 1.60102992e+11 1.97660847e+10
 4.74441241e+09 2.38105293e+11 2.30813341e+11 4.29503671e+10
 1.48756435e+10 4.37281753e+09 2.53988585e+10 7.60308314e+08
 3.35514841e+09 1.12776995e+11 1.08037758e+10 4.29316802e+10
 9.43116287e+09 1.67739704e+11 6.94574067e+10 6.65260537e+10
 6.51343378e+10 2.81898203e+10 6.12682230e+09 9.12194241e+10
 2.04628250e+11 3.61585003e+11 3.53961377e+09 5.48050024e+10
 3.90416994e+11 4.69757164e+10 6.82584153e+09 9.05598528e+10
 6.56708921e+09 2.12962229e+10 4.27142736e+10 2.11306323e+11
 1.42032904e+10 2.33870808e+11 1.84363580e+11 6.49250521e+10
 6.76815535e+10 1.79922490e+11 8.54901880e+10 2.47320019e+10
 1.45753584e+11 3.77791306e+11 4.15849832e+09 2.84885701e+10
 6.89019842e+10 6.18311176e+10 5.05772267e+09 6.97944310e+10
 2.53243224e+09 5.28265808e+11 1.24999987e+11 6.87141469e+10
 1.66632259e+08 2.62320713e+11 5.83014336e+10 2.82062365e+10
 5.10233231e+10 1.58375661e+09 3.29266397e+09 2.98731759e+10
 1.00996989e+11 2.29550732e+11 2.13898395e+10 5.93982623e+10
 1.38412898e+10 3.35895647e+10 8.56855060e+10 1.38833759e+11
 2.56678074e+10 2.82885625e+09 1.69712662e+11 1.55820125e+11
 2.45725649e+10 8.36115142e+11 1.51828831e+11 7.68480438e+11
 3.48609779e+10 1.07415218e+11 1.27427138e+12 1.99742974e+11
 2.54083894e+11 1.73518664e+11 5.47045542e+10 6.54810399e+10
 7.49120704e+11 2.88728882e+10 8.46187094e+10 8.15109303e+10
 4.41365977e+09 7.57124524e+10 1.84108335e+11 5.37290288e+10
 4.09542748e+10 5.86347251e+09 7.89817780e+10 1.25044776e+10
 1.10574489e+11 9.12194241e+10 1.61550902e+12 4.35700518e+09
 5.90998306e+10 2.71122912e+11 2.13725470e+11 1.28814828e+11
 5.01867614e+10 2.45913740e+11 1.26884452e+10 2.98044457e+10
 4.48670453e+10 2.40088563e+10 8.78693533e+08 3.66525234e+10
 6.84724164e+09 8.36234174e+09 9.74073614e+10 5.72510348e+10
 1.31297015e+10 4.46171582e+10 2.58624526e+09 4.29382761e+10
 6.75425569e+10 2.77307049e+11 1.47307968e+11 7.51660932e+09
 3.04612470e+11 4.29638091e+10 3.55871491e+10 3.42871622e+10
 1.04598127e+11 3.24871457e+10 1.41798040e+11 1.02165755e+11
 4.57179453e+10 3.48609779e+10 4.80219511e+10 2.70123475e+10
 4.27667488e+10 7.14254483e+10 2.90869549e+10 8.27931529e+11
 5.24641425e+11 5.46602191e+10 5.03981732e+10 3.75805731e+10
 3.80053924e+10 3.02575395e+11 1.82739192e+10 1.89688806e+10
 1.09145453e+11 2.26876865e+11 5.53239890e+10 2.51400640e+11
 3.27961314e+10 1.66219117e+11 1.86264521e+11 1.85850686e+11
 7.88840972e+10 3.05665988e+10 2.61732173e+11 2.31469632e+10
 4.73817731e+12 1.88078414e+11 3.63362973e+10 5.32640927e+10
 1.62312630e+11 4.14195054e+10 2.45954709e+10 1.94338112e+10
 2.69393318e+10 1.15069803e+11 4.10137959e+10 6.38091182e+10
 5.86247092e+10 5.99515541e+10 1.56249984e+11 3.18647210e+10
 1.19462025e+10 5.12672449e+10 1.04965244e+09 3.64877696e+11
 9.79509691e+09 1.20899579e+11 2.03767611e+10 1.38309972e+11
 5.34745988e+10 1.13986917e+11 2.63413117e+09 1.38921555e+11
 3.65307143e+09 4.65261301e+09 1.13194525e+10 4.85845280e+10
 4.58955168e+08 1.48792293e+11 3.08147376e+10 9.00411584e+10
 1.94118690e+08 5.01669085e+11 7.12418233e+10 8.36946278e+09
 8.85059171e+11 1.10757844e+12 7.44579099e+09 1.46484360e+11
 1.01128547e+11 1.00499715e+12 3.27982875e+09 2.65877085e+10
 7.25491908e+10 5.35286796e+10 1.42483647e+11 1.95312480e+11
 1.09145453e+11 2.70106065e+10 1.56148130e+10 1.60270727e+11
 7.49511642e+10 1.04186110e+11 8.70798507e+10 7.09081627e+10
 6.69627273e+08 3.02802477e+10 1.35839779e+11 2.22566954e+10
 5.42856880e+09 2.32806216e+09 8.73295937e+09 2.08888470e+11
 1.46221929e+11 1.06019804e+12 1.02314125e+11 4.47811211e+11
 5.81766910e+10 7.05155912e+10 2.88762834e+10 7.65797014e+10
 9.43116287e+09 5.46280402e+09 2.67009286e+08 5.87706287e+10
 1.63702600e+11 3.79364496e+10 2.47627477e+10 1.00996989e+11
 1.97454445e+11 2.62369052e+10 2.04356285e+10 1.40080171e+11
 3.79364496e+10 3.18884203e+09 2.01204998e+11 2.13725470e+11
 3.03999853e+09 2.05030472e+10 4.18821383e+11 1.46610094e+11
 6.59845364e+10 9.86372088e+10 9.57960079e+09 1.01325179e+09
 8.25377285e+10 1.34449596e+09 2.70123475e+10 1.39929956e+10
 1.09256080e+10 2.19913892e+10 5.06122399e+11 2.70094395e+10
 2.90391696e+11 2.84066641e+11 2.52146163e+11 1.91132107e+10
 6.99782100e+07 2.88973959e+10 6.17040671e+10 1.30219966e+11
 2.88653252e+10 6.23467358e+11 7.00245793e+10 8.45752386e+09
 6.00377323e+10 7.89817780e+10 9.55696199e+09 8.64395120e+10
 6.72855410e+10 5.82733409e+09 9.04253753e+09 1.23465963e+10
 4.04089976e+10 1.29882799e+11 1.82988768e+11 2.66589673e+10
 4.29832230e+10 3.07865194e+08 6.24999936e+10 1.60270727e+11
 5.64271484e+10 5.10233231e+10 7.85120585e+10 2.80989892e+10
 7.55018410e+10 1.16708458e+10 7.59982802e+10 9.71690559e+10
 1.30994391e+10 5.66044707e+08 2.62320713e+11 3.01866176e+11
 2.72850609e+11 4.61386567e+10 1.53065670e+12 2.53369283e+10
 5.53083515e+10 4.65545136e+10 7.17250033e+10 8.36234174e+09
 1.90176447e+10 1.63702600e+11 7.47626000e+08 3.28110367e+10
 9.89996158e+11 8.61289714e+09 2.10690198e+11 6.99747313e+09
 4.47811211e+11 1.21803553e+10]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[6.87012418e+10 2.19111733e+09 8.93140605e+09 3.85017111e+10
 1.05653162e+11 1.34942601e+11 1.14864720e+11 2.63258207e+10
 9.97385526e+10 4.56178654e+10 1.46391015e+11 5.23693616e+10
 1.17269450e+10 9.05862461e+11 1.27427138e+12 6.26342885e+10
 3.90624960e+10 1.89404472e+10 4.71616460e+09 8.36742562e+09
 8.70260051e+11 3.24506139e+11 1.38866967e+08 8.93140605e+09
 2.74816101e+10 4.42162127e+10 4.73444401e+11 1.04228521e+10
 2.45725649e+10 3.81898919e+11 7.64031474e+10 4.13780603e+09
 6.87012418e+10 6.73313262e+10 4.63148220e+10 4.14195054e+10
 4.67555335e+11 7.34006454e+09 8.18512999e+10 1.06759176e+11
 5.97380850e+10 1.39953941e+10 5.31876983e+09 9.82215598e+10
 3.47584892e+10 1.10297267e+12 3.28415437e+11 2.55445356e+10
 1.65817131e+11 2.22811955e+10 1.86599680e+11 1.58939861e+10
 4.16353407e+10 1.28216582e+11 2.04628250e+11 3.02802477e+10
 5.12672449e+09 4.71616460e+10 8.75036403e+09 5.05078591e+10
 4.37281753e+10 8.01647249e+09 1.11241402e+11 1.06885962e+11
 5.29572072e+10 1.19185993e+10 2.32647822e+10 4.43031378e+11
 2.69974102e+10 1.74659187e+10 1.21354257e+11 1.84470922e+10
 6.00911174e+09 2.80448774e+11 7.01544823e+09 5.67192161e+11
 1.45885572e+10 9.55703532e+11 2.05392259e+11 6.09962561e+10
 2.71758738e+11 3.04786302e+10 8.74521503e+10 6.07306599e+10
 3.27961314e+10 1.43127587e+11 1.86014217e+10 4.74205620e+10
 2.35585623e+10 1.98211953e+11 2.03023702e+11 1.80725766e+09
 2.96790906e+08 2.13664276e+10 1.31053679e+10 1.46484360e+11
 1.39727350e+10 4.29382761e+10 9.31785232e+11 1.22879162e+10
 3.45230231e+11 3.80982878e+10 3.00507613e+11 4.05978574e+11
 2.88185385e+11 4.00676818e+11 2.92338785e+10 8.36385618e+10
 7.82940217e+09 4.16332735e+10 1.53367840e+10 5.50219204e+10
 1.69003198e+08 2.90508149e+10 5.67192161e+11 1.37283564e+11
 1.96448310e+11 1.00089583e+11 1.74281637e+10 2.53100517e+09
 9.78959957e+10 7.61766503e+10 2.58323213e+08 5.16076775e+09
 1.66632259e+08 4.05978574e+11 2.11080063e+11 2.28658519e+10
 1.46391015e+11 2.66988469e+10 5.01879404e+11 5.67192161e+11
 2.74179486e+11 3.08777267e+10 2.43300575e+10 1.45254074e+10
 1.42483647e+11 5.05361737e+10 3.73436926e+10 1.30994391e+10
 1.80725766e+09 4.78664849e+10 7.73839611e+11 3.06674727e+10
 7.36661699e+10 2.08888470e+11 2.92955297e+09 3.82941390e+11
 9.31785232e+11 6.88102367e+09 2.39491906e+11 1.63817099e+10
 8.73898238e+10 1.87999623e+11 9.50372196e+10 1.19686263e+11
 1.78053563e+10 9.79294597e+09 1.18324313e+10 1.42483647e+11
 2.13664276e+10 6.34285968e+11 1.17859528e+10 5.03981732e+10
 4.51151755e+10 6.13375457e+11 3.03047155e+10 1.53795522e+10
 2.32050524e+09 9.63713079e+10 1.55989012e+11 2.92338785e+10
 1.36718736e+11 3.33458622e+09 7.48223323e+10 5.16144867e+11
 1.73714202e+09 2.96062576e+10 6.09962561e+10 1.70000380e+11
 1.46610094e+11 1.08697932e+10 2.02695426e+10 2.93173626e+10
 2.38105293e+11 1.99748530e+11 3.35065395e+10 1.62258208e+11
 1.69203884e+11 8.24905136e+10 1.13828318e+11 9.42951887e+10
 9.00364299e+10 1.00986105e+10 6.00377323e+10 1.57963556e+11
 1.05437898e+11 1.58553866e+11 8.73898238e+10 3.10124586e+08
 4.13780603e+09 3.46658231e+10 1.30219966e+11 1.46943043e+12
 2.48116834e+11 7.64035453e+10 1.11990130e+11 2.09323156e+10
 1.74037893e+09 8.19420603e+09 2.02526798e+11 1.13954481e+11
 4.77848099e+09 1.00996989e+11 2.84233139e+10 3.33201962e+10
 2.39654224e+09 3.47584892e+10 3.47584892e+10 3.95016063e+10
 1.32454044e+10 4.80695357e+11 2.29343939e+10 3.45409194e+11
 6.15448624e+10 4.87970048e+10 9.14266472e+09 1.01501974e+11
 8.74048643e+09 1.01853045e+09 1.45098382e+11 1.27226015e+10
 6.32620129e+11 2.18818217e+10 6.08717064e+09 1.48437485e+11
 4.43242807e+08 5.24655484e+10 1.13081099e+10 4.92012320e+11
 3.04786302e+10 3.10440869e+11 3.49888188e+11 1.43127587e+11
 1.42033320e+12 3.48433268e+10 6.07999706e+09 2.15198095e+11
 5.20810560e+10 1.95312480e+11 1.82599505e+10 1.94461663e+09
 4.70103941e+10 3.69930658e+09 1.73643517e+11 7.21187713e+10
 2.70664788e+11 2.27267045e+10 2.36831690e+11 2.27973835e+11
 1.06574260e+11 5.54850837e+11 7.15415631e+10 6.32971123e+09
 6.39780314e+10 2.76841402e+11 2.24693266e+10 3.50255266e+08
 1.39334540e+11 7.29547486e+08 2.09894934e+10 9.57960079e+09
 9.58954833e+10 5.01879404e+11 4.65524146e+09 3.64330554e+10
 6.87012418e+10 3.57623498e+10 4.81271389e+10 2.61988781e+10
 6.87420946e+10 1.24054695e+11 1.42483647e+11 1.63817099e+10
 1.02893174e+11 2.12614236e+10 3.55584019e+10 5.83014336e+10
 1.16160305e+11 3.61497216e+11 7.09945878e+09 3.27405199e+10
 6.28773075e+09 1.17856685e+12 2.02600034e+10 9.00411584e+10
 8.39580410e+10 1.08776966e+11 1.39856018e+10 2.66589673e+10
 2.55445356e+10 1.60270727e+11 1.17525985e+11 1.57193269e+10
 2.32494355e+10 1.84695055e+11 3.55652145e+10 1.13986917e+11
 1.30962080e+11 4.12106827e+11 3.05811372e+10 1.00996989e+11
 2.06409970e+10 7.19588681e+10 3.60568466e+09 1.13465773e+11
 3.81331135e+10 5.58781900e+10 2.97770853e+10 7.76798434e+10
 3.69390111e+11 1.19032094e+11 2.76777223e+11 1.22438711e+10
 1.76558151e+11 3.95783846e+09 2.99199711e+11 2.86479550e+10
 1.20077244e+12 5.10917832e+10 3.05033556e+10 3.10999467e+11
 4.27450940e+10 1.58068540e+10 7.27897158e+11 3.19935454e+10
 1.06759176e+11 3.02691057e+10 4.58008278e+10 1.21700853e+09
 7.58386692e+10 6.06741469e+09 4.10137959e+10 6.51692840e+08
 1.24664338e+11 6.13884749e+10 4.99413803e+11 5.99369620e+11
 5.17401448e+11 3.24255544e+11 2.28658519e+10 2.62369052e+10
 3.34221552e+11 4.94786846e+11 3.47703722e+11 1.29776656e+12
 2.62368667e+10 2.10618408e+10 2.98731759e+10 3.40359181e+10
 8.41218683e+11 1.45753584e+11 1.30962080e+11 7.78131221e+09
 2.29900820e+10 1.50933088e+11 4.70696637e+09 7.56438488e+11
 1.04931097e+10 8.28899274e+09 2.45350183e+11 2.39654224e+09
 6.13375457e+11 3.43072756e+10 5.05112471e+10 1.78563621e+11
 5.72278051e+10 2.88762834e+10 1.00713240e+11 2.10169553e+11
 2.89197773e+11 2.85824726e+09 5.64271484e+10 1.02175625e+10
 7.23793145e+10 1.56148130e+10 3.53909718e+10 2.51400640e+11
 2.80473772e+11 2.80989892e+10 7.26270372e+09 5.24712902e+10
 2.75507550e+11 4.29832230e+10 8.16691592e+11 2.75507550e+11
 1.01371583e+08 7.51012377e+08 6.81650715e+10 6.60301828e+10
 8.90033121e+11 6.91232568e+10 5.06122399e+11 7.77352447e+10
 1.95571674e+09 8.38869852e+11 1.92244403e+10 4.71616460e+10
 7.45558231e+10 2.10074507e+11 6.38613390e+10 1.09712408e+11
 1.97840007e+10 1.34431157e+10 1.16602867e+11 5.03981732e+10
 1.14455610e+11 4.57611879e+10 8.42597279e+11 3.51862226e+10
 2.09894934e+10 4.90579928e+10 1.47756044e+11 8.67214629e+10
 8.87432348e+09 2.56240939e+11 2.11029340e+11 4.28840945e+10
 5.56194432e+10 1.63702600e+11 2.02438441e+11 7.22434897e+10
 6.77325871e+09 1.06809785e+11 6.59625198e+11 1.20567167e+10
 7.25491908e+10 2.25713397e+10 2.32027088e+11 1.17187488e+11
 3.01954154e+11 2.32986947e+11 2.61738931e+10 9.92586282e+11
 4.54098591e+10 1.02907549e+11 1.61550902e+12 3.49315904e+10
 2.69394517e+10 2.23299372e+10 8.25424922e+09 1.70980376e+11
 5.63708596e+10 1.39425309e+10 2.11029340e+11 6.27840100e+10
 1.95312480e+11 3.07603469e+10 4.06496546e+11 1.74235018e+11
 1.47435389e+10 7.81733384e+10 1.01620853e+11 1.45254074e+10
 5.10917832e+10 1.58191578e+10 1.18447611e+11 1.60102992e+11
 1.97660847e+10 4.74441241e+09 2.38105293e+11 2.30813341e+11
 4.29503671e+10 1.48756435e+10 4.37281753e+09 2.53988585e+10
 3.35514841e+09 1.12776995e+11 1.08037758e+10 4.29316802e+10
 9.43116287e+09 1.67739704e+11 6.94574067e+10 6.65260537e+10
 6.51343378e+10 2.81898203e+10 9.12194241e+10 2.04628250e+11
 3.61585003e+11 3.53961377e+09 5.48050024e+10 3.90416994e+11
 4.69757164e+10 6.82584153e+09 9.05598528e+10 6.56708921e+09
 2.12962229e+10 4.27142736e+10 2.11306323e+11 1.42032904e+10
 2.33870808e+11 1.84363580e+11 6.49250521e+10 6.76815535e+10
 1.79922490e+11 8.54901880e+10 2.47320019e+10 1.45753584e+11
 3.77791306e+11 4.15849832e+09 2.84885701e+10 6.89019842e+10
 6.18311176e+10 5.05772267e+09 6.97944310e+10 2.53243224e+09
 5.28265808e+11 1.24999987e+11 1.66632259e+08 2.62320713e+11
 5.83014336e+10 5.10233231e+10 1.58375661e+09 3.29266397e+09
 1.00996989e+11 2.29550732e+11 2.13898395e+10 5.93982623e+10
 1.38412898e+10 3.35895647e+10 8.56855060e+10 1.38833759e+11
 2.56678074e+10 2.82885625e+09 1.69712662e+11 1.55820125e+11
 2.45725649e+10 8.36115142e+11 1.51828831e+11 7.68480438e+11
 3.48609779e+10 1.07415218e+11 1.27427138e+12 1.99742974e+11
 2.54083894e+11 1.73518664e+11 5.47045542e+10 6.54810399e+10
 7.49120704e+11 2.88728882e+10 8.46187094e+10 8.15109303e+10
 4.41365977e+09 7.57124524e+10 1.84108335e+11 5.37290288e+10
 4.09542748e+10 5.86347251e+09 7.89817780e+10 1.25044776e+10
 1.10574489e+11 9.12194241e+10 1.61550902e+12 4.35700518e+09
 5.90998306e+10 2.71122912e+11 2.13725470e+11 1.28814828e+11
 5.01867614e+10 2.45913740e+11 1.26884452e+10 2.98044457e+10
 4.48670453e+10 2.40088563e+10 8.78693533e+08 3.66525234e+10
 6.84724164e+09 8.36234174e+09 9.74073614e+10 1.31297015e+10
 4.46171582e+10 2.58624526e+09 4.29382761e+10 6.75425569e+10
 2.77307049e+11 1.47307968e+11 7.51660932e+09 3.04612470e+11
 4.29638091e+10 3.55871491e+10 3.42871622e+10 1.04598127e+11
 3.24871457e+10 1.41798040e+11 1.02165755e+11 4.57179453e+10
 3.48609779e+10 2.70123475e+10 4.27667488e+10 7.14254483e+10
 2.90869549e+10 8.27931529e+11 5.24641425e+11 5.46602191e+10
 5.03981732e+10 3.75805731e+10 3.02575395e+11 1.82739192e+10
 1.89688806e+10 1.09145453e+11 2.26876865e+11 5.53239890e+10
 3.27961314e+10 1.66219117e+11 1.86264521e+11 1.85850686e+11
 7.88840972e+10 3.05665988e+10 2.61732173e+11 2.31469632e+10
 4.73817731e+12 1.88078414e+11 3.63362973e+10 5.32640927e+10
 1.62312630e+11 4.14195054e+10 2.45954709e+10 1.94338112e+10
 2.69393318e+10 1.15069803e+11 4.10137959e+10 6.38091182e+10
 5.86247092e+10 5.99515541e+10 1.56249984e+11 3.18647210e+10
 1.19462025e+10 5.12672449e+10 1.04965244e+09 3.64877696e+11
 9.79509691e+09 1.20899579e+11 2.03767611e+10 1.38309972e+11
 5.34745988e+10 1.13986917e+11 2.63413117e+09 1.38921555e+11
 3.65307143e+09 4.65261301e+09 1.13194525e+10 4.85845280e+10
 4.58955168e+08 1.48792293e+11 3.08147376e+10 9.00411584e+10
 1.94118690e+08 5.01669085e+11 7.12418233e+10 8.36946278e+09
 8.85059171e+11 1.10757844e+12 7.44579099e+09 1.46484360e+11
 1.00499715e+12 2.65877085e+10 7.25491908e+10 5.35286796e+10
 1.42483647e+11 1.95312480e+11 1.09145453e+11 2.70106065e+10
 1.56148130e+10 7.49511642e+10 1.04186110e+11 8.70798507e+10
 7.09081627e+10 6.69627273e+08 1.35839779e+11 2.22566954e+10
 5.42856880e+09 2.32806216e+09 8.73295937e+09 2.08888470e+11
 1.46221929e+11 1.06019804e+12 1.02314125e+11 4.47811211e+11
 5.81766910e+10 7.05155912e+10 2.88762834e+10 7.65797014e+10
 9.43116287e+09 5.46280402e+09 2.67009286e+08 5.87706287e+10
 1.63702600e+11 3.79364496e+10 2.47627477e+10 1.00996989e+11
 1.97454445e+11 2.62369052e+10 2.04356285e+10 1.40080171e+11
 3.79364496e+10 3.18884203e+09 2.01204998e+11 2.13725470e+11
 3.03999853e+09 2.05030472e+10 4.18821383e+11 1.46610094e+11
 6.59845364e+10 9.86372088e+10 9.57960079e+09 1.01325179e+09
 8.25377285e+10 1.34449596e+09 2.70123475e+10 1.39929956e+10
 1.09256080e+10 2.19913892e+10 5.06122399e+11 2.70094395e+10
 2.90391696e+11 2.84066641e+11 2.52146163e+11 1.91132107e+10
 6.99782100e+07 2.88973959e+10 6.17040671e+10 1.30219966e+11
 2.88653252e+10 6.23467358e+11 7.00245793e+10 8.45752386e+09
 6.00377323e+10 7.89817780e+10 9.55696199e+09 8.64395120e+10
 6.72855410e+10 5.82733409e+09 1.23465963e+10 4.04089976e+10
 1.29882799e+11 1.82988768e+11 2.66589673e+10 4.29832230e+10
 3.07865194e+08 6.24999936e+10 1.60270727e+11 5.64271484e+10
 5.10233231e+10 2.80989892e+10 7.55018410e+10 1.16708458e+10
 9.71690559e+10 1.30994391e+10 5.66044707e+08 2.62320713e+11
 3.01866176e+11 2.72850609e+11 4.61386567e+10 1.53065670e+12
 2.53369283e+10 5.53083515e+10 4.65545136e+10 7.17250033e+10
 8.36234174e+09 1.90176447e+10 1.63702600e+11 7.47626000e+08
 3.28110367e+10 9.89996158e+11 8.61289714e+09 2.10690198e+11
 6.99747313e+09 4.47811211e+11 1.21803553e+10]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[6.87012418e+10 2.19111733e+09 8.93140605e+09 3.85017111e+10
 1.05653162e+11 1.34942601e+11 1.14864720e+11 2.63258207e+10
 9.97385526e+10 1.46391015e+11 5.23693616e+10 1.17269450e+10
 9.05862461e+11 1.27427138e+12 6.26342885e+10 1.89404472e+10
 4.71616460e+09 8.36742562e+09 8.70260051e+11 3.24506139e+11
 1.38866967e+08 8.93140605e+09 2.74816101e+10 4.42162127e+10
 4.73444401e+11 2.45725649e+10 3.81898919e+11 7.64031474e+10
 4.13780603e+09 6.87012418e+10 6.73313262e+10 4.14195054e+10
 4.67555335e+11 7.34006454e+09 8.18512999e+10 1.06759176e+11
 5.97380850e+10 1.39953941e+10 5.31876983e+09 9.82215598e+10
 3.47584892e+10 1.10297267e+12 3.28415437e+11 1.65817131e+11
 1.58939861e+10 4.16353407e+10 1.28216582e+11 2.04628250e+11
 3.02802477e+10 5.12672449e+09 4.71616460e+10 8.75036403e+09
 5.05078591e+10 4.37281753e+10 8.01647249e+09 1.11241402e+11
 1.06885962e+11 5.29572072e+10 1.19185993e+10 4.43031378e+11
 2.69974102e+10 1.74659187e+10 1.21354257e+11 1.84470922e+10
 6.00911174e+09 2.80448774e+11 7.01544823e+09 5.67192161e+11
 1.45885572e+10 9.55703532e+11 2.05392259e+11 6.09962561e+10
 2.71758738e+11 3.04786302e+10 8.74521503e+10 6.07306599e+10
 3.27961314e+10 1.43127587e+11 1.86014217e+10 4.74205620e+10
 2.35585623e+10 1.98211953e+11 2.03023702e+11 1.80725766e+09
 2.96790906e+08 2.13664276e+10 1.31053679e+10 1.39727350e+10
 4.29382761e+10 9.31785232e+11 1.22879162e+10 3.45230231e+11
 3.80982878e+10 3.00507613e+11 4.05978574e+11 2.88185385e+11
 4.00676818e+11 2.92338785e+10 7.82940217e+09 4.16332735e+10
 1.53367840e+10 1.69003198e+08 2.90508149e+10 5.67192161e+11
 1.37283564e+11 1.96448310e+11 1.00089583e+11 1.74281637e+10
 2.53100517e+09 9.78959957e+10 7.61766503e+10 2.58323213e+08
 5.16076775e+09 1.66632259e+08 4.05978574e+11 2.11080063e+11
 2.28658519e+10 1.46391015e+11 2.66988469e+10 5.01879404e+11
 5.67192161e+11 2.74179486e+11 3.08777267e+10 2.43300575e+10
 1.45254074e+10 1.42483647e+11 3.73436926e+10 1.80725766e+09
 4.78664849e+10 7.73839611e+11 3.06674727e+10 7.36661699e+10
 2.08888470e+11 2.92955297e+09 3.82941390e+11 9.31785232e+11
 6.88102367e+09 2.39491906e+11 1.63817099e+10 8.73898238e+10
 1.87999623e+11 9.50372196e+10 1.19686263e+11 1.78053563e+10
 9.79294597e+09 1.18324313e+10 1.42483647e+11 2.13664276e+10
 6.34285968e+11 1.17859528e+10 5.03981732e+10 4.51151755e+10
 6.13375457e+11 3.03047155e+10 1.53795522e+10 2.32050524e+09
 9.63713079e+10 1.55989012e+11 2.92338785e+10 1.36718736e+11
 3.33458622e+09 7.48223323e+10 5.16144867e+11 2.96062576e+10
 6.09962561e+10 1.70000380e+11 1.46610094e+11 1.08697932e+10
 2.02695426e+10 2.93173626e+10 2.38105293e+11 1.99748530e+11
 3.35065395e+10 1.62258208e+11 1.69203884e+11 1.13828318e+11
 9.42951887e+10 9.00364299e+10 6.00377323e+10 1.57963556e+11
 1.05437898e+11 1.58553866e+11 8.73898238e+10 3.10124586e+08
 4.13780603e+09 3.46658231e+10 1.30219966e+11 2.48116834e+11
 7.64035453e+10 1.11990130e+11 2.09323156e+10 8.19420603e+09
 2.02526798e+11 1.13954481e+11 4.77848099e+09 1.00996989e+11
 2.84233139e+10 3.33201962e+10 2.39654224e+09 3.47584892e+10
 3.95016063e+10 1.32454044e+10 4.80695357e+11 3.45409194e+11
 6.15448624e+10 4.87970048e+10 9.14266472e+09 1.01501974e+11
 8.74048643e+09 1.01853045e+09 1.45098382e+11 1.27226015e+10
 6.32620129e+11 1.48437485e+11 4.43242807e+08 5.24655484e+10
 1.13081099e+10 4.92012320e+11 3.04786302e+10 3.10440869e+11
 3.49888188e+11 1.43127587e+11 1.42033320e+12 3.48433268e+10
 6.07999706e+09 2.15198095e+11 5.20810560e+10 1.95312480e+11
 1.82599505e+10 1.94461663e+09 4.70103941e+10 3.69930658e+09
 1.73643517e+11 7.21187713e+10 2.70664788e+11 2.27267045e+10
 2.36831690e+11 2.27973835e+11 1.06574260e+11 5.54850837e+11
 7.15415631e+10 6.32971123e+09 6.39780314e+10 2.76841402e+11
 2.24693266e+10 1.39334540e+11 7.29547486e+08 2.09894934e+10
 9.57960079e+09 9.58954833e+10 5.01879404e+11 4.65524146e+09
 3.64330554e+10 6.87012418e+10 3.57623498e+10 6.87420946e+10
 1.24054695e+11 1.42483647e+11 1.63817099e+10 1.02893174e+11
 3.55584019e+10 5.83014336e+10 1.16160305e+11 3.61497216e+11
 7.09945878e+09 3.27405199e+10 6.28773075e+09 1.17856685e+12
 2.02600034e+10 9.00411584e+10 8.39580410e+10 1.08776966e+11
 1.39856018e+10 2.66589673e+10 2.55445356e+10 1.60270727e+11
 1.17525985e+11 1.57193269e+10 2.32494355e+10 1.84695055e+11
 3.55652145e+10 1.13986917e+11 1.30962080e+11 4.12106827e+11
 3.05811372e+10 1.00996989e+11 2.06409970e+10 7.19588681e+10
 3.60568466e+09 1.13465773e+11 3.81331135e+10 5.58781900e+10
 2.97770853e+10 7.76798434e+10 3.69390111e+11 1.19032094e+11
 2.76777223e+11 1.22438711e+10 1.76558151e+11 3.95783846e+09
 2.99199711e+11 2.86479550e+10 1.20077244e+12 5.10917832e+10
 3.05033556e+10 3.10999467e+11 4.27450940e+10 7.27897158e+11
 3.19935454e+10 1.06759176e+11 3.02691057e+10 7.58386692e+10
 6.06741469e+09 4.10137959e+10 1.24664338e+11 6.13884749e+10
 4.99413803e+11 5.99369620e+11 5.17401448e+11 3.24255544e+11
 2.28658519e+10 2.62369052e+10 3.34221552e+11 4.94786846e+11
 3.47703722e+11 1.29776656e+12 2.62368667e+10 2.10618408e+10
 2.98731759e+10 3.40359181e+10 8.41218683e+11 1.45753584e+11
 1.30962080e+11 7.78131221e+09 2.29900820e+10 1.50933088e+11
 4.70696637e+09 7.56438488e+11 1.04931097e+10 8.28899274e+09
 2.45350183e+11 2.39654224e+09 6.13375457e+11 3.43072756e+10
 5.05112471e+10 1.78563621e+11 2.88762834e+10 1.00713240e+11
 2.10169553e+11 2.89197773e+11 2.85824726e+09 5.64271484e+10
 1.02175625e+10 7.23793145e+10 1.56148130e+10 3.53909718e+10
 2.51400640e+11 2.80473772e+11 2.80989892e+10 7.26270372e+09
 5.24712902e+10 2.75507550e+11 4.29832230e+10 8.16691592e+11
 2.75507550e+11 1.01371583e+08 7.51012377e+08 6.81650715e+10
 6.60301828e+10 8.90033121e+11 6.91232568e+10 5.06122399e+11
 1.95571674e+09 8.38869852e+11 4.71616460e+10 7.45558231e+10
 2.10074507e+11 6.38613390e+10 1.09712408e+11 1.97840007e+10
 1.34431157e+10 1.16602867e+11 5.03981732e+10 1.14455610e+11
 4.57611879e+10 8.42597279e+11 3.51862226e+10 2.09894934e+10
 4.90579928e+10 1.47756044e+11 8.67214629e+10 8.87432348e+09
 2.56240939e+11 2.11029340e+11 4.28840945e+10 5.56194432e+10
 1.63702600e+11 2.02438441e+11 7.22434897e+10 6.77325871e+09
 1.06809785e+11 6.59625198e+11 1.20567167e+10 7.25491908e+10
 2.25713397e+10 2.32027088e+11 1.17187488e+11 3.01954154e+11
 2.32986947e+11 2.61738931e+10 9.92586282e+11 4.54098591e+10
 1.02907549e+11 1.61550902e+12 3.49315904e+10 2.69394517e+10
 2.23299372e+10 8.25424922e+09 1.70980376e+11 1.39425309e+10
 2.11029340e+11 6.27840100e+10 1.95312480e+11 3.07603469e+10
 4.06496546e+11 1.74235018e+11 1.47435389e+10 7.81733384e+10
 1.01620853e+11 1.45254074e+10 5.10917832e+10 1.58191578e+10
 1.18447611e+11 1.60102992e+11 1.97660847e+10 4.74441241e+09
 2.38105293e+11 2.30813341e+11 4.29503671e+10 1.48756435e+10
 4.37281753e+09 2.53988585e+10 3.35514841e+09 1.12776995e+11
 1.08037758e+10 4.29316802e+10 9.43116287e+09 1.67739704e+11
 6.94574067e+10 6.65260537e+10 6.51343378e+10 2.81898203e+10
 9.12194241e+10 2.04628250e+11 3.61585003e+11 3.53961377e+09
 5.48050024e+10 3.90416994e+11 4.69757164e+10 6.82584153e+09
 9.05598528e+10 6.56708921e+09 2.12962229e+10 4.27142736e+10
 2.11306323e+11 1.42032904e+10 2.33870808e+11 1.84363580e+11
 6.49250521e+10 6.76815535e+10 1.79922490e+11 8.54901880e+10
 2.47320019e+10 1.45753584e+11 3.77791306e+11 2.84885701e+10
 6.89019842e+10 6.18311176e+10 6.97944310e+10 2.53243224e+09
 5.28265808e+11 1.24999987e+11 1.66632259e+08 2.62320713e+11
 5.83014336e+10 5.10233231e+10 1.58375661e+09 3.29266397e+09
 1.00996989e+11 2.29550732e+11 2.13898395e+10 5.93982623e+10
 1.38412898e+10 3.35895647e+10 8.56855060e+10 1.38833759e+11
 2.56678074e+10 2.82885625e+09 1.69712662e+11 1.55820125e+11
 2.45725649e+10 8.36115142e+11 1.51828831e+11 7.68480438e+11
 3.48609779e+10 1.07415218e+11 1.27427138e+12 1.99742974e+11
 2.54083894e+11 1.73518664e+11 5.47045542e+10 6.54810399e+10
 7.49120704e+11 2.88728882e+10 8.46187094e+10 8.15109303e+10
 4.41365977e+09 7.57124524e+10 1.84108335e+11 5.37290288e+10
 4.09542748e+10 5.86347251e+09 7.89817780e+10 1.25044776e+10
 1.10574489e+11 9.12194241e+10 1.61550902e+12 4.35700518e+09
 5.90998306e+10 2.71122912e+11 2.13725470e+11 1.28814828e+11
 5.01867614e+10 2.45913740e+11 1.26884452e+10 2.98044457e+10
 4.48670453e+10 2.40088563e+10 8.78693533e+08 3.66525234e+10
 6.84724164e+09 8.36234174e+09 9.74073614e+10 1.31297015e+10
 4.46171582e+10 2.58624526e+09 4.29382761e+10 6.75425569e+10
 2.77307049e+11 1.47307968e+11 3.04612470e+11 4.29638091e+10
 3.55871491e+10 3.42871622e+10 1.04598127e+11 3.24871457e+10
 1.41798040e+11 1.02165755e+11 4.57179453e+10 3.48609779e+10
 2.70123475e+10 4.27667488e+10 7.14254483e+10 8.27931529e+11
 5.24641425e+11 5.46602191e+10 5.03981732e+10 3.75805731e+10
 3.02575395e+11 1.82739192e+10 1.89688806e+10 1.09145453e+11
 2.26876865e+11 5.53239890e+10 3.27961314e+10 1.66219117e+11
 1.86264521e+11 1.85850686e+11 7.88840972e+10 3.05665988e+10
 2.61732173e+11 2.31469632e+10 4.73817731e+12 1.88078414e+11
 3.63362973e+10 5.32640927e+10 1.62312630e+11 4.14195054e+10
 2.45954709e+10 1.94338112e+10 2.69393318e+10 1.15069803e+11
 4.10137959e+10 6.38091182e+10 5.86247092e+10 5.99515541e+10
 1.56249984e+11 3.18647210e+10 1.19462025e+10 5.12672449e+10
 1.04965244e+09 3.64877696e+11 9.79509691e+09 1.20899579e+11
 2.03767611e+10 1.38309972e+11 5.34745988e+10 1.13986917e+11
 2.63413117e+09 1.38921555e+11 3.65307143e+09 4.65261301e+09
 1.13194525e+10 4.85845280e+10 4.58955168e+08 1.48792293e+11
 3.08147376e+10 9.00411584e+10 1.94118690e+08 5.01669085e+11
 7.12418233e+10 8.36946278e+09 8.85059171e+11 1.10757844e+12
 1.46484360e+11 1.00499715e+12 2.65877085e+10 7.25491908e+10
 5.35286796e+10 1.42483647e+11 1.95312480e+11 1.09145453e+11
 2.70106065e+10 1.56148130e+10 7.49511642e+10 1.04186110e+11
 8.70798507e+10 6.69627273e+08 1.35839779e+11 2.22566954e+10
 5.42856880e+09 2.32806216e+09 8.73295937e+09 2.08888470e+11
 1.46221929e+11 1.06019804e+12 1.02314125e+11 4.47811211e+11
 5.81766910e+10 7.05155912e+10 2.88762834e+10 7.65797014e+10
 9.43116287e+09 5.46280402e+09 2.67009286e+08 5.87706287e+10
 1.63702600e+11 3.79364496e+10 2.47627477e+10 1.00996989e+11
 1.97454445e+11 2.62369052e+10 2.04356285e+10 1.40080171e+11
 3.79364496e+10 3.18884203e+09 2.01204998e+11 2.13725470e+11
 3.03999853e+09 2.05030472e+10 4.18821383e+11 1.46610094e+11
 6.59845364e+10 9.86372088e+10 9.57960079e+09 1.01325179e+09
 8.25377285e+10 1.34449596e+09 2.70123475e+10 1.39929956e+10
 1.09256080e+10 5.06122399e+11 2.70094395e+10 2.90391696e+11
 2.84066641e+11 2.52146163e+11 1.91132107e+10 2.88973959e+10
 6.17040671e+10 1.30219966e+11 2.88653252e+10 6.23467358e+11
 7.00245793e+10 8.45752386e+09 6.00377323e+10 7.89817780e+10
 9.55696199e+09 8.64395120e+10 6.72855410e+10 5.82733409e+09
 1.23465963e+10 4.04089976e+10 1.29882799e+11 1.82988768e+11
 2.66589673e+10 4.29832230e+10 3.07865194e+08 1.60270727e+11
 5.64271484e+10 5.10233231e+10 2.80989892e+10 7.55018410e+10
 1.16708458e+10 9.71690559e+10 1.30994391e+10 5.66044707e+08
 2.62320713e+11 3.01866176e+11 2.72850609e+11 4.61386567e+10
 1.53065670e+12 2.53369283e+10 5.53083515e+10 4.65545136e+10
 7.17250033e+10 8.36234174e+09 1.90176447e+10 1.63702600e+11
 7.47626000e+08 3.28110367e+10 9.89996158e+11 8.61289714e+09
 2.10690198e+11 6.99747313e+09 4.47811211e+11 1.21803553e+10]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[6.87012418e+10 2.19111733e+09 8.93140605e+09 3.85017111e+10
 1.05653162e+11 1.34942601e+11 1.14864720e+11 2.63258207e+10
 1.46391015e+11 5.23693616e+10 1.17269450e+10 9.05862461e+11
 1.27427138e+12 6.26342885e+10 4.71616460e+09 8.36742562e+09
 8.70260051e+11 3.24506139e+11 1.38866967e+08 8.93140605e+09
 2.74816101e+10 4.42162127e+10 4.73444401e+11 2.45725649e+10
 3.81898919e+11 7.64031474e+10 4.13780603e+09 6.87012418e+10
 6.73313262e+10 4.14195054e+10 4.67555335e+11 8.18512999e+10
 1.06759176e+11 5.97380850e+10 1.39953941e+10 5.31876983e+09
 9.82215598e+10 1.10297267e+12 3.28415437e+11 1.65817131e+11
 1.58939861e+10 4.16353407e+10 1.28216582e+11 2.04628250e+11
 3.02802477e+10 5.12672449e+09 4.71616460e+10 8.75036403e+09
 5.05078591e+10 4.37281753e+10 8.01647249e+09 1.11241402e+11
 1.06885962e+11 5.29572072e+10 1.19185993e+10 4.43031378e+11
 2.69974102e+10 1.74659187e+10 1.21354257e+11 1.84470922e+10
 6.00911174e+09 2.80448774e+11 7.01544823e+09 5.67192161e+11
 1.45885572e+10 9.55703532e+11 6.09962561e+10 2.71758738e+11
 3.04786302e+10 8.74521503e+10 6.07306599e+10 3.27961314e+10
 1.43127587e+11 1.86014217e+10 4.74205620e+10 2.35585623e+10
 2.03023702e+11 1.80725766e+09 2.96790906e+08 2.13664276e+10
 1.31053679e+10 1.39727350e+10 4.29382761e+10 9.31785232e+11
 1.22879162e+10 3.45230231e+11 3.80982878e+10 3.00507613e+11
 4.05978574e+11 2.88185385e+11 4.00676818e+11 2.92338785e+10
 7.82940217e+09 4.16332735e+10 1.69003198e+08 2.90508149e+10
 5.67192161e+11 1.37283564e+11 1.96448310e+11 1.00089583e+11
 1.74281637e+10 2.53100517e+09 9.78959957e+10 7.61766503e+10
 2.58323213e+08 5.16076775e+09 1.66632259e+08 4.05978574e+11
 2.11080063e+11 2.28658519e+10 1.46391015e+11 2.66988469e+10
 5.01879404e+11 5.67192161e+11 2.74179486e+11 2.43300575e+10
 1.45254074e+10 1.42483647e+11 3.73436926e+10 1.80725766e+09
 4.78664849e+10 7.73839611e+11 3.06674727e+10 7.36661699e+10
 2.08888470e+11 2.92955297e+09 3.82941390e+11 9.31785232e+11
 6.88102367e+09 2.39491906e+11 1.63817099e+10 8.73898238e+10
 1.87999623e+11 9.50372196e+10 1.19686263e+11 1.78053563e+10
 9.79294597e+09 1.18324313e+10 1.42483647e+11 2.13664276e+10
 6.34285968e+11 1.17859528e+10 5.03981732e+10 4.51151755e+10
 6.13375457e+11 3.03047155e+10 1.53795522e+10 2.32050524e+09
 9.63713079e+10 1.55989012e+11 2.92338785e+10 1.36718736e+11
 3.33458622e+09 7.48223323e+10 5.16144867e+11 2.96062576e+10
 6.09962561e+10 1.70000380e+11 1.46610094e+11 2.02695426e+10
 2.93173626e+10 1.99748530e+11 3.35065395e+10 1.62258208e+11
 1.69203884e+11 1.13828318e+11 9.42951887e+10 9.00364299e+10
 6.00377323e+10 1.57963556e+11 1.05437898e+11 1.58553866e+11
 8.73898238e+10 3.10124586e+08 4.13780603e+09 3.46658231e+10
 1.30219966e+11 2.48116834e+11 7.64035453e+10 1.11990130e+11
 8.19420603e+09 2.02526798e+11 1.13954481e+11 4.77848099e+09
 1.00996989e+11 2.84233139e+10 3.33201962e+10 2.39654224e+09
 3.47584892e+10 3.95016063e+10 1.32454044e+10 4.80695357e+11
 3.45409194e+11 6.15448624e+10 4.87970048e+10 9.14266472e+09
 1.01501974e+11 8.74048643e+09 1.01853045e+09 1.45098382e+11
 1.27226015e+10 6.32620129e+11 1.48437485e+11 4.43242807e+08
 1.13081099e+10 4.92012320e+11 3.10440869e+11 3.49888188e+11
 1.43127587e+11 1.42033320e+12 3.48433268e+10 6.07999706e+09
 2.15198095e+11 5.20810560e+10 1.95312480e+11 1.82599505e+10
 1.94461663e+09 4.70103941e+10 3.69930658e+09 1.73643517e+11
 7.21187713e+10 2.70664788e+11 2.27267045e+10 2.36831690e+11
 2.27973835e+11 1.06574260e+11 5.54850837e+11 7.15415631e+10
 6.32971123e+09 6.39780314e+10 2.76841402e+11 2.24693266e+10
 1.39334540e+11 7.29547486e+08 2.09894934e+10 9.57960079e+09
 9.58954833e+10 5.01879404e+11 4.65524146e+09 3.64330554e+10
 6.87012418e+10 3.57623498e+10 6.87420946e+10 1.42483647e+11
 1.63817099e+10 1.02893174e+11 3.55584019e+10 5.83014336e+10
 1.16160305e+11 3.61497216e+11 7.09945878e+09 3.27405199e+10
 6.28773075e+09 1.17856685e+12 2.02600034e+10 9.00411584e+10
 8.39580410e+10 1.08776966e+11 1.39856018e+10 2.66589673e+10
 2.55445356e+10 1.60270727e+11 1.17525985e+11 1.57193269e+10
 2.32494355e+10 1.84695055e+11 3.55652145e+10 1.13986917e+11
 1.30962080e+11 4.12106827e+11 3.05811372e+10 1.00996989e+11
 2.06409970e+10 7.19588681e+10 3.60568466e+09 1.13465773e+11
 3.81331135e+10 5.58781900e+10 2.97770853e+10 7.76798434e+10
 3.69390111e+11 1.19032094e+11 2.76777223e+11 1.22438711e+10
 1.76558151e+11 3.95783846e+09 2.86479550e+10 1.20077244e+12
 5.10917832e+10 3.05033556e+10 3.10999467e+11 4.27450940e+10
 7.27897158e+11 3.19935454e+10 1.06759176e+11 3.02691057e+10
 7.58386692e+10 6.06741469e+09 4.10137959e+10 1.24664338e+11
 4.99413803e+11 5.99369620e+11 5.17401448e+11 3.24255544e+11
 2.28658519e+10 2.62369052e+10 4.94786846e+11 3.47703722e+11
 1.29776656e+12 2.62368667e+10 2.10618408e+10 2.98731759e+10
 3.40359181e+10 8.41218683e+11 1.45753584e+11 1.30962080e+11
 7.78131221e+09 1.50933088e+11 4.70696637e+09 7.56438488e+11
 1.04931097e+10 8.28899274e+09 2.45350183e+11 2.39654224e+09
 6.13375457e+11 3.43072756e+10 5.05112471e+10 1.78563621e+11
 2.88762834e+10 1.00713240e+11 2.10169553e+11 2.89197773e+11
 2.85824726e+09 1.02175625e+10 7.23793145e+10 1.56148130e+10
 3.53909718e+10 2.51400640e+11 2.80473772e+11 2.80989892e+10
 7.26270372e+09 5.24712902e+10 2.75507550e+11 4.29832230e+10
 8.16691592e+11 2.75507550e+11 7.51012377e+08 6.81650715e+10
 6.60301828e+10 8.90033121e+11 6.91232568e+10 5.06122399e+11
 1.95571674e+09 8.38869852e+11 4.71616460e+10 7.45558231e+10
 2.10074507e+11 6.38613390e+10 1.09712408e+11 1.97840007e+10
 1.34431157e+10 1.16602867e+11 5.03981732e+10 1.14455610e+11
 4.57611879e+10 8.42597279e+11 3.51862226e+10 2.09894934e+10
 4.90579928e+10 1.47756044e+11 8.67214629e+10 8.87432348e+09
 2.56240939e+11 2.11029340e+11 4.28840945e+10 5.56194432e+10
 1.63702600e+11 2.02438441e+11 7.22434897e+10 6.77325871e+09
 1.06809785e+11 6.59625198e+11 7.25491908e+10 2.25713397e+10
 2.32027088e+11 1.17187488e+11 3.01954154e+11 2.32986947e+11
 2.61738931e+10 9.92586282e+11 4.54098591e+10 1.02907549e+11
 1.61550902e+12 3.49315904e+10 2.69394517e+10 2.23299372e+10
 8.25424922e+09 1.70980376e+11 1.39425309e+10 2.11029340e+11
 6.27840100e+10 1.95312480e+11 3.07603469e+10 4.06496546e+11
 1.74235018e+11 1.47435389e+10 7.81733384e+10 1.01620853e+11
 5.10917832e+10 1.58191578e+10 1.18447611e+11 1.60102992e+11
 1.97660847e+10 4.74441241e+09 2.30813341e+11 4.29503671e+10
 1.48756435e+10 4.37281753e+09 2.53988585e+10 3.35514841e+09
 1.12776995e+11 1.08037758e+10 4.29316802e+10 9.43116287e+09
 1.67739704e+11 6.94574067e+10 6.65260537e+10 6.51343378e+10
 2.81898203e+10 9.12194241e+10 2.04628250e+11 3.61585003e+11
 3.53961377e+09 5.48050024e+10 3.90416994e+11 4.69757164e+10
 6.82584153e+09 6.56708921e+09 2.12962229e+10 4.27142736e+10
 2.11306323e+11 1.42032904e+10 2.33870808e+11 1.84363580e+11
 6.76815535e+10 1.79922490e+11 8.54901880e+10 2.47320019e+10
 1.45753584e+11 3.77791306e+11 2.84885701e+10 6.89019842e+10
 6.18311176e+10 6.97944310e+10 2.53243224e+09 5.28265808e+11
 1.24999987e+11 1.66632259e+08 2.62320713e+11 5.83014336e+10
 5.10233231e+10 1.58375661e+09 3.29266397e+09 1.00996989e+11
 2.29550732e+11 2.13898395e+10 5.93982623e+10 1.38412898e+10
 3.35895647e+10 8.56855060e+10 2.56678074e+10 2.82885625e+09
 1.69712662e+11 1.55820125e+11 2.45725649e+10 8.36115142e+11
 1.51828831e+11 7.68480438e+11 3.48609779e+10 1.07415218e+11
 1.27427138e+12 1.99742974e+11 2.54083894e+11 1.73518664e+11
 5.47045542e+10 6.54810399e+10 7.49120704e+11 2.88728882e+10
 8.46187094e+10 8.15109303e+10 4.41365977e+09 7.57124524e+10
 1.84108335e+11 5.37290288e+10 4.09542748e+10 5.86347251e+09
 7.89817780e+10 1.25044776e+10 1.10574489e+11 9.12194241e+10
 1.61550902e+12 5.90998306e+10 2.71122912e+11 2.13725470e+11
 1.28814828e+11 5.01867614e+10 2.45913740e+11 1.26884452e+10
 2.98044457e+10 4.48670453e+10 2.40088563e+10 3.66525234e+10
 6.84724164e+09 8.36234174e+09 1.31297015e+10 4.46171582e+10
 2.58624526e+09 4.29382761e+10 6.75425569e+10 2.77307049e+11
 1.47307968e+11 4.29638091e+10 3.55871491e+10 3.42871622e+10
 1.04598127e+11 3.24871457e+10 1.41798040e+11 1.02165755e+11
 4.57179453e+10 3.48609779e+10 2.70123475e+10 4.27667488e+10
 7.14254483e+10 8.27931529e+11 5.24641425e+11 5.46602191e+10
 5.03981732e+10 3.75805731e+10 3.02575395e+11 1.82739192e+10
 1.89688806e+10 1.09145453e+11 2.26876865e+11 5.53239890e+10
 3.27961314e+10 1.66219117e+11 1.86264521e+11 1.85850686e+11
 7.88840972e+10 3.05665988e+10 2.61732173e+11 2.31469632e+10
 4.73817731e+12 1.88078414e+11 3.63362973e+10 5.32640927e+10
 1.62312630e+11 4.14195054e+10 2.45954709e+10 1.94338112e+10
 2.69393318e+10 1.15069803e+11 4.10137959e+10 6.38091182e+10
 5.86247092e+10 5.99515541e+10 1.56249984e+11 3.18647210e+10
 1.19462025e+10 5.12672449e+10 1.04965244e+09 3.64877696e+11
 1.20899579e+11 2.03767611e+10 1.38309972e+11 5.34745988e+10
 1.13986917e+11 2.63413117e+09 1.38921555e+11 4.65261301e+09
 1.13194525e+10 4.85845280e+10 4.58955168e+08 1.48792293e+11
 3.08147376e+10 9.00411584e+10 1.94118690e+08 5.01669085e+11
 7.12418233e+10 8.36946278e+09 8.85059171e+11 1.10757844e+12
 1.46484360e+11 1.00499715e+12 2.65877085e+10 5.35286796e+10
 1.42483647e+11 1.95312480e+11 1.09145453e+11 2.70106065e+10
 1.56148130e+10 7.49511642e+10 1.04186110e+11 8.70798507e+10
 1.35839779e+11 2.22566954e+10 5.42856880e+09 2.32806216e+09
 8.73295937e+09 2.08888470e+11 1.46221929e+11 1.06019804e+12
 1.02314125e+11 4.47811211e+11 5.81766910e+10 7.05155912e+10
 2.88762834e+10 7.65797014e+10 9.43116287e+09 5.46280402e+09
 2.67009286e+08 5.87706287e+10 3.79364496e+10 2.47627477e+10
 1.00996989e+11 1.97454445e+11 2.62369052e+10 2.04356285e+10
 1.40080171e+11 3.79364496e+10 3.18884203e+09 2.01204998e+11
 2.13725470e+11 3.03999853e+09 2.05030472e+10 4.18821383e+11
 1.46610094e+11 6.59845364e+10 9.86372088e+10 9.57960079e+09
 1.01325179e+09 8.25377285e+10 2.70123475e+10 1.39929956e+10
 1.09256080e+10 5.06122399e+11 2.70094395e+10 2.90391696e+11
 2.84066641e+11 2.52146163e+11 1.91132107e+10 2.88973959e+10
 1.30219966e+11 2.88653252e+10 6.23467358e+11 7.00245793e+10
 8.45752386e+09 6.00377323e+10 7.89817780e+10 9.55696199e+09
 8.64395120e+10 6.72855410e+10 5.82733409e+09 1.23465963e+10
 4.04089976e+10 1.29882799e+11 1.82988768e+11 2.66589673e+10
 4.29832230e+10 3.07865194e+08 1.60270727e+11 5.64271484e+10
 5.10233231e+10 2.80989892e+10 7.55018410e+10 1.16708458e+10
 9.71690559e+10 1.30994391e+10 5.66044707e+08 2.62320713e+11
 3.01866176e+11 2.72850609e+11 4.61386567e+10 1.53065670e+12
 2.53369283e+10 5.53083515e+10 4.65545136e+10 7.17250033e+10
 8.36234174e+09 1.63702600e+11 7.47626000e+08 3.28110367e+10
 9.89996158e+11 8.61289714e+09 2.10690198e+11 6.99747313e+09
 4.47811211e+11 1.21803553e+10]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[6.87012418e+10 2.19111733e+09 8.93140605e+09 3.85017111e+10
 1.05653162e+11 1.34942601e+11 1.14864720e+11 2.63258207e+10
 1.46391015e+11 5.23693616e+10 1.17269450e+10 9.05862461e+11
 1.27427138e+12 6.26342885e+10 4.71616460e+09 8.36742562e+09
 8.70260051e+11 3.24506139e+11 1.38866967e+08 8.93140605e+09
 2.74816101e+10 4.42162127e+10 4.73444401e+11 2.45725649e+10
 3.81898919e+11 4.13780603e+09 6.87012418e+10 6.73313262e+10
 4.14195054e+10 4.67555335e+11 8.18512999e+10 1.06759176e+11
 5.97380850e+10 1.39953941e+10 5.31876983e+09 9.82215598e+10
 1.10297267e+12 3.28415437e+11 1.65817131e+11 1.58939861e+10
 4.16353407e+10 1.28216582e+11 2.04628250e+11 3.02802477e+10
 5.12672449e+09 4.71616460e+10 8.75036403e+09 5.05078591e+10
 4.37281753e+10 8.01647249e+09 1.11241402e+11 1.06885962e+11
 5.29572072e+10 1.19185993e+10 4.43031378e+11 2.69974102e+10
 1.74659187e+10 1.21354257e+11 1.84470922e+10 6.00911174e+09
 2.80448774e+11 7.01544823e+09 5.67192161e+11 1.45885572e+10
 9.55703532e+11 6.09962561e+10 2.71758738e+11 3.04786302e+10
 8.74521503e+10 6.07306599e+10 3.27961314e+10 1.43127587e+11
 1.86014217e+10 4.74205620e+10 2.35585623e+10 2.03023702e+11
 1.80725766e+09 2.96790906e+08 2.13664276e+10 1.31053679e+10
 4.29382761e+10 9.31785232e+11 1.22879162e+10 3.45230231e+11
 3.80982878e+10 3.00507613e+11 4.05978574e+11 2.88185385e+11
 4.00676818e+11 2.92338785e+10 7.82940217e+09 1.69003198e+08
 2.90508149e+10 5.67192161e+11 1.37283564e+11 1.96448310e+11
 1.00089583e+11 1.74281637e+10 2.53100517e+09 9.78959957e+10
 7.61766503e+10 2.58323213e+08 1.66632259e+08 4.05978574e+11
 2.11080063e+11 2.28658519e+10 1.46391015e+11 2.74179486e+11
 2.43300575e+10 1.45254074e+10 1.42483647e+11 3.73436926e+10
 1.80725766e+09 4.78664849e+10 7.73839611e+11 3.06674727e+10
 7.36661699e+10 2.08888470e+11 2.92955297e+09 3.82941390e+11
 9.31785232e+11 6.88102367e+09 2.39491906e+11 1.63817099e+10
 8.73898238e+10 1.87999623e+11 9.50372196e+10 1.19686263e+11
 1.78053563e+10 9.79294597e+09 1.18324313e+10 1.42483647e+11
 2.13664276e+10 6.34285968e+11 1.17859528e+10 5.03981732e+10
 4.51151755e+10 6.13375457e+11 3.03047155e+10 2.32050524e+09
 9.63713079e+10 1.55989012e+11 2.92338785e+10 1.36718736e+11
 7.48223323e+10 5.16144867e+11 2.96062576e+10 1.70000380e+11
 1.46610094e+11 2.02695426e+10 2.93173626e+10 1.99748530e+11
 3.35065395e+10 1.62258208e+11 1.69203884e+11 1.13828318e+11
 9.42951887e+10 9.00364299e+10 6.00377323e+10 1.57963556e+11
 1.05437898e+11 1.58553866e+11 8.73898238e+10 3.10124586e+08
 4.13780603e+09 3.46658231e+10 2.48116834e+11 7.64035453e+10
 1.11990130e+11 8.19420603e+09 2.02526798e+11 1.13954481e+11
 4.77848099e+09 1.00996989e+11 2.84233139e+10 3.33201962e+10
 2.39654224e+09 3.47584892e+10 3.95016063e+10 1.32454044e+10
 4.80695357e+11 3.45409194e+11 6.15448624e+10 4.87970048e+10
 9.14266472e+09 1.01501974e+11 8.74048643e+09 1.45098382e+11
 1.27226015e+10 1.48437485e+11 4.43242807e+08 1.13081099e+10
 4.92012320e+11 3.10440869e+11 3.49888188e+11 1.43127587e+11
 1.42033320e+12 3.48433268e+10 6.07999706e+09 5.20810560e+10
 1.95312480e+11 1.82599505e+10 1.94461663e+09 4.70103941e+10
 3.69930658e+09 1.73643517e+11 7.21187713e+10 2.70664788e+11
 2.27267045e+10 2.36831690e+11 2.27973835e+11 1.06574260e+11
 5.54850837e+11 7.15415631e+10 6.32971123e+09 6.39780314e+10
 2.76841402e+11 1.39334540e+11 7.29547486e+08 2.09894934e+10
 9.57960079e+09 9.58954833e+10 5.01879404e+11 4.65524146e+09
 3.64330554e+10 6.87012418e+10 3.57623498e+10 6.87420946e+10
 1.42483647e+11 1.63817099e+10 1.02893174e+11 5.83014336e+10
 1.16160305e+11 3.61497216e+11 7.09945878e+09 3.27405199e+10
 6.28773075e+09 1.17856685e+12 2.02600034e+10 9.00411584e+10
 8.39580410e+10 1.08776966e+11 1.39856018e+10 2.66589673e+10
 2.55445356e+10 1.60270727e+11 1.17525985e+11 1.57193269e+10
 2.32494355e+10 1.84695055e+11 3.55652145e+10 1.13986917e+11
 4.12106827e+11 3.05811372e+10 1.00996989e+11 2.06409970e+10
 7.19588681e+10 3.60568466e+09 1.13465773e+11 5.58781900e+10
 2.97770853e+10 7.76798434e+10 3.69390111e+11 1.19032094e+11
 2.76777223e+11 1.22438711e+10 1.76558151e+11 3.95783846e+09
 2.86479550e+10 1.20077244e+12 5.10917832e+10 3.05033556e+10
 3.10999467e+11 4.27450940e+10 7.27897158e+11 3.19935454e+10
 1.06759176e+11 3.02691057e+10 7.58386692e+10 6.06741469e+09
 4.10137959e+10 1.24664338e+11 4.99413803e+11 5.99369620e+11
 5.17401448e+11 3.24255544e+11 2.28658519e+10 2.62369052e+10
 4.94786846e+11 3.47703722e+11 1.29776656e+12 2.62368667e+10
 2.10618408e+10 2.98731759e+10 3.40359181e+10 8.41218683e+11
 1.45753584e+11 1.30962080e+11 7.78131221e+09 1.50933088e+11
 7.56438488e+11 8.28899274e+09 2.45350183e+11 2.39654224e+09
 6.13375457e+11 5.05112471e+10 1.78563621e+11 2.88762834e+10
 1.00713240e+11 2.10169553e+11 2.89197773e+11 2.85824726e+09
 1.02175625e+10 7.23793145e+10 1.56148130e+10 3.53909718e+10
 2.51400640e+11 2.80473772e+11 2.80989892e+10 7.26270372e+09
 5.24712902e+10 4.29832230e+10 8.16691592e+11 2.75507550e+11
 7.51012377e+08 6.81650715e+10 6.60301828e+10 8.90033121e+11
 6.91232568e+10 5.06122399e+11 1.95571674e+09 8.38869852e+11
 4.71616460e+10 7.45558231e+10 2.10074507e+11 1.09712408e+11
 1.97840007e+10 1.34431157e+10 1.16602867e+11 5.03981732e+10
 4.57611879e+10 8.42597279e+11 3.51862226e+10 2.09894934e+10
 4.90579928e+10 1.47756044e+11 8.67214629e+10 8.87432348e+09
 2.56240939e+11 2.11029340e+11 4.28840945e+10 5.56194432e+10
 1.63702600e+11 2.02438441e+11 7.22434897e+10 6.77325871e+09
 1.06809785e+11 6.59625198e+11 7.25491908e+10 2.25713397e+10
 2.32027088e+11 1.17187488e+11 3.01954154e+11 2.32986947e+11
 2.61738931e+10 9.92586282e+11 1.02907549e+11 1.61550902e+12
 3.49315904e+10 2.69394517e+10 2.23299372e+10 8.25424922e+09
 1.70980376e+11 2.11029340e+11 6.27840100e+10 1.95312480e+11
 3.07603469e+10 4.06496546e+11 1.74235018e+11 1.47435389e+10
 7.81733384e+10 1.01620853e+11 5.10917832e+10 1.18447611e+11
 1.60102992e+11 1.97660847e+10 4.74441241e+09 2.30813341e+11
 4.29503671e+10 4.37281753e+09 2.53988585e+10 3.35514841e+09
 1.12776995e+11 1.08037758e+10 4.29316802e+10 9.43116287e+09
 1.67739704e+11 6.94574067e+10 6.65260537e+10 6.51343378e+10
 2.81898203e+10 9.12194241e+10 2.04628250e+11 3.61585003e+11
 3.53961377e+09 5.48050024e+10 3.90416994e+11 4.69757164e+10
 6.82584153e+09 6.56708921e+09 2.12962229e+10 4.27142736e+10
 2.11306323e+11 1.42032904e+10 2.33870808e+11 1.84363580e+11
 6.76815535e+10 1.79922490e+11 8.54901880e+10 2.47320019e+10
 1.45753584e+11 3.77791306e+11 2.84885701e+10 6.89019842e+10
 6.18311176e+10 6.97944310e+10 2.53243224e+09 5.28265808e+11
 1.66632259e+08 2.62320713e+11 5.83014336e+10 5.10233231e+10
 1.58375661e+09 3.29266397e+09 1.00996989e+11 2.29550732e+11
 2.13898395e+10 5.93982623e+10 1.38412898e+10 3.35895647e+10
 8.56855060e+10 2.56678074e+10 2.82885625e+09 1.69712662e+11
 1.55820125e+11 2.45725649e+10 8.36115142e+11 1.51828831e+11
 7.68480438e+11 3.48609779e+10 1.07415218e+11 1.27427138e+12
 1.99742974e+11 2.54083894e+11 1.73518664e+11 5.47045542e+10
 6.54810399e+10 7.49120704e+11 2.88728882e+10 8.46187094e+10
 8.15109303e+10 4.41365977e+09 7.57124524e+10 1.84108335e+11
 5.37290288e+10 4.09542748e+10 5.86347251e+09 7.89817780e+10
 1.25044776e+10 1.10574489e+11 9.12194241e+10 1.61550902e+12
 5.90998306e+10 2.71122912e+11 2.13725470e+11 1.28814828e+11
 5.01867614e+10 2.45913740e+11 1.26884452e+10 2.98044457e+10
 4.48670453e+10 2.40088563e+10 6.84724164e+09 8.36234174e+09
 1.31297015e+10 4.46171582e+10 2.58624526e+09 4.29382761e+10
 6.75425569e+10 2.77307049e+11 1.47307968e+11 4.29638091e+10
 3.55871491e+10 1.04598127e+11 3.24871457e+10 1.41798040e+11
 1.02165755e+11 4.57179453e+10 3.48609779e+10 2.70123475e+10
 4.27667488e+10 7.14254483e+10 8.27931529e+11 5.24641425e+11
 5.46602191e+10 5.03981732e+10 3.75805731e+10 3.02575395e+11
 1.82739192e+10 1.89688806e+10 1.09145453e+11 2.26876865e+11
 5.53239890e+10 3.27961314e+10 1.66219117e+11 1.85850686e+11
 7.88840972e+10 3.05665988e+10 2.61732173e+11 2.31469632e+10
 4.73817731e+12 3.63362973e+10 1.62312630e+11 4.14195054e+10
 2.45954709e+10 1.94338112e+10 2.69393318e+10 1.15069803e+11
 4.10137959e+10 6.38091182e+10 5.86247092e+10 5.99515541e+10
 1.56249984e+11 3.18647210e+10 1.19462025e+10 5.12672449e+10
 1.04965244e+09 3.64877696e+11 1.20899579e+11 2.03767611e+10
 1.38309972e+11 5.34745988e+10 1.13986917e+11 2.63413117e+09
 1.38921555e+11 4.65261301e+09 1.13194525e+10 4.85845280e+10
 4.58955168e+08 1.48792293e+11 3.08147376e+10 9.00411584e+10
 1.94118690e+08 5.01669085e+11 8.36946278e+09 8.85059171e+11
 1.10757844e+12 1.00499715e+12 2.65877085e+10 5.35286796e+10
 1.42483647e+11 1.95312480e+11 1.09145453e+11 2.70106065e+10
 1.56148130e+10 7.49511642e+10 1.04186110e+11 8.70798507e+10
 1.35839779e+11 2.22566954e+10 2.32806216e+09 8.73295937e+09
 2.08888470e+11 1.46221929e+11 1.06019804e+12 1.02314125e+11
 4.47811211e+11 5.81766910e+10 7.05155912e+10 2.88762834e+10
 7.65797014e+10 9.43116287e+09 5.46280402e+09 2.67009286e+08
 5.87706287e+10 3.79364496e+10 2.47627477e+10 1.00996989e+11
 1.97454445e+11 2.62369052e+10 2.04356285e+10 1.40080171e+11
 3.79364496e+10 3.18884203e+09 2.01204998e+11 2.13725470e+11
 3.03999853e+09 2.05030472e+10 4.18821383e+11 1.46610094e+11
 6.59845364e+10 9.86372088e+10 9.57960079e+09 1.01325179e+09
 8.25377285e+10 2.70123475e+10 1.39929956e+10 1.09256080e+10
 5.06122399e+11 2.70094395e+10 2.90391696e+11 2.84066641e+11
 2.52146163e+11 1.91132107e+10 2.88973959e+10 6.23467358e+11
 7.00245793e+10 8.45752386e+09 6.00377323e+10 7.89817780e+10
 9.55696199e+09 8.64395120e+10 6.72855410e+10 5.82733409e+09
 1.23465963e+10 4.04089976e+10 1.29882799e+11 1.82988768e+11
 2.66589673e+10 4.29832230e+10 1.60270727e+11 5.64271484e+10
 5.10233231e+10 2.80989892e+10 7.55018410e+10 9.71690559e+10
 1.30994391e+10 5.66044707e+08 2.72850609e+11 4.61386567e+10
 1.53065670e+12 2.53369283e+10 5.53083515e+10 4.65545136e+10
 7.17250033e+10 8.36234174e+09 1.63702600e+11 7.47626000e+08
 3.28110367e+10 9.89996158e+11 2.10690198e+11 4.47811211e+11
 1.21803553e+10]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[6.87012418e+10 2.19111733e+09 8.93140605e+09 3.85017111e+10
 1.05653162e+11 1.34942601e+11 1.14864720e+11 2.63258207e+10
 1.46391015e+11 5.23693616e+10 1.17269450e+10 9.05862461e+11
 1.27427138e+12 6.26342885e+10 4.71616460e+09 8.36742562e+09
 8.70260051e+11 3.24506139e+11 1.38866967e+08 8.93140605e+09
 2.74816101e+10 4.42162127e+10 4.73444401e+11 2.45725649e+10
 3.81898919e+11 4.13780603e+09 6.87012418e+10 6.73313262e+10
 4.14195054e+10 4.67555335e+11 8.18512999e+10 1.06759176e+11
 5.97380850e+10 1.39953941e+10 5.31876983e+09 9.82215598e+10
 1.10297267e+12 3.28415437e+11 1.65817131e+11 1.58939861e+10
 4.16353407e+10 1.28216582e+11 2.04628250e+11 4.71616460e+10
 8.75036403e+09 5.05078591e+10 4.37281753e+10 8.01647249e+09
 1.11241402e+11 1.06885962e+11 5.29572072e+10 1.19185993e+10
 4.43031378e+11 2.69974102e+10 1.74659187e+10 1.84470922e+10
 2.80448774e+11 7.01544823e+09 5.67192161e+11 1.45885572e+10
 9.55703532e+11 6.09962561e+10 2.71758738e+11 3.04786302e+10
 8.74521503e+10 6.07306599e+10 3.27961314e+10 1.43127587e+11
 1.86014217e+10 4.74205620e+10 2.35585623e+10 2.03023702e+11
 2.96790906e+08 2.13664276e+10 4.29382761e+10 9.31785232e+11
 1.22879162e+10 3.45230231e+11 3.80982878e+10 3.00507613e+11
 4.05978574e+11 2.88185385e+11 4.00676818e+11 2.92338785e+10
 7.82940217e+09 1.69003198e+08 2.90508149e+10 5.67192161e+11
 1.37283564e+11 1.96448310e+11 1.00089583e+11 1.74281637e+10
 2.53100517e+09 7.61766503e+10 2.58323213e+08 4.05978574e+11
 2.11080063e+11 2.28658519e+10 1.46391015e+11 2.74179486e+11
 2.43300575e+10 1.45254074e+10 4.78664849e+10 7.73839611e+11
 3.06674727e+10 7.36661699e+10 2.08888470e+11 3.82941390e+11
 9.31785232e+11 6.88102367e+09 2.39491906e+11 1.63817099e+10
 8.73898238e+10 1.87999623e+11 9.50372196e+10 1.19686263e+11
 1.78053563e+10 9.79294597e+09 1.18324313e+10 1.42483647e+11
 2.13664276e+10 6.34285968e+11 1.17859528e+10 5.03981732e+10
 4.51151755e+10 6.13375457e+11 3.03047155e+10 2.32050524e+09
 9.63713079e+10 1.55989012e+11 2.92338785e+10 1.36718736e+11
 7.48223323e+10 5.16144867e+11 2.96062576e+10 1.70000380e+11
 1.46610094e+11 2.02695426e+10 2.93173626e+10 1.99748530e+11
 3.35065395e+10 1.62258208e+11 1.69203884e+11 1.13828318e+11
 9.42951887e+10 9.00364299e+10 6.00377323e+10 1.57963556e+11
 1.05437898e+11 1.58553866e+11 8.73898238e+10 3.10124586e+08
 4.13780603e+09 3.46658231e+10 2.48116834e+11 7.64035453e+10
 1.11990130e+11 8.19420603e+09 2.02526798e+11 1.13954481e+11
 4.77848099e+09 1.00996989e+11 2.84233139e+10 3.33201962e+10
 2.39654224e+09 3.47584892e+10 3.95016063e+10 1.32454044e+10
 4.80695357e+11 3.45409194e+11 4.87970048e+10 9.14266472e+09
 1.01501974e+11 8.74048643e+09 1.27226015e+10 1.48437485e+11
 4.43242807e+08 1.13081099e+10 4.92012320e+11 3.10440869e+11
 3.49888188e+11 1.43127587e+11 1.42033320e+12 3.48433268e+10
 6.07999706e+09 1.95312480e+11 1.94461663e+09 4.70103941e+10
 1.73643517e+11 7.21187713e+10 2.70664788e+11 2.27267045e+10
 2.36831690e+11 2.27973835e+11 1.06574260e+11 5.54850837e+11
 7.15415631e+10 6.39780314e+10 2.76841402e+11 1.39334540e+11
 7.29547486e+08 9.57960079e+09 9.58954833e+10 4.65524146e+09
 6.87012418e+10 3.57623498e+10 6.87420946e+10 1.42483647e+11
 1.63817099e+10 1.02893174e+11 5.83014336e+10 1.16160305e+11
 3.61497216e+11 7.09945878e+09 3.27405199e+10 6.28773075e+09
 1.17856685e+12 2.02600034e+10 9.00411584e+10 8.39580410e+10
 1.08776966e+11 1.39856018e+10 2.66589673e+10 2.55445356e+10
 1.60270727e+11 1.17525985e+11 1.57193269e+10 2.32494355e+10
 1.84695055e+11 3.55652145e+10 1.13986917e+11 4.12106827e+11
 3.05811372e+10 1.00996989e+11 2.06409970e+10 7.19588681e+10
 3.60568466e+09 1.13465773e+11 5.58781900e+10 2.97770853e+10
 7.76798434e+10 3.69390111e+11 1.19032094e+11 2.76777223e+11
 1.22438711e+10 1.76558151e+11 3.95783846e+09 2.86479550e+10
 1.20077244e+12 5.10917832e+10 3.05033556e+10 3.10999467e+11
 4.27450940e+10 7.27897158e+11 3.19935454e+10 1.06759176e+11
 3.02691057e+10 6.06741469e+09 4.10137959e+10 1.24664338e+11
 4.99413803e+11 5.99369620e+11 5.17401448e+11 3.24255544e+11
 2.28658519e+10 2.62369052e+10 4.94786846e+11 3.47703722e+11
 1.29776656e+12 2.62368667e+10 2.10618408e+10 2.98731759e+10
 3.40359181e+10 8.41218683e+11 1.45753584e+11 1.30962080e+11
 7.78131221e+09 7.56438488e+11 8.28899274e+09 2.45350183e+11
 2.39654224e+09 6.13375457e+11 5.05112471e+10 1.78563621e+11
 2.88762834e+10 1.00713240e+11 2.10169553e+11 2.89197773e+11
 1.02175625e+10 1.56148130e+10 3.53909718e+10 2.51400640e+11
 2.80473772e+11 2.80989892e+10 7.26270372e+09 5.24712902e+10
 4.29832230e+10 8.16691592e+11 2.75507550e+11 7.51012377e+08
 6.81650715e+10 6.60301828e+10 8.90033121e+11 6.91232568e+10
 5.06122399e+11 1.95571674e+09 8.38869852e+11 4.71616460e+10
 7.45558231e+10 2.10074507e+11 1.09712408e+11 1.97840007e+10
 1.34431157e+10 1.16602867e+11 5.03981732e+10 8.42597279e+11
 3.51862226e+10 2.09894934e+10 4.90579928e+10 1.47756044e+11
 8.67214629e+10 2.56240939e+11 2.11029340e+11 4.28840945e+10
 5.56194432e+10 2.02438441e+11 7.22434897e+10 6.77325871e+09
 1.06809785e+11 6.59625198e+11 7.25491908e+10 2.25713397e+10
 2.32027088e+11 1.17187488e+11 3.01954154e+11 2.32986947e+11
 2.61738931e+10 9.92586282e+11 1.02907549e+11 1.61550902e+12
 3.49315904e+10 2.69394517e+10 2.23299372e+10 8.25424922e+09
 1.70980376e+11 2.11029340e+11 6.27840100e+10 1.95312480e+11
 3.07603469e+10 4.06496546e+11 1.74235018e+11 1.47435389e+10
 7.81733384e+10 1.01620853e+11 5.10917832e+10 1.18447611e+11
 1.60102992e+11 1.97660847e+10 4.74441241e+09 2.30813341e+11
 4.29503671e+10 4.37281753e+09 2.53988585e+10 3.35514841e+09
 1.12776995e+11 1.08037758e+10 4.29316802e+10 9.43116287e+09
 1.67739704e+11 6.94574067e+10 6.65260537e+10 6.51343378e+10
 9.12194241e+10 2.04628250e+11 3.61585003e+11 3.53961377e+09
 3.90416994e+11 6.56708921e+09 4.27142736e+10 2.11306323e+11
 1.42032904e+10 2.33870808e+11 1.84363580e+11 6.76815535e+10
 1.79922490e+11 2.47320019e+10 1.45753584e+11 3.77791306e+11
 2.84885701e+10 6.89019842e+10 6.18311176e+10 6.97944310e+10
 2.53243224e+09 5.28265808e+11 2.62320713e+11 5.83014336e+10
 5.10233231e+10 1.58375661e+09 3.29266397e+09 1.00996989e+11
 2.29550732e+11 2.13898395e+10 5.93982623e+10 1.38412898e+10
 3.35895647e+10 8.56855060e+10 2.56678074e+10 2.82885625e+09
 1.69712662e+11 1.55820125e+11 8.36115142e+11 1.51828831e+11
 7.68480438e+11 1.07415218e+11 1.27427138e+12 1.99742974e+11
 2.54083894e+11 5.47045542e+10 6.54810399e+10 7.49120704e+11
 2.88728882e+10 8.46187094e+10 8.15109303e+10 4.41365977e+09
 7.57124524e+10 1.84108335e+11 5.37290288e+10 4.09542748e+10
 5.86347251e+09 7.89817780e+10 1.25044776e+10 1.10574489e+11
 9.12194241e+10 1.61550902e+12 5.90998306e+10 2.71122912e+11
 2.13725470e+11 1.28814828e+11 5.01867614e+10 2.45913740e+11
 1.26884452e+10 2.98044457e+10 4.48670453e+10 2.40088563e+10
 6.84724164e+09 8.36234174e+09 1.31297015e+10 4.46171582e+10
 2.58624526e+09 4.29382761e+10 6.75425569e+10 2.77307049e+11
 1.47307968e+11 4.29638091e+10 3.55871491e+10 1.04598127e+11
 3.24871457e+10 1.41798040e+11 1.02165755e+11 4.57179453e+10
 2.70123475e+10 4.27667488e+10 7.14254483e+10 8.27931529e+11
 5.24641425e+11 5.46602191e+10 5.03981732e+10 3.75805731e+10
 3.02575395e+11 1.89688806e+10 2.26876865e+11 5.53239890e+10
 3.27961314e+10 1.66219117e+11 1.85850686e+11 7.88840972e+10
 3.05665988e+10 2.61732173e+11 2.31469632e+10 4.73817731e+12
 3.63362973e+10 1.62312630e+11 4.14195054e+10 2.45954709e+10
 1.94338112e+10 2.69393318e+10 1.15069803e+11 4.10137959e+10
 6.38091182e+10 5.86247092e+10 5.99515541e+10 1.56249984e+11
 3.18647210e+10 1.19462025e+10 5.12672449e+10 1.04965244e+09
 3.64877696e+11 1.20899579e+11 2.03767611e+10 1.38309972e+11
 5.34745988e+10 1.13986917e+11 2.63413117e+09 1.38921555e+11
 4.65261301e+09 4.85845280e+10 4.58955168e+08 1.48792293e+11
 3.08147376e+10 9.00411584e+10 1.94118690e+08 5.01669085e+11
 8.36946278e+09 1.10757844e+12 1.00499715e+12 2.65877085e+10
 5.35286796e+10 1.95312480e+11 1.56148130e+10 7.49511642e+10
 1.04186110e+11 8.70798507e+10 1.35839779e+11 2.22566954e+10
 2.32806216e+09 8.73295937e+09 2.08888470e+11 1.46221929e+11
 1.06019804e+12 1.02314125e+11 4.47811211e+11 5.81766910e+10
 7.05155912e+10 2.88762834e+10 7.65797014e+10 9.43116287e+09
 5.46280402e+09 2.67009286e+08 5.87706287e+10 3.79364496e+10
 1.97454445e+11 2.62369052e+10 2.04356285e+10 1.40080171e+11
 3.79364496e+10 3.18884203e+09 2.01204998e+11 2.13725470e+11
 3.03999853e+09 2.05030472e+10 4.18821383e+11 1.46610094e+11
 6.59845364e+10 9.86372088e+10 9.57960079e+09 1.01325179e+09
 8.25377285e+10 2.70123475e+10 1.39929956e+10 1.09256080e+10
 5.06122399e+11 2.70094395e+10 2.90391696e+11 2.84066641e+11
 2.52146163e+11 1.91132107e+10 2.88973959e+10 6.23467358e+11
 7.00245793e+10 8.45752386e+09 6.00377323e+10 7.89817780e+10
 9.55696199e+09 8.64395120e+10 6.72855410e+10 5.82733409e+09
 1.23465963e+10 4.04089976e+10 1.29882799e+11 1.82988768e+11
 2.66589673e+10 4.29832230e+10 1.60270727e+11 5.64271484e+10
 5.10233231e+10 2.80989892e+10 7.55018410e+10 9.71690559e+10
 1.30994391e+10 5.66044707e+08 2.72850609e+11 4.61386567e+10
 2.53369283e+10 5.53083515e+10 4.65545136e+10 7.17250033e+10
 8.36234174e+09 1.63702600e+11 7.47626000e+08 9.89996158e+11
 2.10690198e+11 4.47811211e+11 1.21803553e+10]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[6.87012418e+10 2.19111733e+09 8.93140605e+09 3.85017111e+10
 1.05653162e+11 1.34942601e+11 2.63258207e+10 1.46391015e+11
 5.23693616e+10 1.17269450e+10 9.05862461e+11 1.27427138e+12
 6.26342885e+10 4.71616460e+09 8.36742562e+09 8.70260051e+11
 3.24506139e+11 1.38866967e+08 8.93140605e+09 2.74816101e+10
 4.42162127e+10 4.73444401e+11 2.45725649e+10 3.81898919e+11
 4.13780603e+09 6.87012418e+10 6.73313262e+10 4.14195054e+10
 4.67555335e+11 8.18512999e+10 1.06759176e+11 5.97380850e+10
 1.39953941e+10 5.31876983e+09 9.82215598e+10 1.10297267e+12
 3.28415437e+11 1.65817131e+11 1.58939861e+10 4.16353407e+10
 2.04628250e+11 4.71616460e+10 8.75036403e+09 5.05078591e+10
 8.01647249e+09 1.11241402e+11 1.06885962e+11 5.29572072e+10
 1.19185993e+10 4.43031378e+11 2.69974102e+10 1.74659187e+10
 1.84470922e+10 2.80448774e+11 7.01544823e+09 5.67192161e+11
 1.45885572e+10 9.55703532e+11 6.09962561e+10 2.71758738e+11
 3.04786302e+10 3.27961314e+10 1.43127587e+11 1.86014217e+10
 4.74205620e+10 2.03023702e+11 2.96790906e+08 2.13664276e+10
 4.29382761e+10 9.31785232e+11 1.22879162e+10 3.45230231e+11
 3.80982878e+10 3.00507613e+11 4.05978574e+11 2.88185385e+11
 4.00676818e+11 2.92338785e+10 7.82940217e+09 1.69003198e+08
 2.90508149e+10 5.67192161e+11 1.37283564e+11 1.96448310e+11
 1.00089583e+11 1.74281637e+10 2.53100517e+09 7.61766503e+10
 2.58323213e+08 4.05978574e+11 2.11080063e+11 2.28658519e+10
 1.46391015e+11 2.74179486e+11 2.43300575e+10 1.45254074e+10
 7.73839611e+11 7.36661699e+10 2.08888470e+11 3.82941390e+11
 9.31785232e+11 6.88102367e+09 2.39491906e+11 1.63817099e+10
 1.87999623e+11 9.50372196e+10 1.19686263e+11 1.78053563e+10
 9.79294597e+09 1.18324313e+10 1.42483647e+11 6.34285968e+11
 1.17859528e+10 5.03981732e+10 4.51151755e+10 6.13375457e+11
 3.03047155e+10 9.63713079e+10 1.55989012e+11 2.92338785e+10
 1.36718736e+11 7.48223323e+10 5.16144867e+11 2.96062576e+10
 1.70000380e+11 1.46610094e+11 2.02695426e+10 2.93173626e+10
 1.99748530e+11 3.35065395e+10 1.62258208e+11 1.69203884e+11
 1.13828318e+11 9.42951887e+10 9.00364299e+10 1.05437898e+11
 1.58553866e+11 8.73898238e+10 3.10124586e+08 4.13780603e+09
 3.46658231e+10 7.64035453e+10 1.11990130e+11 8.19420603e+09
 2.02526798e+11 1.13954481e+11 4.77848099e+09 1.00996989e+11
 2.84233139e+10 3.33201962e+10 2.39654224e+09 3.47584892e+10
 3.95016063e+10 1.32454044e+10 4.80695357e+11 3.45409194e+11
 9.14266472e+09 1.01501974e+11 8.74048643e+09 1.27226015e+10
 1.48437485e+11 4.43242807e+08 1.13081099e+10 4.92012320e+11
 3.10440869e+11 3.49888188e+11 1.43127587e+11 1.42033320e+12
 3.48433268e+10 6.07999706e+09 1.95312480e+11 1.94461663e+09
 4.70103941e+10 1.73643517e+11 7.21187713e+10 2.70664788e+11
 2.27267045e+10 2.36831690e+11 2.27973835e+11 1.06574260e+11
 5.54850837e+11 7.15415631e+10 6.39780314e+10 1.39334540e+11
 7.29547486e+08 9.57960079e+09 9.58954833e+10 6.87012418e+10
 3.57623498e+10 6.87420946e+10 1.42483647e+11 1.63817099e+10
 1.02893174e+11 5.83014336e+10 1.16160305e+11 3.61497216e+11
 6.28773075e+09 1.17856685e+12 9.00411584e+10 8.39580410e+10
 1.08776966e+11 1.39856018e+10 2.66589673e+10 2.55445356e+10
 1.17525985e+11 1.57193269e+10 2.32494355e+10 1.84695055e+11
 3.55652145e+10 1.13986917e+11 4.12106827e+11 3.05811372e+10
 1.00996989e+11 7.19588681e+10 3.60568466e+09 1.13465773e+11
 5.58781900e+10 2.97770853e+10 7.76798434e+10 3.69390111e+11
 1.19032094e+11 2.76777223e+11 1.22438711e+10 1.76558151e+11
 3.95783846e+09 2.86479550e+10 1.20077244e+12 5.10917832e+10
 3.05033556e+10 3.10999467e+11 4.27450940e+10 7.27897158e+11
 3.19935454e+10 1.06759176e+11 3.02691057e+10 6.06741469e+09
 4.10137959e+10 1.24664338e+11 4.99413803e+11 5.99369620e+11
 3.24255544e+11 2.28658519e+10 2.62369052e+10 4.94786846e+11
 3.47703722e+11 1.29776656e+12 2.62368667e+10 2.10618408e+10
 2.98731759e+10 3.40359181e+10 8.41218683e+11 1.45753584e+11
 1.30962080e+11 7.56438488e+11 8.28899274e+09 2.45350183e+11
 2.39654224e+09 6.13375457e+11 5.05112471e+10 1.78563621e+11
 2.88762834e+10 1.00713240e+11 2.10169553e+11 2.89197773e+11
 1.02175625e+10 1.56148130e+10 3.53909718e+10 2.51400640e+11
 2.80473772e+11 2.80989892e+10 5.24712902e+10 4.29832230e+10
 8.16691592e+11 2.75507550e+11 7.51012377e+08 6.81650715e+10
 6.60301828e+10 8.90033121e+11 6.91232568e+10 5.06122399e+11
 1.95571674e+09 8.38869852e+11 4.71616460e+10 7.45558231e+10
 2.10074507e+11 1.97840007e+10 1.34431157e+10 5.03981732e+10
 8.42597279e+11 3.51862226e+10 2.09894934e+10 4.90579928e+10
 1.47756044e+11 8.67214629e+10 2.56240939e+11 2.11029340e+11
 4.28840945e+10 5.56194432e+10 2.02438441e+11 7.22434897e+10
 6.77325871e+09 6.59625198e+11 7.25491908e+10 2.25713397e+10
 2.32027088e+11 1.17187488e+11 3.01954154e+11 2.32986947e+11
 2.61738931e+10 9.92586282e+11 1.02907549e+11 1.61550902e+12
 3.49315904e+10 2.69394517e+10 2.23299372e+10 8.25424922e+09
 1.70980376e+11 2.11029340e+11 6.27840100e+10 1.95312480e+11
 3.07603469e+10 4.06496546e+11 1.74235018e+11 1.47435389e+10
 7.81733384e+10 1.01620853e+11 5.10917832e+10 1.18447611e+11
 1.60102992e+11 1.97660847e+10 4.74441241e+09 2.30813341e+11
 4.29503671e+10 4.37281753e+09 2.53988585e+10 1.12776995e+11
 1.08037758e+10 4.29316802e+10 9.43116287e+09 1.67739704e+11
 6.94574067e+10 6.65260537e+10 6.51343378e+10 9.12194241e+10
 2.04628250e+11 3.61585003e+11 3.53961377e+09 3.90416994e+11
 6.56708921e+09 4.27142736e+10 2.11306323e+11 2.33870808e+11
 1.84363580e+11 6.76815535e+10 1.79922490e+11 2.47320019e+10
 1.45753584e+11 3.77791306e+11 2.84885701e+10 6.89019842e+10
 6.18311176e+10 6.97944310e+10 2.53243224e+09 5.28265808e+11
 2.62320713e+11 5.83014336e+10 5.10233231e+10 1.58375661e+09
 3.29266397e+09 1.00996989e+11 2.29550732e+11 2.13898395e+10
 5.93982623e+10 1.38412898e+10 3.35895647e+10 8.56855060e+10
 2.56678074e+10 2.82885625e+09 1.69712662e+11 1.55820125e+11
 8.36115142e+11 1.51828831e+11 7.68480438e+11 1.07415218e+11
 1.27427138e+12 1.99742974e+11 2.54083894e+11 5.47045542e+10
 6.54810399e+10 7.49120704e+11 2.88728882e+10 8.46187094e+10
 4.41365977e+09 7.57124524e+10 1.84108335e+11 5.37290288e+10
 4.09542748e+10 5.86347251e+09 7.89817780e+10 1.25044776e+10
 1.10574489e+11 9.12194241e+10 1.61550902e+12 5.90998306e+10
 2.71122912e+11 2.13725470e+11 1.28814828e+11 5.01867614e+10
 2.45913740e+11 1.26884452e+10 2.98044457e+10 4.48670453e+10
 2.40088563e+10 8.36234174e+09 1.31297015e+10 4.46171582e+10
 2.58624526e+09 4.29382761e+10 6.75425569e+10 2.77307049e+11
 1.47307968e+11 4.29638091e+10 3.55871491e+10 1.04598127e+11
 3.24871457e+10 1.41798040e+11 1.02165755e+11 4.57179453e+10
 2.70123475e+10 4.27667488e+10 7.14254483e+10 8.27931529e+11
 5.24641425e+11 5.46602191e+10 5.03981732e+10 3.02575395e+11
 1.89688806e+10 2.26876865e+11 5.53239890e+10 3.27961314e+10
 1.66219117e+11 1.85850686e+11 7.88840972e+10 3.05665988e+10
 2.61732173e+11 2.31469632e+10 4.73817731e+12 3.63362973e+10
 1.62312630e+11 4.14195054e+10 2.45954709e+10 1.94338112e+10
 2.69393318e+10 1.15069803e+11 4.10137959e+10 5.86247092e+10
 5.99515541e+10 3.18647210e+10 1.19462025e+10 5.12672449e+10
 1.04965244e+09 3.64877696e+11 1.20899579e+11 2.03767611e+10
 1.38309972e+11 5.34745988e+10 1.13986917e+11 2.63413117e+09
 1.38921555e+11 4.65261301e+09 4.85845280e+10 4.58955168e+08
 1.48792293e+11 3.08147376e+10 9.00411584e+10 1.94118690e+08
 5.01669085e+11 8.36946278e+09 1.10757844e+12 1.00499715e+12
 2.65877085e+10 5.35286796e+10 1.95312480e+11 1.56148130e+10
 7.49511642e+10 1.04186110e+11 8.70798507e+10 1.35839779e+11
 2.22566954e+10 2.32806216e+09 8.73295937e+09 2.08888470e+11
 1.46221929e+11 1.06019804e+12 1.02314125e+11 4.47811211e+11
 7.05155912e+10 2.88762834e+10 7.65797014e+10 9.43116287e+09
 5.46280402e+09 2.67009286e+08 3.79364496e+10 1.97454445e+11
 2.62369052e+10 2.04356285e+10 1.40080171e+11 3.79364496e+10
 3.18884203e+09 2.01204998e+11 2.13725470e+11 3.03999853e+09
 2.05030472e+10 4.18821383e+11 1.46610094e+11 6.59845364e+10
 9.86372088e+10 9.57960079e+09 8.25377285e+10 2.70123475e+10
 1.39929956e+10 1.09256080e+10 5.06122399e+11 2.70094395e+10
 2.90391696e+11 2.84066641e+11 2.52146163e+11 1.91132107e+10
 2.88973959e+10 6.23467358e+11 7.00245793e+10 8.45752386e+09
 6.00377323e+10 7.89817780e+10 9.55696199e+09 8.64395120e+10
 6.72855410e+10 5.82733409e+09 1.23465963e+10 1.29882799e+11
 1.82988768e+11 4.29832230e+10 1.60270727e+11 5.64271484e+10
 5.10233231e+10 2.80989892e+10 9.71690559e+10 1.30994391e+10
 2.72850609e+11 4.61386567e+10 2.53369283e+10 5.53083515e+10
 4.65545136e+10 7.17250033e+10 8.36234174e+09 1.63702600e+11
 7.47626000e+08 9.89996158e+11 2.10690198e+11 4.47811211e+11
 1.21803553e+10]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[6.87012418e+10 2.19111733e+09 8.93140605e+09 3.85017111e+10
 1.05653162e+11 1.34942601e+11 2.63258207e+10 1.46391015e+11
 5.23693616e+10 1.17269450e+10 9.05862461e+11 1.27427138e+12
 6.26342885e+10 4.71616460e+09 8.36742562e+09 8.70260051e+11
 3.24506139e+11 8.93140605e+09 2.74816101e+10 4.42162127e+10
 4.73444401e+11 2.45725649e+10 3.81898919e+11 4.13780603e+09
 6.87012418e+10 6.73313262e+10 4.14195054e+10 4.67555335e+11
 8.18512999e+10 1.06759176e+11 5.97380850e+10 1.39953941e+10
 5.31876983e+09 9.82215598e+10 1.10297267e+12 3.28415437e+11
 1.65817131e+11 1.58939861e+10 4.16353407e+10 2.04628250e+11
 4.71616460e+10 8.75036403e+09 5.05078591e+10 8.01647249e+09
 1.11241402e+11 1.06885962e+11 5.29572072e+10 1.19185993e+10
 4.43031378e+11 2.69974102e+10 1.74659187e+10 1.84470922e+10
 2.80448774e+11 7.01544823e+09 5.67192161e+11 1.45885572e+10
 9.55703532e+11 6.09962561e+10 2.71758738e+11 3.04786302e+10
 3.27961314e+10 1.43127587e+11 1.86014217e+10 4.74205620e+10
 2.03023702e+11 2.96790906e+08 2.13664276e+10 4.29382761e+10
 9.31785232e+11 1.22879162e+10 3.45230231e+11 3.80982878e+10
 3.00507613e+11 4.05978574e+11 2.88185385e+11 4.00676818e+11
 2.92338785e+10 7.82940217e+09 1.69003198e+08 2.90508149e+10
 5.67192161e+11 1.37283564e+11 1.96448310e+11 1.00089583e+11
 1.74281637e+10 2.53100517e+09 7.61766503e+10 2.58323213e+08
 4.05978574e+11 2.11080063e+11 2.28658519e+10 1.46391015e+11
 2.74179486e+11 2.43300575e+10 1.45254074e+10 7.73839611e+11
 7.36661699e+10 2.08888470e+11 3.82941390e+11 9.31785232e+11
 6.88102367e+09 2.39491906e+11 1.63817099e+10 1.87999623e+11
 9.50372196e+10 1.19686263e+11 1.78053563e+10 9.79294597e+09
 1.18324313e+10 1.42483647e+11 6.34285968e+11 1.17859528e+10
 5.03981732e+10 4.51151755e+10 3.03047155e+10 9.63713079e+10
 2.92338785e+10 1.36718736e+11 5.16144867e+11 2.96062576e+10
 1.70000380e+11 1.46610094e+11 2.02695426e+10 2.93173626e+10
 1.99748530e+11 1.62258208e+11 1.69203884e+11 1.13828318e+11
 9.42951887e+10 9.00364299e+10 1.05437898e+11 1.58553866e+11
 8.73898238e+10 3.10124586e+08 4.13780603e+09 3.46658231e+10
 7.64035453e+10 1.11990130e+11 8.19420603e+09 4.77848099e+09
 1.00996989e+11 2.84233139e+10 3.33201962e+10 2.39654224e+09
 3.47584892e+10 3.95016063e+10 1.32454044e+10 4.80695357e+11
 3.45409194e+11 9.14266472e+09 1.01501974e+11 8.74048643e+09
 1.27226015e+10 1.48437485e+11 4.43242807e+08 1.13081099e+10
 4.92012320e+11 3.10440869e+11 3.49888188e+11 1.43127587e+11
 1.42033320e+12 3.48433268e+10 6.07999706e+09 1.95312480e+11
 1.94461663e+09 4.70103941e+10 1.73643517e+11 7.21187713e+10
 2.70664788e+11 2.27267045e+10 2.36831690e+11 2.27973835e+11
 1.06574260e+11 5.54850837e+11 7.15415631e+10 6.39780314e+10
 1.39334540e+11 7.29547486e+08 9.58954833e+10 6.87012418e+10
 3.57623498e+10 6.87420946e+10 1.42483647e+11 1.63817099e+10
 1.02893174e+11 5.83014336e+10 1.16160305e+11 3.61497216e+11
 6.28773075e+09 1.17856685e+12 9.00411584e+10 8.39580410e+10
 1.08776966e+11 1.39856018e+10 2.66589673e+10 1.17525985e+11
 1.57193269e+10 2.32494355e+10 1.84695055e+11 3.55652145e+10
 1.13986917e+11 4.12106827e+11 3.05811372e+10 1.00996989e+11
 7.19588681e+10 3.60568466e+09 1.13465773e+11 5.58781900e+10
 2.97770853e+10 7.76798434e+10 3.69390111e+11 2.76777223e+11
 1.22438711e+10 1.76558151e+11 3.95783846e+09 2.86479550e+10
 1.20077244e+12 5.10917832e+10 3.05033556e+10 3.10999467e+11
 4.27450940e+10 7.27897158e+11 3.19935454e+10 1.06759176e+11
 3.02691057e+10 6.06741469e+09 4.10137959e+10 1.24664338e+11
 4.99413803e+11 5.99369620e+11 3.24255544e+11 2.28658519e+10
 2.62369052e+10 4.94786846e+11 3.47703722e+11 1.29776656e+12
 2.62368667e+10 2.10618408e+10 2.98731759e+10 3.40359181e+10
 8.41218683e+11 1.45753584e+11 1.30962080e+11 7.56438488e+11
 8.28899274e+09 2.45350183e+11 2.39654224e+09 6.13375457e+11
 5.05112471e+10 1.78563621e+11 2.88762834e+10 2.10169553e+11
 2.89197773e+11 1.02175625e+10 1.56148130e+10 3.53909718e+10
 2.51400640e+11 2.80473772e+11 2.80989892e+10 5.24712902e+10
 4.29832230e+10 8.16691592e+11 2.75507550e+11 7.51012377e+08
 6.81650715e+10 6.60301828e+10 8.90033121e+11 6.91232568e+10
 5.06122399e+11 1.95571674e+09 8.38869852e+11 4.71616460e+10
 7.45558231e+10 2.10074507e+11 1.97840007e+10 1.34431157e+10
 5.03981732e+10 8.42597279e+11 3.51862226e+10 2.09894934e+10
 4.90579928e+10 1.47756044e+11 8.67214629e+10 2.56240939e+11
 2.11029340e+11 4.28840945e+10 5.56194432e+10 2.02438441e+11
 7.22434897e+10 6.77325871e+09 6.59625198e+11 7.25491908e+10
 2.25713397e+10 2.32027088e+11 1.17187488e+11 3.01954154e+11
 2.32986947e+11 2.61738931e+10 9.92586282e+11 1.02907549e+11
 1.61550902e+12 3.49315904e+10 2.23299372e+10 8.25424922e+09
 1.70980376e+11 2.11029340e+11 6.27840100e+10 1.95312480e+11
 3.07603469e+10 4.06496546e+11 1.74235018e+11 1.47435389e+10
 7.81733384e+10 1.01620853e+11 1.18447611e+11 1.60102992e+11
 1.97660847e+10 4.74441241e+09 2.30813341e+11 4.29503671e+10
 4.37281753e+09 2.53988585e+10 1.12776995e+11 1.08037758e+10
 4.29316802e+10 9.43116287e+09 1.67739704e+11 6.94574067e+10
 6.65260537e+10 6.51343378e+10 9.12194241e+10 2.04628250e+11
 3.61585003e+11 3.53961377e+09 6.56708921e+09 4.27142736e+10
 2.11306323e+11 2.33870808e+11 1.84363580e+11 6.76815535e+10
 1.79922490e+11 1.45753584e+11 3.77791306e+11 2.84885701e+10
 6.89019842e+10 6.18311176e+10 6.97944310e+10 5.28265808e+11
 2.62320713e+11 5.83014336e+10 5.10233231e+10 1.58375661e+09
 1.00996989e+11 2.29550732e+11 2.13898395e+10 5.93982623e+10
 1.38412898e+10 3.35895647e+10 8.56855060e+10 2.56678074e+10
 2.82885625e+09 1.69712662e+11 1.55820125e+11 8.36115142e+11
 1.51828831e+11 7.68480438e+11 1.07415218e+11 1.27427138e+12
 1.99742974e+11 2.54083894e+11 5.47045542e+10 6.54810399e+10
 2.88728882e+10 8.46187094e+10 4.41365977e+09 7.57124524e+10
 1.84108335e+11 5.37290288e+10 4.09542748e+10 5.86347251e+09
 7.89817780e+10 1.25044776e+10 1.10574489e+11 9.12194241e+10
 1.61550902e+12 5.90998306e+10 2.71122912e+11 1.28814828e+11
 5.01867614e+10 2.45913740e+11 1.26884452e+10 4.48670453e+10
 2.40088563e+10 8.36234174e+09 1.31297015e+10 4.29382761e+10
 6.75425569e+10 2.77307049e+11 1.47307968e+11 4.29638091e+10
 3.55871491e+10 1.04598127e+11 3.24871457e+10 1.02165755e+11
 4.57179453e+10 2.70123475e+10 4.27667488e+10 7.14254483e+10
 8.27931529e+11 5.24641425e+11 5.03981732e+10 3.02575395e+11
 1.89688806e+10 2.26876865e+11 5.53239890e+10 3.27961314e+10
 1.66219117e+11 1.85850686e+11 7.88840972e+10 3.05665988e+10
 2.61732173e+11 2.31469632e+10 4.73817731e+12 3.63362973e+10
 4.14195054e+10 2.45954709e+10 1.94338112e+10 2.69393318e+10
 1.15069803e+11 4.10137959e+10 5.86247092e+10 5.99515541e+10
 3.18647210e+10 1.19462025e+10 5.12672449e+10 1.04965244e+09
 3.64877696e+11 1.20899579e+11 2.03767611e+10 1.38309972e+11
 5.34745988e+10 1.13986917e+11 2.63413117e+09 1.38921555e+11
 4.65261301e+09 4.85845280e+10 4.58955168e+08 1.48792293e+11
 3.08147376e+10 9.00411584e+10 1.94118690e+08 5.01669085e+11
 8.36946278e+09 1.10757844e+12 1.00499715e+12 2.65877085e+10
 5.35286796e+10 1.56148130e+10 7.49511642e+10 1.04186110e+11
 1.35839779e+11 2.22566954e+10 2.32806216e+09 8.73295937e+09
 2.08888470e+11 1.46221929e+11 1.06019804e+12 1.02314125e+11
 4.47811211e+11 7.05155912e+10 2.88762834e+10 7.65797014e+10
 9.43116287e+09 5.46280402e+09 2.67009286e+08 3.79364496e+10
 1.97454445e+11 2.62369052e+10 2.04356285e+10 1.40080171e+11
 3.79364496e+10 3.18884203e+09 2.13725470e+11 3.03999853e+09
 2.05030472e+10 4.18821383e+11 1.46610094e+11 6.59845364e+10
 9.86372088e+10 9.57960079e+09 8.25377285e+10 2.70123475e+10
 1.39929956e+10 1.09256080e+10 5.06122399e+11 2.70094395e+10
 2.90391696e+11 2.84066641e+11 2.88973959e+10 6.23467358e+11
 7.00245793e+10 8.45752386e+09 6.00377323e+10 7.89817780e+10
 9.55696199e+09 8.64395120e+10 6.72855410e+10 5.82733409e+09
 1.29882799e+11 1.82988768e+11 4.29832230e+10 1.60270727e+11
 5.10233231e+10 2.80989892e+10 9.71690559e+10 1.30994391e+10
 2.72850609e+11 4.61386567e+10 5.53083515e+10 4.65545136e+10
 7.17250033e+10 8.36234174e+09 1.63702600e+11 7.47626000e+08
 9.89996158e+11 4.47811211e+11 1.21803553e+10]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[6.87012418e+10 2.19111733e+09 8.93140605e+09 1.05653162e+11
 1.34942601e+11 2.63258207e+10 1.46391015e+11 5.23693616e+10
 1.17269450e+10 9.05862461e+11 1.27427138e+12 6.26342885e+10
 8.36742562e+09 8.70260051e+11 3.24506139e+11 8.93140605e+09
 2.74816101e+10 4.42162127e+10 4.73444401e+11 2.45725649e+10
 3.81898919e+11 4.13780603e+09 6.87012418e+10 6.73313262e+10
 4.14195054e+10 4.67555335e+11 8.18512999e+10 1.06759176e+11
 5.97380850e+10 1.39953941e+10 5.31876983e+09 1.10297267e+12
 1.65817131e+11 1.58939861e+10 4.16353407e+10 2.04628250e+11
 4.71616460e+10 8.75036403e+09 5.05078591e+10 8.01647249e+09
 1.11241402e+11 1.06885962e+11 5.29572072e+10 1.19185993e+10
 4.43031378e+11 2.69974102e+10 1.74659187e+10 1.84470922e+10
 2.80448774e+11 7.01544823e+09 5.67192161e+11 1.45885572e+10
 9.55703532e+11 6.09962561e+10 2.71758738e+11 3.04786302e+10
 3.27961314e+10 1.43127587e+11 1.86014217e+10 4.74205620e+10
 2.03023702e+11 2.96790906e+08 2.13664276e+10 4.29382761e+10
 9.31785232e+11 1.22879162e+10 3.45230231e+11 3.80982878e+10
 3.00507613e+11 4.05978574e+11 2.88185385e+11 4.00676818e+11
 2.92338785e+10 1.69003198e+08 2.90508149e+10 5.67192161e+11
 1.37283564e+11 1.96448310e+11 1.00089583e+11 1.74281637e+10
 2.53100517e+09 7.61766503e+10 2.58323213e+08 4.05978574e+11
 2.11080063e+11 1.46391015e+11 2.74179486e+11 2.43300575e+10
 1.45254074e+10 7.73839611e+11 7.36661699e+10 2.08888470e+11
 3.82941390e+11 9.31785232e+11 2.39491906e+11 1.63817099e+10
 1.87999623e+11 9.50372196e+10 1.19686263e+11 1.78053563e+10
 9.79294597e+09 1.18324313e+10 1.42483647e+11 6.34285968e+11
 1.17859528e+10 5.03981732e+10 4.51151755e+10 3.03047155e+10
 9.63713079e+10 2.92338785e+10 1.36718736e+11 5.16144867e+11
 2.96062576e+10 1.70000380e+11 1.46610094e+11 2.02695426e+10
 2.93173626e+10 1.99748530e+11 1.62258208e+11 1.69203884e+11
 1.13828318e+11 9.42951887e+10 9.00364299e+10 1.05437898e+11
 1.58553866e+11 8.73898238e+10 3.10124586e+08 4.13780603e+09
 3.46658231e+10 7.64035453e+10 1.11990130e+11 8.19420603e+09
 4.77848099e+09 1.00996989e+11 2.84233139e+10 2.39654224e+09
 3.47584892e+10 3.95016063e+10 1.32454044e+10 4.80695357e+11
 9.14266472e+09 1.01501974e+11 8.74048643e+09 1.27226015e+10
 1.48437485e+11 4.43242807e+08 1.13081099e+10 4.92012320e+11
 3.10440869e+11 3.49888188e+11 1.43127587e+11 3.48433268e+10
 6.07999706e+09 1.95312480e+11 1.94461663e+09 4.70103941e+10
 1.73643517e+11 7.21187713e+10 2.70664788e+11 2.27267045e+10
 2.36831690e+11 2.27973835e+11 1.06574260e+11 5.54850837e+11
 7.15415631e+10 6.39780314e+10 1.39334540e+11 7.29547486e+08
 9.58954833e+10 3.57623498e+10 6.87420946e+10 1.42483647e+11
 1.63817099e+10 1.02893174e+11 5.83014336e+10 1.16160305e+11
 3.61497216e+11 6.28773075e+09 1.17856685e+12 9.00411584e+10
 8.39580410e+10 1.08776966e+11 1.39856018e+10 1.17525985e+11
 1.57193269e+10 2.32494355e+10 1.84695055e+11 3.55652145e+10
 1.13986917e+11 4.12106827e+11 3.05811372e+10 1.00996989e+11
 7.19588681e+10 3.60568466e+09 1.13465773e+11 5.58781900e+10
 2.97770853e+10 7.76798434e+10 3.69390111e+11 2.76777223e+11
 1.22438711e+10 1.76558151e+11 3.95783846e+09 2.86479550e+10
 1.20077244e+12 5.10917832e+10 3.05033556e+10 3.10999467e+11
 7.27897158e+11 3.19935454e+10 1.06759176e+11 3.02691057e+10
 4.10137959e+10 1.24664338e+11 4.99413803e+11 5.99369620e+11
 3.24255544e+11 2.28658519e+10 2.62369052e+10 3.47703722e+11
 1.29776656e+12 2.62368667e+10 2.10618408e+10 3.40359181e+10
 8.41218683e+11 1.45753584e+11 1.30962080e+11 7.56438488e+11
 8.28899274e+09 2.45350183e+11 2.39654224e+09 6.13375457e+11
 5.05112471e+10 1.78563621e+11 2.10169553e+11 1.56148130e+10
 3.53909718e+10 2.51400640e+11 2.80989892e+10 5.24712902e+10
 4.29832230e+10 8.16691592e+11 2.75507550e+11 7.51012377e+08
 6.81650715e+10 6.60301828e+10 8.90033121e+11 5.06122399e+11
 1.95571674e+09 8.38869852e+11 4.71616460e+10 7.45558231e+10
 2.10074507e+11 1.97840007e+10 1.34431157e+10 5.03981732e+10
 8.42597279e+11 3.51862226e+10 2.09894934e+10 1.47756044e+11
 8.67214629e+10 2.56240939e+11 2.11029340e+11 4.28840945e+10
 5.56194432e+10 2.02438441e+11 7.22434897e+10 6.77325871e+09
 6.59625198e+11 7.25491908e+10 2.25713397e+10 2.32027088e+11
 1.17187488e+11 3.01954154e+11 2.32986947e+11 2.61738931e+10
 1.02907549e+11 1.61550902e+12 2.23299372e+10 8.25424922e+09
 2.11029340e+11 6.27840100e+10 1.95312480e+11 3.07603469e+10
 4.06496546e+11 1.74235018e+11 1.47435389e+10 7.81733384e+10
 1.01620853e+11 1.60102992e+11 1.97660847e+10 4.74441241e+09
 2.30813341e+11 4.37281753e+09 2.53988585e+10 1.12776995e+11
 1.08037758e+10 4.29316802e+10 9.43116287e+09 6.94574067e+10
 6.51343378e+10 9.12194241e+10 2.04628250e+11 3.61585003e+11
 3.53961377e+09 6.56708921e+09 4.27142736e+10 2.11306323e+11
 2.33870808e+11 1.84363580e+11 1.79922490e+11 3.77791306e+11
 2.84885701e+10 6.89019842e+10 6.18311176e+10 6.97944310e+10
 5.28265808e+11 2.62320713e+11 1.58375661e+09 1.00996989e+11
 2.29550732e+11 2.13898395e+10 5.93982623e+10 1.38412898e+10
 3.35895647e+10 8.56855060e+10 2.56678074e+10 2.82885625e+09
 1.69712662e+11 1.55820125e+11 8.36115142e+11 1.51828831e+11
 7.68480438e+11 1.07415218e+11 1.27427138e+12 1.99742974e+11
 2.54083894e+11 5.47045542e+10 6.54810399e+10 2.88728882e+10
 4.41365977e+09 7.57124524e+10 1.84108335e+11 5.37290288e+10
 4.09542748e+10 5.86347251e+09 7.89817780e+10 1.25044776e+10
 1.10574489e+11 9.12194241e+10 1.61550902e+12 5.90998306e+10
 2.71122912e+11 1.28814828e+11 5.01867614e+10 2.45913740e+11
 1.26884452e+10 4.48670453e+10 2.40088563e+10 8.36234174e+09
 1.31297015e+10 4.29382761e+10 6.75425569e+10 2.77307049e+11
 1.47307968e+11 4.29638091e+10 3.55871491e+10 1.04598127e+11
 3.24871457e+10 1.02165755e+11 4.57179453e+10 2.70123475e+10
 7.14254483e+10 8.27931529e+11 5.24641425e+11 5.03981732e+10
 3.02575395e+11 2.26876865e+11 5.53239890e+10 3.27961314e+10
 1.66219117e+11 7.88840972e+10 3.05665988e+10 2.61732173e+11
 2.31469632e+10 4.73817731e+12 3.63362973e+10 4.14195054e+10
 2.45954709e+10 2.69393318e+10 1.15069803e+11 4.10137959e+10
 5.86247092e+10 5.99515541e+10 3.18647210e+10 1.19462025e+10
 5.12672449e+10 1.04965244e+09 3.64877696e+11 1.20899579e+11
 2.03767611e+10 1.38309972e+11 1.13986917e+11 1.38921555e+11
 4.65261301e+09 4.85845280e+10 4.58955168e+08 1.48792293e+11
 9.00411584e+10 1.94118690e+08 8.36946278e+09 1.10757844e+12
 1.00499715e+12 2.65877085e+10 5.35286796e+10 1.56148130e+10
 7.49511642e+10 1.04186110e+11 1.35839779e+11 2.22566954e+10
 2.32806216e+09 8.73295937e+09 2.08888470e+11 1.46221929e+11
 1.06019804e+12 1.02314125e+11 4.47811211e+11 7.65797014e+10
 5.46280402e+09 2.67009286e+08 3.79364496e+10 1.97454445e+11
 2.62369052e+10 2.04356285e+10 1.40080171e+11 3.79364496e+10
 3.18884203e+09 2.13725470e+11 3.03999853e+09 2.05030472e+10
 4.18821383e+11 1.46610094e+11 6.59845364e+10 9.86372088e+10
 9.57960079e+09 8.25377285e+10 2.70123475e+10 1.39929956e+10
 1.09256080e+10 5.06122399e+11 2.70094395e+10 2.90391696e+11
 2.84066641e+11 2.88973959e+10 6.23467358e+11 7.00245793e+10
 6.00377323e+10 7.89817780e+10 9.55696199e+09 8.64395120e+10
 6.72855410e+10 5.82733409e+09 1.82988768e+11 1.60270727e+11
 5.10233231e+10 2.80989892e+10 1.30994391e+10 2.72850609e+11
 4.61386567e+10 5.53083515e+10 4.65545136e+10 7.17250033e+10
 8.36234174e+09 1.63702600e+11 7.47626000e+08 9.89996158e+11
 4.47811211e+11 1.21803553e+10]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[6.87012418e+10 2.19111733e+09 8.93140605e+09 1.05653162e+11
 1.34942601e+11 2.63258207e+10 1.46391015e+11 5.23693616e+10
 1.17269450e+10 9.05862461e+11 1.27427138e+12 8.36742562e+09
 8.70260051e+11 3.24506139e+11 8.93140605e+09 2.74816101e+10
 4.42162127e+10 4.73444401e+11 2.45725649e+10 3.81898919e+11
 4.13780603e+09 6.87012418e+10 6.73313262e+10 4.14195054e+10
 4.67555335e+11 8.18512999e+10 1.06759176e+11 1.39953941e+10
 5.31876983e+09 1.10297267e+12 1.65817131e+11 1.58939861e+10
 4.16353407e+10 4.71616460e+10 8.75036403e+09 5.05078591e+10
 8.01647249e+09 1.06885962e+11 5.29572072e+10 1.19185993e+10
 4.43031378e+11 2.69974102e+10 1.74659187e+10 1.84470922e+10
 2.80448774e+11 7.01544823e+09 5.67192161e+11 1.45885572e+10
 9.55703532e+11 6.09962561e+10 2.71758738e+11 3.04786302e+10
 3.27961314e+10 1.43127587e+11 1.86014217e+10 4.74205620e+10
 2.03023702e+11 2.96790906e+08 2.13664276e+10 4.29382761e+10
 9.31785232e+11 1.22879162e+10 3.45230231e+11 3.80982878e+10
 4.05978574e+11 2.88185385e+11 4.00676818e+11 2.92338785e+10
 1.69003198e+08 2.90508149e+10 5.67192161e+11 1.37283564e+11
 1.96448310e+11 1.00089583e+11 1.74281637e+10 2.58323213e+08
 4.05978574e+11 2.11080063e+11 1.46391015e+11 2.74179486e+11
 2.43300575e+10 1.45254074e+10 7.73839611e+11 7.36661699e+10
 2.08888470e+11 3.82941390e+11 9.31785232e+11 2.39491906e+11
 1.63817099e+10 1.87999623e+11 9.50372196e+10 1.19686263e+11
 1.78053563e+10 9.79294597e+09 1.18324313e+10 1.42483647e+11
 6.34285968e+11 1.17859528e+10 5.03981732e+10 4.51151755e+10
 9.63713079e+10 2.92338785e+10 1.36718736e+11 5.16144867e+11
 2.96062576e+10 1.70000380e+11 1.46610094e+11 2.02695426e+10
 2.93173626e+10 1.99748530e+11 1.62258208e+11 1.69203884e+11
 1.13828318e+11 9.00364299e+10 1.05437898e+11 1.58553866e+11
 8.73898238e+10 3.10124586e+08 4.13780603e+09 3.46658231e+10
 7.64035453e+10 1.11990130e+11 8.19420603e+09 4.77848099e+09
 1.00996989e+11 2.39654224e+09 3.47584892e+10 1.32454044e+10
 4.80695357e+11 9.14266472e+09 1.01501974e+11 8.74048643e+09
 1.27226015e+10 4.43242807e+08 4.92012320e+11 3.10440869e+11
 3.49888188e+11 1.43127587e+11 3.48433268e+10 6.07999706e+09
 1.95312480e+11 1.94461663e+09 4.70103941e+10 1.73643517e+11
 7.21187713e+10 2.70664788e+11 2.27267045e+10 2.36831690e+11
 2.27973835e+11 1.06574260e+11 5.54850837e+11 7.15415631e+10
 6.39780314e+10 1.39334540e+11 7.29547486e+08 9.58954833e+10
 3.57623498e+10 1.42483647e+11 1.63817099e+10 1.02893174e+11
 5.83014336e+10 1.16160305e+11 3.61497216e+11 6.28773075e+09
 1.17856685e+12 9.00411584e+10 8.39580410e+10 1.08776966e+11
 1.39856018e+10 1.17525985e+11 1.57193269e+10 2.32494355e+10
 3.55652145e+10 1.13986917e+11 4.12106827e+11 3.05811372e+10
 1.00996989e+11 7.19588681e+10 1.13465773e+11 5.58781900e+10
 2.97770853e+10 7.76798434e+10 3.69390111e+11 2.76777223e+11
 1.22438711e+10 1.76558151e+11 3.95783846e+09 5.10917832e+10
 3.05033556e+10 3.10999467e+11 7.27897158e+11 3.19935454e+10
 1.06759176e+11 3.02691057e+10 4.10137959e+10 4.99413803e+11
 5.99369620e+11 3.24255544e+11 2.28658519e+10 2.62369052e+10
 3.47703722e+11 1.29776656e+12 2.62368667e+10 2.10618408e+10
 3.40359181e+10 1.30962080e+11 7.56438488e+11 2.45350183e+11
 2.39654224e+09 6.13375457e+11 5.05112471e+10 1.78563621e+11
 2.10169553e+11 1.56148130e+10 3.53909718e+10 2.51400640e+11
 2.80989892e+10 5.24712902e+10 4.29832230e+10 8.16691592e+11
 2.75507550e+11 7.51012377e+08 6.81650715e+10 6.60301828e+10
 8.90033121e+11 5.06122399e+11 1.95571674e+09 8.38869852e+11
 4.71616460e+10 7.45558231e+10 2.10074507e+11 1.97840007e+10
 1.34431157e+10 5.03981732e+10 8.42597279e+11 3.51862226e+10
 1.47756044e+11 8.67214629e+10 2.56240939e+11 2.11029340e+11
 4.28840945e+10 5.56194432e+10 2.02438441e+11 7.22434897e+10
 6.77325871e+09 7.25491908e+10 2.25713397e+10 3.01954154e+11
 2.32986947e+11 2.61738931e+10 1.02907549e+11 1.61550902e+12
 2.23299372e+10 8.25424922e+09 2.11029340e+11 6.27840100e+10
 1.95312480e+11 3.07603469e+10 4.06496546e+11 1.74235018e+11
 7.81733384e+10 1.01620853e+11 1.97660847e+10 4.74441241e+09
 2.30813341e+11 4.37281753e+09 2.53988585e+10 1.12776995e+11
 1.08037758e+10 9.43116287e+09 6.51343378e+10 9.12194241e+10
 2.04628250e+11 3.61585003e+11 6.56708921e+09 4.27142736e+10
 2.11306323e+11 2.33870808e+11 1.79922490e+11 3.77791306e+11
 2.84885701e+10 6.89019842e+10 6.18311176e+10 6.97944310e+10
 2.62320713e+11 1.58375661e+09 1.00996989e+11 2.29550732e+11
 2.13898395e+10 5.93982623e+10 1.38412898e+10 3.35895647e+10
 8.56855060e+10 2.56678074e+10 2.82885625e+09 1.69712662e+11
 1.55820125e+11 8.36115142e+11 1.51828831e+11 7.68480438e+11
 1.07415218e+11 1.27427138e+12 1.99742974e+11 2.54083894e+11
 5.47045542e+10 6.54810399e+10 2.88728882e+10 4.41365977e+09
 7.57124524e+10 1.84108335e+11 5.37290288e+10 4.09542748e+10
 7.89817780e+10 1.25044776e+10 1.10574489e+11 9.12194241e+10
 1.61550902e+12 5.90998306e+10 2.71122912e+11 1.28814828e+11
 5.01867614e+10 2.45913740e+11 1.26884452e+10 4.48670453e+10
 2.40088563e+10 8.36234174e+09 1.31297015e+10 4.29382761e+10
 6.75425569e+10 2.77307049e+11 1.47307968e+11 4.29638091e+10
 3.55871491e+10 1.04598127e+11 3.24871457e+10 1.02165755e+11
 4.57179453e+10 2.70123475e+10 7.14254483e+10 8.27931529e+11
 5.24641425e+11 5.03981732e+10 2.26876865e+11 5.53239890e+10
 3.27961314e+10 1.66219117e+11 7.88840972e+10 3.05665988e+10
 2.61732173e+11 2.31469632e+10 4.73817731e+12 3.63362973e+10
 4.14195054e+10 2.45954709e+10 2.69393318e+10 1.15069803e+11
 4.10137959e+10 5.86247092e+10 5.99515541e+10 3.18647210e+10
 1.19462025e+10 5.12672449e+10 1.04965244e+09 3.64877696e+11
 1.20899579e+11 2.03767611e+10 1.38309972e+11 1.38921555e+11
 4.65261301e+09 4.58955168e+08 9.00411584e+10 1.94118690e+08
 8.36946278e+09 1.10757844e+12 1.00499715e+12 2.65877085e+10
 5.35286796e+10 1.56148130e+10 1.04186110e+11 1.35839779e+11
 2.22566954e+10 2.32806216e+09 8.73295937e+09 2.08888470e+11
 1.46221929e+11 1.06019804e+12 1.02314125e+11 4.47811211e+11
 5.46280402e+09 2.67009286e+08 3.79364496e+10 1.97454445e+11
 2.62369052e+10 2.04356285e+10 1.40080171e+11 3.79364496e+10
 3.18884203e+09 2.13725470e+11 2.05030472e+10 4.18821383e+11
 1.46610094e+11 6.59845364e+10 9.86372088e+10 9.57960079e+09
 8.25377285e+10 2.70123475e+10 1.39929956e+10 1.09256080e+10
 2.70094395e+10 2.90391696e+11 2.84066641e+11 2.88973959e+10
 6.23467358e+11 7.00245793e+10 6.00377323e+10 7.89817780e+10
 9.55696199e+09 8.64395120e+10 6.72855410e+10 5.82733409e+09
 1.82988768e+11 1.60270727e+11 5.10233231e+10 2.80989892e+10
 1.30994391e+10 2.72850609e+11 4.61386567e+10 5.53083515e+10
 4.65545136e+10 7.17250033e+10 8.36234174e+09 1.63702600e+11
 7.47626000e+08 9.89996158e+11 4.47811211e+11 1.21803553e+10]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[6.87012418e+10 2.19111733e+09 8.93140605e+09 1.05653162e+11
 1.34942601e+11 2.63258207e+10 1.46391015e+11 5.23693616e+10
 1.17269450e+10 9.05862461e+11 1.27427138e+12 8.36742562e+09
 8.70260051e+11 3.24506139e+11 8.93140605e+09 2.74816101e+10
 4.42162127e+10 4.73444401e+11 2.45725649e+10 3.81898919e+11
 4.13780603e+09 6.87012418e+10 6.73313262e+10 4.14195054e+10
 4.67555335e+11 8.18512999e+10 1.06759176e+11 1.39953941e+10
 5.31876983e+09 1.10297267e+12 1.65817131e+11 1.58939861e+10
 4.16353407e+10 4.71616460e+10 8.75036403e+09 5.05078591e+10
 8.01647249e+09 1.06885962e+11 5.29572072e+10 1.19185993e+10
 4.43031378e+11 2.69974102e+10 1.74659187e+10 1.84470922e+10
 2.80448774e+11 7.01544823e+09 5.67192161e+11 1.45885572e+10
 9.55703532e+11 6.09962561e+10 2.71758738e+11 3.04786302e+10
 3.27961314e+10 1.43127587e+11 1.86014217e+10 4.74205620e+10
 2.96790906e+08 4.29382761e+10 9.31785232e+11 1.22879162e+10
 3.45230231e+11 3.80982878e+10 4.05978574e+11 2.88185385e+11
 4.00676818e+11 2.92338785e+10 1.69003198e+08 2.90508149e+10
 5.67192161e+11 1.37283564e+11 1.00089583e+11 2.58323213e+08
 4.05978574e+11 1.46391015e+11 2.74179486e+11 2.43300575e+10
 1.45254074e+10 7.73839611e+11 7.36661699e+10 2.08888470e+11
 3.82941390e+11 9.31785232e+11 2.39491906e+11 1.63817099e+10
 1.87999623e+11 9.50372196e+10 1.19686263e+11 1.78053563e+10
 9.79294597e+09 1.18324313e+10 1.42483647e+11 6.34285968e+11
 1.17859528e+10 5.03981732e+10 4.51151755e+10 9.63713079e+10
 2.92338785e+10 1.36718736e+11 1.70000380e+11 1.46610094e+11
 2.02695426e+10 2.93173626e+10 1.99748530e+11 1.62258208e+11
 1.69203884e+11 1.13828318e+11 9.00364299e+10 1.58553866e+11
 8.73898238e+10 3.10124586e+08 4.13780603e+09 3.46658231e+10
 7.64035453e+10 1.11990130e+11 8.19420603e+09 4.77848099e+09
 1.00996989e+11 2.39654224e+09 3.47584892e+10 1.32454044e+10
 4.80695357e+11 9.14266472e+09 1.01501974e+11 8.74048643e+09
 1.27226015e+10 4.43242807e+08 4.92012320e+11 3.10440869e+11
 3.49888188e+11 1.43127587e+11 3.48433268e+10 6.07999706e+09
 1.95312480e+11 1.94461663e+09 4.70103941e+10 1.73643517e+11
 7.21187713e+10 2.70664788e+11 2.27267045e+10 2.36831690e+11
 2.27973835e+11 1.06574260e+11 5.54850837e+11 6.39780314e+10
 1.39334540e+11 7.29547486e+08 9.58954833e+10 3.57623498e+10
 1.42483647e+11 1.63817099e+10 1.02893174e+11 5.83014336e+10
 1.16160305e+11 3.61497216e+11 6.28773075e+09 9.00411584e+10
 8.39580410e+10 1.08776966e+11 1.39856018e+10 1.17525985e+11
 2.32494355e+10 3.55652145e+10 1.13986917e+11 4.12106827e+11
 3.05811372e+10 1.00996989e+11 7.19588681e+10 5.58781900e+10
 3.69390111e+11 2.76777223e+11 1.22438711e+10 1.76558151e+11
 3.95783846e+09 5.10917832e+10 3.05033556e+10 3.10999467e+11
 7.27897158e+11 3.19935454e+10 4.10137959e+10 4.99413803e+11
 5.99369620e+11 3.24255544e+11 2.28658519e+10 2.62369052e+10
 3.47703722e+11 1.29776656e+12 2.62368667e+10 2.10618408e+10
 3.40359181e+10 1.30962080e+11 7.56438488e+11 2.45350183e+11
 2.39654224e+09 6.13375457e+11 5.05112471e+10 1.78563621e+11
 2.10169553e+11 3.53909718e+10 2.51400640e+11 2.80989892e+10
 5.24712902e+10 4.29832230e+10 8.16691592e+11 7.51012377e+08
 6.81650715e+10 6.60301828e+10 8.90033121e+11 5.06122399e+11
 1.95571674e+09 8.38869852e+11 4.71616460e+10 7.45558231e+10
 2.10074507e+11 1.97840007e+10 1.34431157e+10 5.03981732e+10
 8.42597279e+11 3.51862226e+10 1.47756044e+11 8.67214629e+10
 2.56240939e+11 2.11029340e+11 4.28840945e+10 5.56194432e+10
 2.02438441e+11 7.22434897e+10 6.77325871e+09 7.25491908e+10
 2.25713397e+10 3.01954154e+11 2.32986947e+11 2.61738931e+10
 1.02907549e+11 1.61550902e+12 2.23299372e+10 8.25424922e+09
 2.11029340e+11 6.27840100e+10 1.95312480e+11 3.07603469e+10
 4.06496546e+11 1.74235018e+11 7.81733384e+10 1.01620853e+11
 1.97660847e+10 4.74441241e+09 2.30813341e+11 4.37281753e+09
 2.53988585e+10 1.12776995e+11 1.08037758e+10 9.43116287e+09
 6.51343378e+10 9.12194241e+10 2.04628250e+11 3.61585003e+11
 6.56708921e+09 4.27142736e+10 2.11306323e+11 2.33870808e+11
 1.79922490e+11 3.77791306e+11 2.84885701e+10 6.89019842e+10
 6.18311176e+10 6.97944310e+10 1.58375661e+09 1.00996989e+11
 2.29550732e+11 2.13898395e+10 5.93982623e+10 1.38412898e+10
 3.35895647e+10 8.56855060e+10 2.82885625e+09 1.69712662e+11
 1.55820125e+11 7.68480438e+11 1.27427138e+12 1.99742974e+11
 2.54083894e+11 5.47045542e+10 6.54810399e+10 2.88728882e+10
 4.41365977e+09 7.57124524e+10 1.84108335e+11 5.37290288e+10
 4.09542748e+10 7.89817780e+10 1.25044776e+10 1.10574489e+11
 9.12194241e+10 1.61550902e+12 5.90998306e+10 2.71122912e+11
 1.28814828e+11 5.01867614e+10 2.45913740e+11 1.26884452e+10
 4.48670453e+10 2.40088563e+10 8.36234174e+09 1.31297015e+10
 4.29382761e+10 6.75425569e+10 2.77307049e+11 1.47307968e+11
 3.55871491e+10 1.04598127e+11 3.24871457e+10 1.02165755e+11
 4.57179453e+10 2.70123475e+10 8.27931529e+11 5.24641425e+11
 5.03981732e+10 2.26876865e+11 5.53239890e+10 3.27961314e+10
 1.66219117e+11 7.88840972e+10 3.05665988e+10 2.61732173e+11
 2.31469632e+10 4.73817731e+12 3.63362973e+10 4.14195054e+10
 2.45954709e+10 2.69393318e+10 1.15069803e+11 4.10137959e+10
 5.99515541e+10 3.18647210e+10 1.19462025e+10 5.12672449e+10
 1.04965244e+09 3.64877696e+11 1.20899579e+11 2.03767611e+10
 1.38309972e+11 1.38921555e+11 4.65261301e+09 4.58955168e+08
 9.00411584e+10 1.94118690e+08 8.36946278e+09 1.10757844e+12
 1.00499715e+12 2.65877085e+10 5.35286796e+10 1.56148130e+10
 1.04186110e+11 1.35839779e+11 2.22566954e+10 2.32806216e+09
 8.73295937e+09 2.08888470e+11 1.46221929e+11 1.06019804e+12
 1.02314125e+11 4.47811211e+11 5.46280402e+09 2.67009286e+08
 3.79364496e+10 1.97454445e+11 2.62369052e+10 2.04356285e+10
 1.40080171e+11 3.79364496e+10 3.18884203e+09 2.13725470e+11
 2.05030472e+10 4.18821383e+11 1.46610094e+11 6.59845364e+10
 9.86372088e+10 9.57960079e+09 8.25377285e+10 2.70123475e+10
 1.39929956e+10 1.09256080e+10 2.70094395e+10 2.90391696e+11
 2.84066641e+11 2.88973959e+10 6.23467358e+11 7.00245793e+10
 6.00377323e+10 7.89817780e+10 9.55696199e+09 8.64395120e+10
 6.72855410e+10 5.82733409e+09 1.82988768e+11 1.60270727e+11
 5.10233231e+10 2.80989892e+10 1.30994391e+10 2.72850609e+11
 4.61386567e+10 5.53083515e+10 4.65545136e+10 7.17250033e+10
 8.36234174e+09 1.63702600e+11 7.47626000e+08 9.89996158e+11
 4.47811211e+11]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[6.87012418e+10 2.19111733e+09 8.93140605e+09 1.05653162e+11
 1.34942601e+11 2.63258207e+10 1.46391015e+11 5.23693616e+10
 1.17269450e+10 9.05862461e+11 1.27427138e+12 8.36742562e+09
 8.70260051e+11 3.24506139e+11 2.74816101e+10 4.42162127e+10
 4.73444401e+11 2.45725649e+10 3.81898919e+11 4.13780603e+09
 6.87012418e+10 6.73313262e+10 4.14195054e+10 4.67555335e+11
 8.18512999e+10 1.06759176e+11 1.39953941e+10 5.31876983e+09
 1.10297267e+12 1.65817131e+11 1.58939861e+10 4.16353407e+10
 4.71616460e+10 8.75036403e+09 1.06885962e+11 5.29572072e+10
 1.19185993e+10 4.43031378e+11 2.69974102e+10 1.74659187e+10
 1.84470922e+10 2.80448774e+11 7.01544823e+09 5.67192161e+11
 1.45885572e+10 9.55703532e+11 6.09962561e+10 2.71758738e+11
 3.04786302e+10 3.27961314e+10 1.43127587e+11 1.86014217e+10
 4.74205620e+10 2.96790906e+08 9.31785232e+11 1.22879162e+10
 3.45230231e+11 3.80982878e+10 4.05978574e+11 2.88185385e+11
 4.00676818e+11 2.92338785e+10 1.69003198e+08 2.90508149e+10
 2.58323213e+08 4.05978574e+11 1.46391015e+11 2.74179486e+11
 2.43300575e+10 1.45254074e+10 7.73839611e+11 7.36661699e+10
 2.08888470e+11 3.82941390e+11 9.31785232e+11 2.39491906e+11
 1.87999623e+11 9.50372196e+10 1.78053563e+10 9.79294597e+09
 1.18324313e+10 1.42483647e+11 6.34285968e+11 5.03981732e+10
 4.51151755e+10 9.63713079e+10 2.92338785e+10 1.36718736e+11
 1.70000380e+11 2.02695426e+10 2.93173626e+10 1.99748530e+11
 1.62258208e+11 1.69203884e+11 1.13828318e+11 9.00364299e+10
 1.58553866e+11 8.73898238e+10 3.10124586e+08 4.13780603e+09
 3.46658231e+10 7.64035453e+10 1.11990130e+11 8.19420603e+09
 1.00996989e+11 2.39654224e+09 3.47584892e+10 1.32454044e+10
 4.80695357e+11 9.14266472e+09 1.01501974e+11 8.74048643e+09
 4.43242807e+08 4.92012320e+11 3.10440869e+11 3.49888188e+11
 1.43127587e+11 3.48433268e+10 6.07999706e+09 1.95312480e+11
 1.94461663e+09 4.70103941e+10 1.73643517e+11 7.21187713e+10
 2.70664788e+11 2.27267045e+10 2.36831690e+11 2.27973835e+11
 1.06574260e+11 5.54850837e+11 6.39780314e+10 1.39334540e+11
 7.29547486e+08 9.58954833e+10 3.57623498e+10 1.42483647e+11
 1.63817099e+10 1.02893174e+11 5.83014336e+10 1.16160305e+11
 3.61497216e+11 6.28773075e+09 9.00411584e+10 8.39580410e+10
 1.08776966e+11 1.39856018e+10 1.17525985e+11 3.55652145e+10
 1.13986917e+11 4.12106827e+11 3.05811372e+10 1.00996989e+11
 7.19588681e+10 3.69390111e+11 2.76777223e+11 1.22438711e+10
 1.76558151e+11 3.95783846e+09 5.10917832e+10 3.05033556e+10
 3.19935454e+10 4.10137959e+10 4.99413803e+11 5.99369620e+11
 2.28658519e+10 2.62369052e+10 3.47703722e+11 1.29776656e+12
 2.62368667e+10 2.10618408e+10 3.40359181e+10 1.30962080e+11
 7.56438488e+11 2.45350183e+11 2.39654224e+09 6.13375457e+11
 5.05112471e+10 1.78563621e+11 2.10169553e+11 3.53909718e+10
 2.51400640e+11 2.80989892e+10 5.24712902e+10 4.29832230e+10
 8.16691592e+11 7.51012377e+08 6.81650715e+10 6.60301828e+10
 8.90033121e+11 5.06122399e+11 8.38869852e+11 4.71616460e+10
 7.45558231e+10 2.10074507e+11 1.97840007e+10 1.34431157e+10
 5.03981732e+10 3.51862226e+10 1.47756044e+11 8.67214629e+10
 2.56240939e+11 2.11029340e+11 5.56194432e+10 2.02438441e+11
 7.22434897e+10 6.77325871e+09 7.25491908e+10 2.25713397e+10
 3.01954154e+11 2.32986947e+11 2.61738931e+10 1.02907549e+11
 1.61550902e+12 2.23299372e+10 8.25424922e+09 2.11029340e+11
 6.27840100e+10 1.95312480e+11 3.07603469e+10 4.06496546e+11
 1.74235018e+11 7.81733384e+10 1.01620853e+11 1.97660847e+10
 4.74441241e+09 2.30813341e+11 4.37281753e+09 2.53988585e+10
 1.12776995e+11 1.08037758e+10 6.51343378e+10 9.12194241e+10
 2.04628250e+11 6.56708921e+09 4.27142736e+10 2.33870808e+11
 1.79922490e+11 3.77791306e+11 2.84885701e+10 6.89019842e+10
 6.18311176e+10 6.97944310e+10 1.58375661e+09 1.00996989e+11
 2.29550732e+11 2.13898395e+10 1.38412898e+10 3.35895647e+10
 8.56855060e+10 2.82885625e+09 1.69712662e+11 1.55820125e+11
 7.68480438e+11 1.99742974e+11 2.54083894e+11 2.88728882e+10
 4.41365977e+09 5.37290288e+10 4.09542748e+10 7.89817780e+10
 1.25044776e+10 1.10574489e+11 9.12194241e+10 1.61550902e+12
 5.90998306e+10 2.71122912e+11 1.28814828e+11 5.01867614e+10
 2.45913740e+11 1.26884452e+10 4.48670453e+10 2.40088563e+10
 8.36234174e+09 1.31297015e+10 6.75425569e+10 2.77307049e+11
 1.47307968e+11 3.55871491e+10 1.04598127e+11 3.24871457e+10
 1.02165755e+11 4.57179453e+10 2.70123475e+10 8.27931529e+11
 5.24641425e+11 5.03981732e+10 2.26876865e+11 3.27961314e+10
 1.66219117e+11 7.88840972e+10 3.05665988e+10 2.61732173e+11
 2.31469632e+10 4.73817731e+12 3.63362973e+10 4.14195054e+10
 2.45954709e+10 2.69393318e+10 1.15069803e+11 4.10137959e+10
 5.99515541e+10 1.19462025e+10 5.12672449e+10 1.04965244e+09
 3.64877696e+11 1.20899579e+11 2.03767611e+10 1.38309972e+11
 1.38921555e+11 4.65261301e+09 4.58955168e+08 9.00411584e+10
 1.94118690e+08 8.36946278e+09 1.10757844e+12 1.00499715e+12
 2.65877085e+10 5.35286796e+10 1.56148130e+10 1.04186110e+11
 1.35839779e+11 2.32806216e+09 8.73295937e+09 2.08888470e+11
 1.46221929e+11 1.06019804e+12 1.02314125e+11 4.47811211e+11
 2.67009286e+08 3.79364496e+10 1.97454445e+11 2.62369052e+10
 2.04356285e+10 1.40080171e+11 3.79364496e+10 3.18884203e+09
 2.13725470e+11 2.05030472e+10 4.18821383e+11 1.46610094e+11
 6.59845364e+10 9.86372088e+10 9.57960079e+09 8.25377285e+10
 2.70123475e+10 1.39929956e+10 1.09256080e+10 2.90391696e+11
 2.84066641e+11 2.88973959e+10 6.23467358e+11 7.00245793e+10
 6.00377323e+10 7.89817780e+10 9.55696199e+09 8.64395120e+10
 6.72855410e+10 5.82733409e+09 1.82988768e+11 1.60270727e+11
 5.10233231e+10 2.80989892e+10 1.30994391e+10 2.72850609e+11
 4.61386567e+10 5.53083515e+10 4.65545136e+10 7.17250033e+10
 8.36234174e+09 1.63702600e+11 9.89996158e+11 4.47811211e+11]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[6.87012418e+10 2.19111733e+09 8.93140605e+09 1.05653162e+11
 1.34942601e+11 2.63258207e+10 1.46391015e+11 5.23693616e+10
 1.17269450e+10 9.05862461e+11 1.27427138e+12 8.36742562e+09
 8.70260051e+11 3.24506139e+11 2.74816101e+10 4.42162127e+10
 4.73444401e+11 2.45725649e+10 3.81898919e+11 4.13780603e+09
 6.87012418e+10 6.73313262e+10 4.14195054e+10 4.67555335e+11
 8.18512999e+10 1.06759176e+11 1.39953941e+10 5.31876983e+09
 1.10297267e+12 1.65817131e+11 1.58939861e+10 4.16353407e+10
 4.71616460e+10 8.75036403e+09 1.06885962e+11 5.29572072e+10
 1.19185993e+10 4.43031378e+11 2.69974102e+10 1.74659187e+10
 1.84470922e+10 2.80448774e+11 7.01544823e+09 5.67192161e+11
 1.45885572e+10 9.55703532e+11 6.09962561e+10 2.71758738e+11
 3.04786302e+10 3.27961314e+10 1.43127587e+11 1.86014217e+10
 4.74205620e+10 2.96790906e+08 9.31785232e+11 3.45230231e+11
 3.80982878e+10 4.05978574e+11 2.88185385e+11 4.00676818e+11
 2.92338785e+10 2.90508149e+10 2.58323213e+08 4.05978574e+11
 1.46391015e+11 2.74179486e+11 2.43300575e+10 1.45254074e+10
 7.73839611e+11 2.08888470e+11 3.82941390e+11 9.31785232e+11
 1.87999623e+11 9.50372196e+10 1.78053563e+10 9.79294597e+09
 1.18324313e+10 1.42483647e+11 6.34285968e+11 5.03981732e+10
 4.51151755e+10 9.63713079e+10 2.92338785e+10 1.36718736e+11
 1.70000380e+11 2.02695426e+10 2.93173626e+10 1.99748530e+11
 1.62258208e+11 1.69203884e+11 1.13828318e+11 9.00364299e+10
 1.58553866e+11 3.10124586e+08 4.13780603e+09 3.46658231e+10
 7.64035453e+10 1.11990130e+11 8.19420603e+09 1.00996989e+11
 2.39654224e+09 3.47584892e+10 1.32454044e+10 4.80695357e+11
 9.14266472e+09 1.01501974e+11 8.74048643e+09 4.92012320e+11
 3.10440869e+11 3.49888188e+11 1.43127587e+11 3.48433268e+10
 6.07999706e+09 1.95312480e+11 1.94461663e+09 4.70103941e+10
 1.73643517e+11 7.21187713e+10 2.70664788e+11 2.27267045e+10
 1.06574260e+11 5.54850837e+11 1.39334540e+11 7.29547486e+08
 9.58954833e+10 3.57623498e+10 1.42483647e+11 1.63817099e+10
 1.02893174e+11 5.83014336e+10 3.61497216e+11 6.28773075e+09
 9.00411584e+10 8.39580410e+10 1.39856018e+10 1.17525985e+11
 3.55652145e+10 1.13986917e+11 4.12106827e+11 3.05811372e+10
 1.00996989e+11 7.19588681e+10 2.76777223e+11 1.22438711e+10
 1.76558151e+11 3.95783846e+09 5.10917832e+10 3.05033556e+10
 4.10137959e+10 4.99413803e+11 5.99369620e+11 2.28658519e+10
 2.62369052e+10 3.47703722e+11 2.62368667e+10 2.10618408e+10
 3.40359181e+10 1.30962080e+11 7.56438488e+11 2.45350183e+11
 2.39654224e+09 6.13375457e+11 5.05112471e+10 2.10169553e+11
 2.51400640e+11 2.80989892e+10 5.24712902e+10 4.29832230e+10
 8.16691592e+11 7.51012377e+08 6.81650715e+10 8.90033121e+11
 5.06122399e+11 8.38869852e+11 4.71616460e+10 7.45558231e+10
 2.10074507e+11 1.97840007e+10 1.34431157e+10 5.03981732e+10
 3.51862226e+10 1.47756044e+11 8.67214629e+10 2.56240939e+11
 2.11029340e+11 5.56194432e+10 2.02438441e+11 6.77325871e+09
 2.25713397e+10 3.01954154e+11 2.32986947e+11 2.61738931e+10
 1.02907549e+11 1.61550902e+12 2.23299372e+10 8.25424922e+09
 2.11029340e+11 6.27840100e+10 1.95312480e+11 3.07603469e+10
 4.06496546e+11 1.74235018e+11 7.81733384e+10 1.01620853e+11
 1.97660847e+10 4.74441241e+09 2.30813341e+11 4.37281753e+09
 2.53988585e+10 1.12776995e+11 1.08037758e+10 6.51343378e+10
 9.12194241e+10 2.04628250e+11 6.56708921e+09 4.27142736e+10
 2.33870808e+11 3.77791306e+11 6.89019842e+10 6.97944310e+10
 1.58375661e+09 1.00996989e+11 2.13898395e+10 1.38412898e+10
 3.35895647e+10 2.82885625e+09 1.69712662e+11 1.55820125e+11
 7.68480438e+11 1.99742974e+11 2.88728882e+10 4.41365977e+09
 5.37290288e+10 4.09542748e+10 7.89817780e+10 1.25044776e+10
 1.10574489e+11 9.12194241e+10 1.61550902e+12 5.90998306e+10
 2.71122912e+11 1.28814828e+11 5.01867614e+10 2.45913740e+11
 1.26884452e+10 4.48670453e+10 2.40088563e+10 8.36234174e+09
 6.75425569e+10 2.77307049e+11 3.55871491e+10 1.04598127e+11
 3.24871457e+10 1.02165755e+11 4.57179453e+10 2.70123475e+10
 8.27931529e+11 5.24641425e+11 5.03981732e+10 3.27961314e+10
 1.66219117e+11 7.88840972e+10 3.05665988e+10 2.61732173e+11
 2.31469632e+10 4.73817731e+12 3.63362973e+10 4.14195054e+10
 2.45954709e+10 2.69393318e+10 1.15069803e+11 4.10137959e+10
 5.99515541e+10 1.19462025e+10 5.12672449e+10 1.04965244e+09
 3.64877696e+11 1.20899579e+11 1.38309972e+11 1.38921555e+11
 4.65261301e+09 4.58955168e+08 9.00411584e+10 1.94118690e+08
 8.36946278e+09 1.10757844e+12 1.00499715e+12 2.65877085e+10
 1.04186110e+11 1.35839779e+11 8.73295937e+09 2.08888470e+11
 1.06019804e+12 1.02314125e+11 4.47811211e+11 3.79364496e+10
 1.97454445e+11 1.40080171e+11 3.79364496e+10 3.18884203e+09
 2.13725470e+11 2.05030472e+10 1.46610094e+11 6.59845364e+10
 9.86372088e+10 9.57960079e+09 8.25377285e+10 2.70123475e+10
 1.39929956e+10 1.09256080e+10 2.90391696e+11 2.84066641e+11
 2.88973959e+10 6.00377323e+10 7.89817780e+10 9.55696199e+09
 6.72855410e+10 5.82733409e+09 1.82988768e+11 5.10233231e+10
 2.72850609e+11 4.61386567e+10 5.53083515e+10 4.65545136e+10
 8.36234174e+09 1.63702600e+11 9.89996158e+11 4.47811211e+11]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[2.19111733e+09 8.93140605e+09 1.05653162e+11 1.34942601e+11
 1.46391015e+11 5.23693616e+10 1.17269450e+10 9.05862461e+11
 1.27427138e+12 8.36742562e+09 8.70260051e+11 2.74816101e+10
 4.73444401e+11 2.45725649e+10 3.81898919e+11 4.13780603e+09
 6.87012418e+10 6.73313262e+10 4.14195054e+10 4.67555335e+11
 8.18512999e+10 1.06759176e+11 1.39953941e+10 5.31876983e+09
 1.10297267e+12 1.65817131e+11 1.58939861e+10 4.16353407e+10
 4.71616460e+10 8.75036403e+09 1.06885962e+11 5.29572072e+10
 1.19185993e+10 2.69974102e+10 1.74659187e+10 1.84470922e+10
 2.80448774e+11 7.01544823e+09 5.67192161e+11 1.45885572e+10
 9.55703532e+11 6.09962561e+10 2.71758738e+11 3.04786302e+10
 3.27961314e+10 1.43127587e+11 1.86014217e+10 4.74205620e+10
 2.96790906e+08 9.31785232e+11 3.45230231e+11 3.80982878e+10
 4.05978574e+11 2.88185385e+11 4.00676818e+11 2.92338785e+10
 2.90508149e+10 2.58323213e+08 4.05978574e+11 1.46391015e+11
 2.74179486e+11 2.43300575e+10 1.45254074e+10 7.73839611e+11
 2.08888470e+11 3.82941390e+11 9.31785232e+11 1.87999623e+11
 9.50372196e+10 1.78053563e+10 9.79294597e+09 1.18324313e+10
 1.42483647e+11 6.34285968e+11 5.03981732e+10 4.51151755e+10
 9.63713079e+10 2.92338785e+10 1.36718736e+11 1.70000380e+11
 2.02695426e+10 2.93173626e+10 1.62258208e+11 1.69203884e+11
 1.13828318e+11 9.00364299e+10 1.58553866e+11 3.10124586e+08
 3.46658231e+10 7.64035453e+10 1.11990130e+11 8.19420603e+09
 1.00996989e+11 2.39654224e+09 3.47584892e+10 1.32454044e+10
 4.80695357e+11 9.14266472e+09 1.01501974e+11 8.74048643e+09
 4.92012320e+11 3.10440869e+11 3.49888188e+11 3.48433268e+10
 1.95312480e+11 1.94461663e+09 4.70103941e+10 1.73643517e+11
 2.70664788e+11 2.27267045e+10 1.06574260e+11 5.54850837e+11
 1.39334540e+11 7.29547486e+08 9.58954833e+10 3.57623498e+10
 1.42483647e+11 1.63817099e+10 1.02893174e+11 5.83014336e+10
 3.61497216e+11 6.28773075e+09 9.00411584e+10 8.39580410e+10
 1.39856018e+10 1.17525985e+11 3.55652145e+10 1.13986917e+11
 4.12106827e+11 3.05811372e+10 1.00996989e+11 7.19588681e+10
 2.76777223e+11 1.22438711e+10 1.76558151e+11 3.95783846e+09
 5.10917832e+10 3.05033556e+10 4.10137959e+10 4.99413803e+11
 5.99369620e+11 2.28658519e+10 2.62369052e+10 3.47703722e+11
 2.62368667e+10 2.10618408e+10 3.40359181e+10 7.56438488e+11
 2.45350183e+11 2.39654224e+09 6.13375457e+11 5.05112471e+10
 2.10169553e+11 2.51400640e+11 5.24712902e+10 8.16691592e+11
 7.51012377e+08 6.81650715e+10 8.90033121e+11 8.38869852e+11
 4.71616460e+10 7.45558231e+10 2.10074507e+11 1.97840007e+10
 1.34431157e+10 5.03981732e+10 3.51862226e+10 1.47756044e+11
 8.67214629e+10 2.56240939e+11 2.11029340e+11 5.56194432e+10
 6.77325871e+09 3.01954154e+11 2.32986947e+11 2.61738931e+10
 1.02907549e+11 1.61550902e+12 2.23299372e+10 8.25424922e+09
 2.11029340e+11 6.27840100e+10 1.95312480e+11 3.07603469e+10
 4.06496546e+11 1.74235018e+11 7.81733384e+10 1.01620853e+11
 1.97660847e+10 2.30813341e+11 4.37281753e+09 2.53988585e+10
 1.12776995e+11 1.08037758e+10 6.51343378e+10 9.12194241e+10
 2.04628250e+11 6.56708921e+09 4.27142736e+10 2.33870808e+11
 3.77791306e+11 6.89019842e+10 6.97944310e+10 1.58375661e+09
 1.00996989e+11 2.13898395e+10 3.35895647e+10 2.82885625e+09
 1.69712662e+11 1.55820125e+11 7.68480438e+11 1.99742974e+11
 2.88728882e+10 4.41365977e+09 5.37290288e+10 4.09542748e+10
 7.89817780e+10 1.25044776e+10 1.10574489e+11 9.12194241e+10
 1.61550902e+12 5.90998306e+10 2.71122912e+11 5.01867614e+10
 2.45913740e+11 1.26884452e+10 2.40088563e+10 8.36234174e+09
 6.75425569e+10 2.77307049e+11 3.55871491e+10 1.04598127e+11
 3.24871457e+10 1.02165755e+11 4.57179453e+10 2.70123475e+10
 8.27931529e+11 5.24641425e+11 5.03981732e+10 3.27961314e+10
 1.66219117e+11 7.88840972e+10 3.05665988e+10 2.61732173e+11
 2.31469632e+10 4.73817731e+12 3.63362973e+10 4.14195054e+10
 2.45954709e+10 2.69393318e+10 1.15069803e+11 4.10137959e+10
 5.99515541e+10 1.19462025e+10 5.12672449e+10 1.04965244e+09
 3.64877696e+11 1.20899579e+11 1.38309972e+11 1.38921555e+11
 4.65261301e+09 4.58955168e+08 9.00411584e+10 1.94118690e+08
 8.36946278e+09 1.10757844e+12 1.00499715e+12 1.04186110e+11
 1.35839779e+11 8.73295937e+09 2.08888470e+11 1.06019804e+12
 1.02314125e+11 4.47811211e+11 3.79364496e+10 1.97454445e+11
 1.40080171e+11 3.79364496e+10 3.18884203e+09 2.13725470e+11
 2.05030472e+10 1.46610094e+11 6.59845364e+10 9.86372088e+10
 9.57960079e+09 8.25377285e+10 2.70123475e+10 1.39929956e+10
 1.09256080e+10 2.90391696e+11 2.84066641e+11 2.88973959e+10
 6.00377323e+10 7.89817780e+10 9.55696199e+09 6.72855410e+10
 5.82733409e+09 1.82988768e+11 5.10233231e+10 2.72850609e+11
 4.61386567e+10 5.53083515e+10 8.36234174e+09 1.63702600e+11
 9.89996158e+11 4.47811211e+11]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[2.19111733e+09 8.93140605e+09 1.05653162e+11 1.46391015e+11
 5.23693616e+10 1.17269450e+10 9.05862461e+11 1.27427138e+12
 8.36742562e+09 8.70260051e+11 4.73444401e+11 2.45725649e+10
 3.81898919e+11 4.13780603e+09 6.87012418e+10 4.14195054e+10
 4.67555335e+11 8.18512999e+10 1.06759176e+11 1.39953941e+10
 1.10297267e+12 1.65817131e+11 1.58939861e+10 4.16353407e+10
 8.75036403e+09 5.29572072e+10 1.19185993e+10 2.69974102e+10
 1.74659187e+10 1.84470922e+10 7.01544823e+09 5.67192161e+11
 1.45885572e+10 9.55703532e+11 6.09962561e+10 2.71758738e+11
 3.04786302e+10 3.27961314e+10 1.43127587e+11 1.86014217e+10
 9.31785232e+11 3.45230231e+11 3.80982878e+10 4.05978574e+11
 4.00676818e+11 2.90508149e+10 2.58323213e+08 4.05978574e+11
 1.46391015e+11 2.74179486e+11 2.43300575e+10 1.45254074e+10
 2.08888470e+11 3.82941390e+11 9.31785232e+11 1.87999623e+11
 9.50372196e+10 1.78053563e+10 9.79294597e+09 1.18324313e+10
 1.42483647e+11 6.34285968e+11 5.03981732e+10 4.51151755e+10
 1.70000380e+11 2.93173626e+10 1.62258208e+11 1.69203884e+11
 1.13828318e+11 1.58553866e+11 3.10124586e+08 3.46658231e+10
 7.64035453e+10 1.11990130e+11 8.19420603e+09 1.00996989e+11
 2.39654224e+09 3.47584892e+10 1.32454044e+10 4.80695357e+11
 9.14266472e+09 1.01501974e+11 8.74048643e+09 4.92012320e+11
 3.10440869e+11 3.49888188e+11 3.48433268e+10 1.95312480e+11
 1.94461663e+09 4.70103941e+10 1.73643517e+11 2.70664788e+11
 2.27267045e+10 1.06574260e+11 5.54850837e+11 1.39334540e+11
 7.29547486e+08 9.58954833e+10 3.57623498e+10 1.63817099e+10
 1.02893174e+11 5.83014336e+10 6.28773075e+09 9.00411584e+10
 8.39580410e+10 1.39856018e+10 1.17525985e+11 3.55652145e+10
 1.13986917e+11 4.12106827e+11 1.00996989e+11 7.19588681e+10
 2.76777223e+11 1.22438711e+10 1.76558151e+11 3.95783846e+09
 5.10917832e+10 3.05033556e+10 4.10137959e+10 5.99369620e+11
 2.28658519e+10 2.62369052e+10 3.47703722e+11 2.62368667e+10
 2.10618408e+10 3.40359181e+10 2.45350183e+11 2.39654224e+09
 6.13375457e+11 5.05112471e+10 2.10169553e+11 2.51400640e+11
 5.24712902e+10 8.16691592e+11 7.51012377e+08 6.81650715e+10
 8.90033121e+11 8.38869852e+11 4.71616460e+10 7.45558231e+10
 2.10074507e+11 1.97840007e+10 1.34431157e+10 5.03981732e+10
 3.51862226e+10 1.47756044e+11 8.67214629e+10 2.56240939e+11
 2.11029340e+11 3.01954154e+11 2.32986947e+11 1.02907549e+11
 1.61550902e+12 2.23299372e+10 8.25424922e+09 2.11029340e+11
 6.27840100e+10 1.95312480e+11 3.07603469e+10 4.06496546e+11
 1.74235018e+11 7.81733384e+10 1.01620853e+11 1.97660847e+10
 2.30813341e+11 4.37281753e+09 1.12776995e+11 1.08037758e+10
 9.12194241e+10 2.04628250e+11 6.56708921e+09 4.27142736e+10
 3.77791306e+11 6.89019842e+10 6.97944310e+10 1.58375661e+09
 1.00996989e+11 2.13898395e+10 3.35895647e+10 2.82885625e+09
 1.69712662e+11 1.55820125e+11 7.68480438e+11 1.99742974e+11
 2.88728882e+10 4.41365977e+09 5.37290288e+10 4.09542748e+10
 7.89817780e+10 1.25044776e+10 9.12194241e+10 1.61550902e+12
 5.90998306e+10 2.71122912e+11 5.01867614e+10 1.26884452e+10
 2.40088563e+10 8.36234174e+09 6.75425569e+10 2.77307049e+11
 3.55871491e+10 1.04598127e+11 3.24871457e+10 1.02165755e+11
 4.57179453e+10 2.70123475e+10 8.27931529e+11 5.24641425e+11
 5.03981732e+10 3.27961314e+10 7.88840972e+10 2.31469632e+10
 4.73817731e+12 3.63362973e+10 4.14195054e+10 2.45954709e+10
 2.69393318e+10 4.10137959e+10 5.99515541e+10 1.19462025e+10
 1.04965244e+09 3.64877696e+11 1.20899579e+11 1.38309972e+11
 1.38921555e+11 4.65261301e+09 4.58955168e+08 9.00411584e+10
 1.94118690e+08 8.36946278e+09 1.10757844e+12 1.00499715e+12
 1.04186110e+11 1.35839779e+11 2.08888470e+11 1.06019804e+12
 1.02314125e+11 4.47811211e+11 3.79364496e+10 1.97454445e+11
 1.40080171e+11 3.79364496e+10 3.18884203e+09 2.13725470e+11
 2.05030472e+10 1.46610094e+11 6.59845364e+10 9.86372088e+10
 8.25377285e+10 2.70123475e+10 1.39929956e+10 1.09256080e+10
 2.90391696e+11 2.88973959e+10 7.89817780e+10 5.82733409e+09
 1.82988768e+11 5.10233231e+10 2.72850609e+11 4.61386567e+10
 5.53083515e+10 8.36234174e+09 9.89996158e+11 4.47811211e+11]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[2.19111733e+09 8.93140605e+09 1.05653162e+11 1.46391015e+11
 5.23693616e+10 1.17269450e+10 9.05862461e+11 1.27427138e+12
 8.36742562e+09 8.70260051e+11 4.73444401e+11 2.45725649e+10
 3.81898919e+11 4.13780603e+09 6.87012418e+10 4.67555335e+11
 1.06759176e+11 1.39953941e+10 1.10297267e+12 1.65817131e+11
 1.58939861e+10 4.16353407e+10 5.29572072e+10 1.19185993e+10
 2.69974102e+10 1.74659187e+10 1.84470922e+10 7.01544823e+09
 5.67192161e+11 1.45885572e+10 9.55703532e+11 6.09962561e+10
 3.04786302e+10 1.43127587e+11 1.86014217e+10 9.31785232e+11
 3.45230231e+11 3.80982878e+10 4.05978574e+11 2.90508149e+10
 2.58323213e+08 4.05978574e+11 1.46391015e+11 2.74179486e+11
 2.43300575e+10 1.45254074e+10 2.08888470e+11 3.82941390e+11
 9.31785232e+11 1.87999623e+11 1.78053563e+10 9.79294597e+09
 1.18324313e+10 1.42483647e+11 6.34285968e+11 5.03981732e+10
 4.51151755e+10 1.70000380e+11 1.62258208e+11 1.69203884e+11
 1.13828318e+11 1.58553866e+11 3.10124586e+08 3.46658231e+10
 7.64035453e+10 1.11990130e+11 1.00996989e+11 2.39654224e+09
 3.47584892e+10 1.32454044e+10 1.01501974e+11 8.74048643e+09
 4.92012320e+11 3.10440869e+11 3.49888188e+11 3.48433268e+10
 1.95312480e+11 1.94461663e+09 4.70103941e+10 1.73643517e+11
 2.70664788e+11 2.27267045e+10 1.06574260e+11 5.54850837e+11
 1.39334540e+11 7.29547486e+08 9.58954833e+10 3.57623498e+10
 1.63817099e+10 1.02893174e+11 5.83014336e+10 6.28773075e+09
 9.00411584e+10 1.39856018e+10 1.17525985e+11 3.55652145e+10
 1.13986917e+11 4.12106827e+11 1.00996989e+11 7.19588681e+10
 2.76777223e+11 1.22438711e+10 1.76558151e+11 3.05033556e+10
 4.10137959e+10 5.99369620e+11 2.28658519e+10 2.62369052e+10
 3.47703722e+11 2.62368667e+10 2.10618408e+10 2.45350183e+11
 2.39654224e+09 6.13375457e+11 5.05112471e+10 2.10169553e+11
 5.24712902e+10 8.16691592e+11 7.51012377e+08 6.81650715e+10
 8.90033121e+11 8.38869852e+11 7.45558231e+10 2.10074507e+11
 1.97840007e+10 1.34431157e+10 5.03981732e+10 3.51862226e+10
 1.47756044e+11 8.67214629e+10 2.56240939e+11 2.11029340e+11
 3.01954154e+11 2.32986947e+11 1.02907549e+11 1.61550902e+12
 2.23299372e+10 8.25424922e+09 2.11029340e+11 6.27840100e+10
 1.95312480e+11 1.74235018e+11 1.97660847e+10 2.30813341e+11
 4.37281753e+09 1.12776995e+11 9.12194241e+10 2.04628250e+11
 6.56708921e+09 4.27142736e+10 3.77791306e+11 6.89019842e+10
 6.97944310e+10 1.58375661e+09 1.00996989e+11 2.13898395e+10
 3.35895647e+10 2.82885625e+09 1.69712662e+11 1.55820125e+11
 7.68480438e+11 1.99742974e+11 2.88728882e+10 4.41365977e+09
 5.37290288e+10 4.09542748e+10 7.89817780e+10 1.25044776e+10
 9.12194241e+10 1.61550902e+12 5.01867614e+10 1.26884452e+10
 8.36234174e+09 2.77307049e+11 3.55871491e+10 1.04598127e+11
 3.24871457e+10 4.57179453e+10 2.70123475e+10 8.27931529e+11
 5.03981732e+10 7.88840972e+10 2.31469632e+10 4.73817731e+12
 4.14195054e+10 2.45954709e+10 4.10137959e+10 1.19462025e+10
 3.64877696e+11 1.20899579e+11 1.38921555e+11 4.65261301e+09
 4.58955168e+08 9.00411584e+10 8.36946278e+09 1.10757844e+12
 1.04186110e+11 1.35839779e+11 2.08888470e+11 1.06019804e+12
 1.02314125e+11 4.47811211e+11 3.79364496e+10 1.97454445e+11
 1.40080171e+11 3.79364496e+10 3.18884203e+09 2.13725470e+11
 2.05030472e+10 1.46610094e+11 6.59845364e+10 9.86372088e+10
 8.25377285e+10 2.70123475e+10 1.39929956e+10 1.09256080e+10
 2.90391696e+11 2.88973959e+10 5.82733409e+09 1.82988768e+11
 5.10233231e+10 2.72850609e+11 4.61386567e+10 5.53083515e+10
 8.36234174e+09 9.89996158e+11 4.47811211e+11]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[2.19111733e+09 5.23693616e+10 1.17269450e+10 9.05862461e+11
 1.27427138e+12 8.36742562e+09 8.70260051e+11 2.45725649e+10
 3.81898919e+11 1.39953941e+10 1.65817131e+11 5.29572072e+10
 1.19185993e+10 2.69974102e+10 1.74659187e+10 7.01544823e+09
 5.67192161e+11 1.45885572e+10 9.55703532e+11 6.09962561e+10
 3.04786302e+10 1.86014217e+10 9.31785232e+11 3.45230231e+11
 3.80982878e+10 4.05978574e+11 2.90508149e+10 2.58323213e+08
 4.05978574e+11 1.46391015e+11 2.74179486e+11 2.08888470e+11
 9.31785232e+11 1.87999623e+11 9.79294597e+09 1.42483647e+11
 6.34285968e+11 5.03981732e+10 4.51151755e+10 1.70000380e+11
 1.62258208e+11 1.69203884e+11 1.13828318e+11 1.58553866e+11
 3.10124586e+08 7.64035453e+10 1.11990130e+11 1.00996989e+11
 3.47584892e+10 1.32454044e+10 1.01501974e+11 8.74048643e+09
 4.92012320e+11 3.10440869e+11 3.49888188e+11 3.48433268e+10
 1.95312480e+11 4.70103941e+10 1.73643517e+11 2.70664788e+11
 1.06574260e+11 5.54850837e+11 1.39334540e+11 7.29547486e+08
 9.58954833e+10 3.57623498e+10 1.63817099e+10 1.02893174e+11
 5.83014336e+10 6.28773075e+09 9.00411584e+10 1.39856018e+10
 1.17525985e+11 3.55652145e+10 1.13986917e+11 4.12106827e+11
 1.00996989e+11 7.19588681e+10 2.76777223e+11 1.22438711e+10
 3.05033556e+10 4.10137959e+10 5.99369620e+11 2.28658519e+10
 2.62369052e+10 3.47703722e+11 2.62368667e+10 2.10618408e+10
 6.13375457e+11 5.05112471e+10 2.10169553e+11 8.16691592e+11
 7.51012377e+08 8.90033121e+11 8.38869852e+11 7.45558231e+10
 2.10074507e+11 1.97840007e+10 1.34431157e+10 3.51862226e+10
 1.47756044e+11 8.67214629e+10 2.56240939e+11 2.11029340e+11
 3.01954154e+11 2.32986947e+11 1.02907549e+11 1.61550902e+12
 8.25424922e+09 2.11029340e+11 6.27840100e+10 1.95312480e+11
 1.74235018e+11 4.37281753e+09 1.12776995e+11 9.12194241e+10
 2.04628250e+11 6.56708921e+09 4.27142736e+10 3.77791306e+11
 6.89019842e+10 6.97944310e+10 1.58375661e+09 1.00996989e+11
 2.13898395e+10 3.35895647e+10 2.82885625e+09 1.69712662e+11
 1.55820125e+11 7.68480438e+11 1.99742974e+11 2.88728882e+10
 5.37290288e+10 4.09542748e+10 7.89817780e+10 1.25044776e+10
 9.12194241e+10 1.61550902e+12 5.01867614e+10 1.26884452e+10
 8.36234174e+09 2.77307049e+11 3.55871491e+10 1.04598127e+11
 3.24871457e+10 4.57179453e+10 5.03981732e+10 2.31469632e+10
 4.73817731e+12 4.14195054e+10 2.45954709e+10 4.10137959e+10
 1.19462025e+10 3.64877696e+11 1.20899579e+11 1.38921555e+11
 4.65261301e+09 4.58955168e+08 9.00411584e+10 8.36946278e+09
 1.10757844e+12 1.04186110e+11 2.08888470e+11 4.47811211e+11
 3.79364496e+10 1.97454445e+11 1.40080171e+11 3.18884203e+09
 2.13725470e+11 2.05030472e+10 1.46610094e+11 9.86372088e+10
 8.25377285e+10 1.39929956e+10 1.09256080e+10 2.90391696e+11
 5.82733409e+09 1.82988768e+11 5.10233231e+10 2.72850609e+11
 4.61386567e+10 5.53083515e+10 8.36234174e+09 9.89996158e+11
 4.47811211e+11]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[2.19111733e+09 5.23693616e+10 1.17269450e+10 9.05862461e+11
 1.27427138e+12 8.36742562e+09 8.70260051e+11 2.45725649e+10
 3.81898919e+11 1.39953941e+10 5.29572072e+10 1.19185993e+10
 2.69974102e+10 1.74659187e+10 7.01544823e+09 9.55703532e+11
 6.09962561e+10 3.04786302e+10 1.86014217e+10 9.31785232e+11
 3.45230231e+11 3.80982878e+10 4.05978574e+11 2.90508149e+10
 2.58323213e+08 1.46391015e+11 2.74179486e+11 2.08888470e+11
 9.31785232e+11 9.79294597e+09 1.42483647e+11 6.34285968e+11
 5.03981732e+10 1.70000380e+11 1.62258208e+11 1.69203884e+11
 1.13828318e+11 1.58553866e+11 3.10124586e+08 7.64035453e+10
 1.11990130e+11 1.00996989e+11 1.32454044e+10 1.01501974e+11
 8.74048643e+09 3.10440869e+11 3.49888188e+11 3.48433268e+10
 1.95312480e+11 4.70103941e+10 1.73643517e+11 2.70664788e+11
 5.54850837e+11 7.29547486e+08 9.58954833e+10 1.63817099e+10
 1.02893174e+11 6.28773075e+09 9.00411584e+10 1.39856018e+10
 1.17525985e+11 3.55652145e+10 1.13986917e+11 4.12106827e+11
 1.00996989e+11 7.19588681e+10 2.76777223e+11 1.22438711e+10
 4.10137959e+10 5.99369620e+11 2.62369052e+10 3.47703722e+11
 2.62368667e+10 2.10618408e+10 6.13375457e+11 2.10169553e+11
 8.16691592e+11 7.51012377e+08 8.90033121e+11 2.10074507e+11
 1.97840007e+10 1.34431157e+10 3.51862226e+10 1.47756044e+11
 8.67214629e+10 2.56240939e+11 3.01954154e+11 2.32986947e+11
 1.02907549e+11 1.61550902e+12 8.25424922e+09 6.27840100e+10
 1.95312480e+11 1.74235018e+11 4.37281753e+09 1.12776995e+11
 9.12194241e+10 6.56708921e+09 4.27142736e+10 3.77791306e+11
 6.89019842e+10 6.97944310e+10 1.00996989e+11 2.13898395e+10
 3.35895647e+10 2.82885625e+09 1.69712662e+11 1.55820125e+11
 7.68480438e+11 1.99742974e+11 2.88728882e+10 5.37290288e+10
 9.12194241e+10 1.61550902e+12 5.01867614e+10 8.36234174e+09
 2.77307049e+11 3.55871491e+10 1.04598127e+11 3.24871457e+10
 4.57179453e+10 5.03981732e+10 2.31469632e+10 4.73817731e+12
 4.14195054e+10 2.45954709e+10 4.10137959e+10 3.64877696e+11
 1.20899579e+11 4.65261301e+09 4.58955168e+08 9.00411584e+10
 1.10757844e+12 1.04186110e+11 2.08888470e+11 4.47811211e+11
 3.79364496e+10 1.97454445e+11 1.40080171e+11 3.18884203e+09
 2.13725470e+11 1.46610094e+11 8.25377285e+10 1.39929956e+10
 1.09256080e+10 2.90391696e+11 5.82733409e+09 1.82988768e+11
 2.72850609e+11 4.61386567e+10 8.36234174e+09 9.89996158e+11
 4.47811211e+11]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[2.19111733e+09 1.17269450e+10 9.05862461e+11 1.27427138e+12
 8.36742562e+09 8.70260051e+11 2.45725649e+10 3.81898919e+11
 5.29572072e+10 1.19185993e+10 7.01544823e+09 9.55703532e+11
 1.86014217e+10 9.31785232e+11 3.45230231e+11 3.80982878e+10
 4.05978574e+11 2.90508149e+10 2.58323213e+08 2.74179486e+11
 2.08888470e+11 9.31785232e+11 9.79294597e+09 5.03981732e+10
 1.70000380e+11 1.62258208e+11 1.69203884e+11 1.13828318e+11
 1.58553866e+11 3.10124586e+08 7.64035453e+10 1.00996989e+11
 1.01501974e+11 3.10440869e+11 3.49888188e+11 3.48433268e+10
 4.70103941e+10 1.73643517e+11 2.70664788e+11 5.54850837e+11
 9.58954833e+10 1.63817099e+10 6.28773075e+09 1.39856018e+10
 1.17525985e+11 3.55652145e+10 4.12106827e+11 1.00996989e+11
 7.19588681e+10 2.76777223e+11 1.22438711e+10 5.99369620e+11
 2.62369052e+10 3.47703722e+11 2.62368667e+10 6.13375457e+11
 2.10169553e+11 7.51012377e+08 8.90033121e+11 2.10074507e+11
 1.34431157e+10 1.47756044e+11 2.56240939e+11 3.01954154e+11
 1.02907549e+11 8.25424922e+09 6.27840100e+10 1.95312480e+11
 4.37281753e+09 1.12776995e+11 4.27142736e+10 3.77791306e+11
 6.89019842e+10 6.97944310e+10 1.00996989e+11 2.13898395e+10
 3.35895647e+10 2.82885625e+09 1.69712662e+11 7.68480438e+11
 1.99742974e+11 2.88728882e+10 5.01867614e+10 8.36234174e+09
 2.77307049e+11 3.55871491e+10 1.04598127e+11 4.57179453e+10
 5.03981732e+10 2.31469632e+10 4.14195054e+10 4.10137959e+10
 3.64877696e+11 1.20899579e+11 4.65261301e+09 1.10757844e+12
 2.08888470e+11 4.47811211e+11 1.97454445e+11 3.18884203e+09
 2.13725470e+11 1.46610094e+11 8.25377285e+10 1.39929956e+10
 1.09256080e+10 2.90391696e+11 5.82733409e+09 1.82988768e+11
 2.72850609e+11 4.61386567e+10 8.36234174e+09 9.89996158e+11
 4.47811211e+11]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[2.19111733e+09 1.17269450e+10 9.05862461e+11 1.27427138e+12
 2.45725649e+10 3.81898919e+11 5.29572072e+10 9.31785232e+11
 2.90508149e+10 2.58323213e+08 2.74179486e+11 9.31785232e+11
 9.79294597e+09 1.70000380e+11 1.69203884e+11 1.13828318e+11
 1.58553866e+11 3.10124586e+08 7.64035453e+10 1.01501974e+11
 3.49888188e+11 3.48433268e+10 4.70103941e+10 1.73643517e+11
 5.54850837e+11 9.58954833e+10 1.63817099e+10 6.28773075e+09
 1.17525985e+11 3.55652145e+10 4.12106827e+11 1.00996989e+11
 7.19588681e+10 2.76777223e+11 1.22438711e+10 5.99369620e+11
 3.47703722e+11 6.13375457e+11 2.10169553e+11 8.90033121e+11
 2.10074507e+11 1.47756044e+11 2.56240939e+11 3.01954154e+11
 1.02907549e+11 8.25424922e+09 6.27840100e+10 1.95312480e+11
 4.37281753e+09 1.12776995e+11 4.27142736e+10 3.77791306e+11
 6.89019842e+10 6.97944310e+10 1.00996989e+11 2.13898395e+10
 3.35895647e+10 2.82885625e+09 1.69712662e+11 7.68480438e+11
 1.99742974e+11 2.88728882e+10 5.01867614e+10 8.36234174e+09
 3.55871491e+10 1.04598127e+11 4.57179453e+10 2.31469632e+10
 1.20899579e+11 4.65261301e+09 1.10757844e+12 1.97454445e+11
 3.18884203e+09 2.13725470e+11 1.46610094e+11 8.25377285e+10
 1.39929956e+10 1.09256080e+10 2.90391696e+11 5.82733409e+09
 1.82988768e+11 2.72850609e+11 8.36234174e+09 9.89996158e+11]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[2.19111733e+09 9.05862461e+11 2.45725649e+10 3.81898919e+11
 5.29572072e+10 9.31785232e+11 2.58323213e+08 2.74179486e+11
 9.31785232e+11 9.79294597e+09 1.70000380e+11 7.64035453e+10
 3.48433268e+10 4.70103941e+10 1.73643517e+11 5.54850837e+11
 9.58954833e+10 1.17525985e+11 3.55652145e+10 1.00996989e+11
 2.76777223e+11 3.47703722e+11 8.90033121e+11 2.10074507e+11
 2.56240939e+11 3.01954154e+11 1.02907549e+11 8.25424922e+09
 6.27840100e+10 1.95312480e+11 4.37281753e+09 4.27142736e+10
 3.77791306e+11 6.89019842e+10 6.97944310e+10 1.00996989e+11
 2.13898395e+10 3.35895647e+10 2.82885625e+09 1.69712662e+11
 1.99742974e+11 2.88728882e+10 5.01867614e+10 8.36234174e+09
 3.55871491e+10 2.31469632e+10 1.20899579e+11 4.65261301e+09
 1.10757844e+12 3.18884203e+09 1.46610094e+11 1.39929956e+10
 2.90391696e+11 1.82988768e+11 9.89996158e+11]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[9.05862461e+11 2.45725649e+10 3.81898919e+11 9.31785232e+11
 2.74179486e+11 9.31785232e+11 9.79294597e+09 1.70000380e+11
 7.64035453e+10 9.58954833e+10 1.17525985e+11 2.76777223e+11
 3.47703722e+11 8.90033121e+11 2.56240939e+11 3.01954154e+11
 1.02907549e+11 1.95312480e+11 4.37281753e+09 4.27142736e+10
 3.77791306e+11 2.13898395e+10 2.82885625e+09 1.69712662e+11
 1.99742974e+11 2.88728882e+10 8.36234174e+09 3.55871491e+10
 1.20899579e+11 4.65261301e+09 3.18884203e+09 1.46610094e+11
 1.39929956e+10 1.82988768e+11 9.89996158e+11]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']
/var/folders/6z/mh947m1s1m17ylsnt3y4rkfc0000gn/T/ipykernel_39820/2274478290.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[9.58954833e+10 3.01954154e+11 1.02907549e+11 4.27142736e+10
 1.69712662e+11 2.88728882e+10 8.36234174e+09]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X_train.loc[X_train['Issued'] &amp; (X_train['actual'] == 1), 'PNL'] = X_train['Gain_if_Issued']</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal Threshold: 0.98
Expected Profit per Issued Loan at Optimal Threshold: $-inf</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>